###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         23/May/2015  15:18:54 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Components\hal\target\CC2530EB\hal_timer.c         #
#    Command line       =  -f E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4 #
#                          .0\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\Tools\CC2530DB\f8wRouter.cfg (-DCPU32MHZ      #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DRTR_NWK -DBLINK_LEDS) -f                       #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\Tools\CC2530DB\f8wConfig.cfg (-DSECURE=0         #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF1                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Components\hal\target\CC2530EB\hal_timer.c -D      #
#                          ZIGBEEPRO -D ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC    #
#                          -D MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG -D           #
#                          ROUTER_ME -lC E:\wireless-switch\demo\ZStack-CC253 #
#                          0-2.3.0-1.4.0\Projects\zstack\Samples\SampleApp\CC #
#                          2530DB\RouterEB-Pro\List\ -lA                      #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\List\ --diag_suppress Pe001,Pa010 -o         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\Obj\ -e --debug --core=plain --dptr=16,1     #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4 #
#                          .0\Projects\zstack\Samples\SampleApp\CC2530DB\ -I  #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\SOUR #
#                          CE\ -I E:\wireless-switch\demo\ZStack-CC2530-2.3.0 #
#                          -1.4.0\Projects\zstack\Samples\SampleApp\CC2530DB\ #
#                          ..\..\..\ZMAIN\TI2530DB\ -I                        #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MT\ -I                          #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\HAL\INCLUDE\ -I                 #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\HAL\TARGET\CC2530EB\ -I         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\OSAL\MCU\CCSOC\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\OSAL\INCLUDE\ -I                #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\AF\ -I                    #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\NWK\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SEC\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SAPI\ -I                  #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SYS\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\ZDO\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\ZMAC\F8W\ -I                    #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\ZMAC\ -I                        #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\SERVICES\SADDR\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\SERVICES\SDATA\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\INCLUDE\ -I                 #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\HIGH_LEVEL\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\ -I         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP #
#                          \ -Ohs --require_prototypes                        #
#    List file          =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\List\hal_timer.lst                           #
#    Object file        =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\Obj\hal_timer.r51                            #
#                                                                             #
#                                                                             #
###############################################################################

E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\Components\hal\target\CC2530EB\hal_timer.c
      1          /**************************************************************************************************
      2            Filename:       hal_timer.c
      3            Revised:        $Date: 2009-03-12 16:25:22 -0700 (Thu, 12 Mar 2009) $
      4            Revision:       $Revision: 19404 $
      5          
      6            Description:   This file contains the interface to the Timer Service.
      7          
      8          
      9            Copyright 2006-2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          /*********************************************************************
     40           NOTE: The following mapping is done between the logical timer
     41                 names defined in HAL_TIMER.H and the physical HW timer.
     42          
     43                 HAL_TIMER_0 --> HW Timer 3  (8-bits)
     44                 HAL_TIMER_2 --> HW Timer 4  (8-bits)
     45                 HAL_TIMER_3 --> HW Timer 1  (16-bits)
     46          
     47           NOTE: The timer code assumes only one channel, CHANNEL 0, is used
     48                 for each timer.  There is currently no support for other
     49                 channels.
     50          
     51           NOTE: Only Output Compare Mode is supported.  There is no provision
     52                 to support Input Capture Mode.
     53          
     54           NOTE: There is no support to map the output of the timers to a
     55                 physical I/O pin
     56          
     57          *********************************************************************/
     58          /*********************************************************************
     59           * INCLUDES
     60           */
     61          #include  "hal_mcu.h"

   \                                 In  segment SFR_AN, at 0xb8
   \   union <unnamed> volatile __sfr _A_IEN1
   \                     _A_IEN1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xcb
   \   unsigned char volatile __sfr T3CTL
   \                     T3CTL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xcc
   \   unsigned char volatile __sfr T3CCTL0
   \                     T3CCTL0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xce
   \   unsigned char volatile __sfr T3CCTL1
   \                     T3CCTL1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xd8
   \   union <unnamed> volatile __sfr _A_TIMIF
   \                     _A_TIMIF:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xe4
   \   unsigned char volatile __sfr T1CTL
   \                     T1CTL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xe5
   \   unsigned char volatile __sfr T1CCTL0
   \                     T1CCTL0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xe6
   \   unsigned char volatile __sfr T1CCTL1
   \                     T1CCTL1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xe7
   \   unsigned char volatile __sfr T1CCTL2
   \                     T1CCTL2:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xeb
   \   unsigned char volatile __sfr T4CTL
   \                     T4CTL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xec
   \   unsigned char volatile __sfr T4CCTL0
   \                     T4CCTL0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xee
   \   unsigned char volatile __sfr T4CCTL1
   \                     T4CCTL1:
   \   000000                DS 1
     62          #include  "hal_defs.h"
     63          #include  "hal_types.h"
     64          #include  "hal_timer.h"
     65          
     66          /*********************************************************************
     67           * MACROS
     68           */
     69          
     70          /*********************************************************************
     71           * CONSTANTS
     72           */
     73          #define HW_TIMER_1        0x00
     74          #define HW_TIMER_3        0x01
     75          #define HW_TIMER_4        0x02
     76          #define HW_TIMER_INVALID  0x03
     77          #define HW_TIMER_MAX      0x03
     78          
     79          #define IEN1_T1IE     0x02    /* Timer1 Interrupt Enable */
     80          #define IEN1_T3IE     0x08    /* Timer3 Interrupt Enable */
     81          #define IEN1_T4IE     0x10    /* Timer4 Interrupt Enable */
     82          
     83          #define T1CTL_CH2IF   0x80
     84          #define T1CTL_CH1IF   0x40
     85          #define T1CTL_CH0IF   0x20
     86          #define T1CTL_OVFIF   0x10
     87          
     88          #define TIMIF_T1OVFIM 0x40
     89          #define TIMIF_T4CH1IF 0x20
     90          #define TIMIF_T4CH0IF 0x10
     91          #define TIMIF_T4OVFIF 0x08
     92          #define TIMIF_T3CH1IF 0x04
     93          #define TIMIF_T3CH0IF 0x02
     94          #define TIMIF_T3OVFIF 0x01
     95          
     96          #define T34CTL_OVFIM  0x80
     97          
     98          #define T134CCTL_IM         0x40    /* Interrupt Mask */
     99          #define T134CCTL_CMP_BITS   0x38    /* Bits[5:3] == CMP[2:0] */
    100          #define T134CCTL_MODE       0x04    /* Capture(0)/Compare(1) mode */
    101          #define T134CCTL_CAP_BITS   0x03    /* Bits[1:0] == CAP[1:0] */
    102          
    103          #define T134CCTL_CMP_OC     0x18    /* Set output on compare, clear at 0 */
    104          #define T134CCTL_CAP_RE     0x01    /* Set input capture on rising edge */
    105          
    106          /* Timer clock pre-scaler definitions for 16bit timer1 */
    107          #define HAL_TIMER1_16_TC_DIV1     0x00  /* No clock pre-scaling */
    108          #define HAL_TIMER1_16_TC_DIV8     0x04  /* Clock pre-scaled by 8 */
    109          #define HAL_TIMER1_16_TC_DIV32    0x08  /* Clock pre-scaled by 32 */
    110          #define HAL_TIMER1_16_TC_DIV128   0x0c  /* Clock pre-scaled by 128 */
    111          #define HAL_TIMER1_16_TC_BITS     0x0c  /* Bits 3:2 */
    112          
    113          /* Timer clock pre-scaler definitions for 8bit timer3 and timer4 */
    114          #define HAL_TIMER34_8_TC_DIV1     0x00  /* No clock pre-scaling */
    115          #define HAL_TIMER34_8_TC_DIV2     0x20  /* Clock pre-scaled by 2 */
    116          #define HAL_TIMER34_8_TC_DIV4     0x40  /* Clock pre-scaled by 4 */
    117          #define HAL_TIMER34_8_TC_DIV8     0x60  /* Clock pre-scaled by 8 */
    118          #define HAL_TIMER34_8_TC_DIV16    0x80  /* Clock pre-scaled by 16 */
    119          #define HAL_TIMER34_8_TC_DIV32    0xA0  /* Clock pre-scaled by 32 */
    120          #define HAL_TIMER34_8_TC_DIV64    0xC0  /* Clock pre-scaled by 64 */
    121          #define HAL_TIMER34_8_TC_DIV128   0xE0  /* Clock pre-scaled by 128 */
    122          #define HAL_TIMER34_8_TC_BITS     0xE0  /* Bits 7:5 */
    123          
    124          /* Operation Mode definitions */
    125          #define HAL_TIMER1_OPMODE_STOP      0x00  /* Free Running Mode, Count from 0 to Max */
    126          #define HAL_TIMER1_OPMODE_FREERUN   0x01  /* Free Running Mode, Count from 0 to Max */
    127          #define HAL_TIMER1_OPMODE_MODULO    0x02  /* Modulo Mode, Count from 0 to CompareValue */
    128          #define HAL_TIMER1_OPMODE_BITS      0x03  /* Bits 1:0 */
    129          
    130          #define HAL_TIMER34_START           0x10  /* Timer3 and Timer4 have separate Start bit */
    131          #define HAL_TIMER34_OPMODE_FREERUN  0x00  /* Free Running Mode, Count from 0 to Max */
    132          #define HAL_TIMER34_OPMODE_MODULO   0x02  /* Modulo Mode, Count from 0 to CompareValue */
    133          #define HAL_TIMER34_OPMODE_BITS     0x03  /* Bits 1:0 */
    134          
    135          #define HAL_TIMER_MODE_STOP         0x03
    136          
    137          /* Prescale settings */
    138          #define HAL_TIMER1_16_PRESCALE      HAL_TIMER1_16_TC_DIV128
    139          #define HAL_TIMER1_16_PRESCALE_VAL  128
    140          #define HAL_TIMER3_8_PRESCALE       HAL_TIMER34_8_TC_DIV128
    141          #define HAL_TIMER3_8_PRESCALE_VAL   128
    142          #define HAL_TIMER4_8_PRESCALE       HAL_TIMER34_8_TC_DIV128
    143          #define HAL_TIMER4_8_PRESCALE_VAL   128
    144          
    145          /* Clock settings */
    146          #define HAL_TIMER_16MHZ           16
    147          #define HAL_TIMER_32MHZ           32
    148          
    149          /* Default all timers to use channel 0 */
    150          #define TCHN_T1CCTL   &(X_T1CCTL0)
    151          #define TCHN_T1CCL    &(X_T1CC0L)
    152          #define TCHN_T1CCH    &(X_T1CC0H)
    153          #define TCNH_T1OVF    &(X_TIMIF)
    154          #define TCHN_T1OVFBIT TIMIF_T1OVFIM
    155          #define TCHN_T1INTBIT IEN1_T1IE
    156          
    157          #define TCHN_T3CCTL   &(X_T3CCTL0)
    158          #define TCHN_T3CCL    &(X_T3CC0)
    159          #define TCHN_T3CCH    &(X_T3CC0)
    160          #define TCNH_T3OVF    &(X_T3CTL)
    161          #define TCHN_T3OVFBIT T34CTL_OVFIM
    162          #define TCHN_T3INTBIT IEN1_T3IE
    163          
    164          #define TCHN_T4CCTL   &(X_T4CCTL0)
    165          #define TCHN_T4CCL    &(X_T4CC0)
    166          #define TCHN_T4CCH    &(X_T4CC0)
    167          #define TCNH_T4OVF    &(X_T4CTL)
    168          #define TCHN_T4OVFBIT T34CTL_OVFIM
    169          #define TCHN_T4INTBIT IEN1_T4IE
    170          
    171          /*********************************************************************
    172           * TYPEDEFS
    173           */
    174          typedef struct
    175          {
    176            bool configured;
    177            bool intEnable;
    178            uint8 opMode;
    179            uint8 channel;
    180            uint8 channelMode;
    181            uint8 prescale;
    182            uint8 prescaleVal;
    183            uint8 clock;
    184            halTimerCBack_t callBackFunc;
    185          } halTimerSettings_t;
    186          
    187          typedef struct
    188          {
    189            uint8 volatile XDATA *TxCCTL;
    190            uint8 volatile XDATA *TxCCH;
    191            uint8 volatile XDATA *TxCCL;
    192            uint8 volatile XDATA *TxOVF;
    193            uint8 ovfbit;
    194            uint8 intbit;
    195          } halTimerChannel_t;
    196          
    197          /*********************************************************************
    198           * GLOBAL VARIABLES
    199           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    200          static halTimerSettings_t halTimerRecord[HW_TIMER_MAX];
   \                     halTimerRecord:
   \   000000                DS 30
   \   00001E                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    201          static halTimerChannel_t  halTimerChannel[HW_TIMER_MAX];
   \                     halTimerChannel:
   \   000000                DS 30
   \   00001E                REQUIRE __INIT_XDATA_Z
    202          
    203          /*********************************************************************
    204           * FUNCTIONS - External
    205           */
    206          
    207          /*********************************************************************
    208           * FUNCTIONS - Local
    209           */
    210          uint8 halTimerSetCount (uint8 cc2430id, uint32 timePerTick);
    211          uint8 halTimerSetPrescale (uint8 cc2430id, uint8 prescale);
    212          uint8 halTimerSetOpMode (uint8 cc2430id, uint8 opMode);
    213          uint8 halTimerSetChannelMode (uint8 cc2430id, uint8 channelMode);
    214          void halTimerSendCallBack (uint8 timerId, uint8 channel, uint8 channelMode);
    215          uint8 halTimerRemap (uint8 timerId);
    216          void halProcessTimer1 (void);
    217          void halProcessTimer3 (void);
    218          void halProcessTimer4 (void);
    219          
    220          
    221          /*********************************************************************
    222           * FUNCTIONS - API
    223           */
    224          
    225          /*********************************************************************
    226           * @fn      HalTimerInit
    227           *
    228           * @brief   Initialize Timer Service
    229           *
    230           * @param   None
    231           *
    232           * @return  None
    233           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    234          void HalTimerInit (void)
   \                     HalTimerInit:
    235          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    236            T1CCTL0 = 0;    /* Make sure interrupts are disabled */
   \   000004   75E500       MOV     0xe5,#0x0
    237            T1CCTL1 = 0;    /* Make sure interrupts are disabled */
   \   000007   75E600       MOV     0xe6,#0x0
    238            T1CCTL2 = 0;    /* Make sure interrupts are disabled */
   \   00000A   75E700       MOV     0xe7,#0x0
    239            T3CCTL0 = 0;    /* Make sure interrupts are disabled */
   \   00000D   75CC00       MOV     0xcc,#0x0
    240            T3CCTL1 = 0;    /* Make sure interrupts are disabled */
   \   000010   75CE00       MOV     0xce,#0x0
    241            T4CCTL0 = 0;    /* Make sure interrupts are disabled */
   \   000013   75EC00       MOV     0xec,#0x0
    242            T4CCTL1 = 0;    /* Make sure interrupts are disabled */
   \   000016   75EE00       MOV     0xee,#0x0
    243          
    244            /* Setup prescale & clock for timer0 */
    245            halTimerRecord[HW_TIMER_1].prescale    = HAL_TIMER1_16_PRESCALE;
   \   000019   90....       MOV     DPTR,#halTimerRecord + 5
   \   00001C   740C         MOV     A,#0xc
   \   00001E   F0           MOVX    @DPTR,A
    246            halTimerRecord[HW_TIMER_1].clock       = HAL_TIMER_32MHZ;
   \   00001F   90....       MOV     DPTR,#halTimerRecord + 7
   \   000022   7420         MOV     A,#0x20
   \   000024   F0           MOVX    @DPTR,A
    247            halTimerRecord[HW_TIMER_1].prescaleVal = HAL_TIMER1_16_PRESCALE_VAL;
   \   000025   90....       MOV     DPTR,#halTimerRecord + 6
   \   000028   7480         MOV     A,#-0x80
   \   00002A   F0           MOVX    @DPTR,A
    248          
    249            /* Setup prescale & clock for timer2 */
    250            halTimerRecord[HW_TIMER_3].prescale    = HAL_TIMER3_8_PRESCALE;
   \   00002B   90....       MOV     DPTR,#halTimerRecord + 15
   \   00002E   74E0         MOV     A,#-0x20
   \   000030   F0           MOVX    @DPTR,A
    251            halTimerRecord[HW_TIMER_3].clock       = HAL_TIMER_32MHZ;
   \   000031   90....       MOV     DPTR,#halTimerRecord + 17
   \   000034   7420         MOV     A,#0x20
   \   000036   F0           MOVX    @DPTR,A
    252            halTimerRecord[HW_TIMER_3].prescaleVal = HAL_TIMER3_8_PRESCALE_VAL;
   \   000037   90....       MOV     DPTR,#halTimerRecord + 16
   \   00003A   7480         MOV     A,#-0x80
   \   00003C   F0           MOVX    @DPTR,A
    253          
    254            /* Setup prescale & clock for timer3 */
    255            halTimerRecord[HW_TIMER_4].prescale    = HAL_TIMER4_8_PRESCALE;
   \   00003D   90....       MOV     DPTR,#halTimerRecord + 25
   \   000040   74E0         MOV     A,#-0x20
   \   000042   F0           MOVX    @DPTR,A
    256            halTimerRecord[HW_TIMER_4].clock       = HAL_TIMER_32MHZ;
   \   000043   90....       MOV     DPTR,#halTimerRecord + 27
   \   000046   7420         MOV     A,#0x20
   \   000048   F0           MOVX    @DPTR,A
    257            halTimerRecord[HW_TIMER_4].prescaleVal = HAL_TIMER4_8_PRESCALE_VAL;
   \   000049   90....       MOV     DPTR,#halTimerRecord + 26
   \   00004C   7480         MOV     A,#-0x80
   \   00004E   F0           MOVX    @DPTR,A
    258          
    259            /* Setup Timer1 Channel structure */
    260            halTimerChannel[HW_TIMER_1].TxCCTL =  TCHN_T1CCTL;
   \   00004F   90....       MOV     DPTR,#halTimerChannel
   \   000052   74E5         MOV     A,#-0x1b
   \   000054   F0           MOVX    @DPTR,A
   \   000055   A3           INC     DPTR
   \   000056   7470         MOV     A,#0x70
   \   000058   F0           MOVX    @DPTR,A
    261            halTimerChannel[HW_TIMER_1].TxCCL =   TCHN_T1CCL;
   \   000059   90....       MOV     DPTR,#halTimerChannel + 4
   \   00005C   74DA         MOV     A,#-0x26
   \   00005E   F0           MOVX    @DPTR,A
   \   00005F   A3           INC     DPTR
   \   000060   7470         MOV     A,#0x70
   \   000062   F0           MOVX    @DPTR,A
    262            halTimerChannel[HW_TIMER_1].TxCCH =   TCHN_T1CCH;
   \   000063   90....       MOV     DPTR,#halTimerChannel + 2
   \   000066   74DB         MOV     A,#-0x25
   \   000068   F0           MOVX    @DPTR,A
   \   000069   A3           INC     DPTR
   \   00006A   7470         MOV     A,#0x70
   \   00006C   F0           MOVX    @DPTR,A
    263            halTimerChannel[HW_TIMER_1].TxOVF =   TCNH_T1OVF;
   \   00006D   90....       MOV     DPTR,#halTimerChannel + 6
   \   000070   74D8         MOV     A,#-0x28
   \   000072   F0           MOVX    @DPTR,A
   \   000073   A3           INC     DPTR
   \   000074   7470         MOV     A,#0x70
   \   000076   F0           MOVX    @DPTR,A
    264            halTimerChannel[HW_TIMER_1].ovfbit =  TCHN_T1OVFBIT;
   \   000077   A3           INC     DPTR
   \   000078   7440         MOV     A,#0x40
   \   00007A   F0           MOVX    @DPTR,A
    265            halTimerChannel[HW_TIMER_1].intbit =  TCHN_T1INTBIT;
   \   00007B   A3           INC     DPTR
   \   00007C   7402         MOV     A,#0x2
   \   00007E   F0           MOVX    @DPTR,A
    266          
    267            /* Setup Timer3 Channel structure */
    268            halTimerChannel[HW_TIMER_3].TxCCTL =  TCHN_T3CCTL;
   \   00007F   A3           INC     DPTR
   \   000080   74CC         MOV     A,#-0x34
   \   000082   F0           MOVX    @DPTR,A
   \   000083   A3           INC     DPTR
   \   000084   7470         MOV     A,#0x70
   \   000086   F0           MOVX    @DPTR,A
    269            halTimerChannel[HW_TIMER_3].TxCCL =   TCHN_T3CCL;
   \   000087   90....       MOV     DPTR,#halTimerChannel + 14
   \   00008A   74CD         MOV     A,#-0x33
   \   00008C   F0           MOVX    @DPTR,A
   \   00008D   A3           INC     DPTR
   \   00008E   7470         MOV     A,#0x70
   \   000090   F0           MOVX    @DPTR,A
    270            halTimerChannel[HW_TIMER_3].TxCCH =   TCHN_T3CCH;
   \   000091   90....       MOV     DPTR,#halTimerChannel + 12
   \   000094   74CD         MOV     A,#-0x33
   \   000096   F0           MOVX    @DPTR,A
   \   000097   A3           INC     DPTR
   \   000098   7470         MOV     A,#0x70
   \   00009A   F0           MOVX    @DPTR,A
    271            halTimerChannel[HW_TIMER_3].TxOVF =   TCNH_T3OVF;
   \   00009B   90....       MOV     DPTR,#halTimerChannel + 16
   \   00009E   74CB         MOV     A,#-0x35
   \   0000A0   F0           MOVX    @DPTR,A
   \   0000A1   A3           INC     DPTR
   \   0000A2   7470         MOV     A,#0x70
   \   0000A4   F0           MOVX    @DPTR,A
    272            halTimerChannel[HW_TIMER_3].ovfbit =  TCHN_T3OVFBIT;
   \   0000A5   A3           INC     DPTR
   \   0000A6   7480         MOV     A,#-0x80
   \   0000A8   F0           MOVX    @DPTR,A
    273            halTimerChannel[HW_TIMER_3].intbit =  TCHN_T3INTBIT;
   \   0000A9   A3           INC     DPTR
   \   0000AA   7408         MOV     A,#0x8
   \   0000AC   F0           MOVX    @DPTR,A
    274          
    275            /* Setup Timer4 Channel structure */
    276            halTimerChannel[HW_TIMER_4].TxCCTL =  TCHN_T4CCTL;
   \   0000AD   A3           INC     DPTR
   \   0000AE   74EC         MOV     A,#-0x14
   \   0000B0   F0           MOVX    @DPTR,A
   \   0000B1   A3           INC     DPTR
   \   0000B2   7470         MOV     A,#0x70
   \   0000B4   F0           MOVX    @DPTR,A
    277            halTimerChannel[HW_TIMER_4].TxCCL =   TCHN_T4CCL;
   \   0000B5   90....       MOV     DPTR,#halTimerChannel + 24
   \   0000B8   74ED         MOV     A,#-0x13
   \   0000BA   F0           MOVX    @DPTR,A
   \   0000BB   A3           INC     DPTR
   \   0000BC   7470         MOV     A,#0x70
   \   0000BE   F0           MOVX    @DPTR,A
    278            halTimerChannel[HW_TIMER_4].TxCCH =   TCHN_T4CCH;
   \   0000BF   90....       MOV     DPTR,#halTimerChannel + 22
   \   0000C2   74ED         MOV     A,#-0x13
   \   0000C4   F0           MOVX    @DPTR,A
   \   0000C5   A3           INC     DPTR
   \   0000C6   7470         MOV     A,#0x70
   \   0000C8   F0           MOVX    @DPTR,A
    279            halTimerChannel[HW_TIMER_4].TxOVF =   TCNH_T4OVF;
   \   0000C9   90....       MOV     DPTR,#halTimerChannel + 26
   \   0000CC   74EB         MOV     A,#-0x15
   \   0000CE   F0           MOVX    @DPTR,A
   \   0000CF   A3           INC     DPTR
   \   0000D0   7470         MOV     A,#0x70
   \   0000D2   F0           MOVX    @DPTR,A
    280            halTimerChannel[HW_TIMER_4].ovfbit =  TCHN_T4OVFBIT;
   \   0000D3   A3           INC     DPTR
   \   0000D4   7480         MOV     A,#-0x80
   \   0000D6   F0           MOVX    @DPTR,A
    281            halTimerChannel[HW_TIMER_4].intbit =  TCHN_T4INTBIT;
   \   0000D7   A3           INC     DPTR
   \   0000D8   7410         MOV     A,#0x10
   \   0000DA   F0           MOVX    @DPTR,A
    282          }
   \   0000DB   02....       LJMP    ?Subroutine0 & 0xFFFF
   \   0000DE                REQUIRE T1CCTL0
   \   0000DE                REQUIRE T1CCTL1
   \   0000DE                REQUIRE T1CCTL2
   \   0000DE                REQUIRE T3CCTL0
   \   0000DE                REQUIRE T3CCTL1
   \   0000DE                REQUIRE T4CCTL0
   \   0000DE                REQUIRE T4CCTL1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    283          
    284          /***************************************************************************************************
    285           * @fn      HalTimerConfig
    286           *
    287           * @brief   Configure the Timer Serivce
    288           *
    289           * @param   timerId - Id of the timer
    290           *          opMode  - Operation mode
    291           *          channel - Channel where the counter operates on
    292           *          channelMode - Mode of that channel
    293           *          prescale - Prescale of the clock
    294           *          cBack - Pointer to the callback function
    295           *
    296           * @return  Status of the configuration
    297           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    298          uint8 HalTimerConfig (uint8 timerId, uint8 opMode, uint8 channel, uint8 channelMode,
   \                     HalTimerConfig:
    299                                bool intEnable, halTimerCBack_t cBack)
    300          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
   \   00000B   740A         MOV     A,#0xa
   \   00000D   12....       LCALL   ?XSTACK_DISP0_8
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F8           MOV     R0,A
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F9           MOV     R1,A
    301            uint8 hwtimerid;
    302          
    303            hwtimerid = halTimerRemap (timerId);
   \   000015   E5..         MOV     A,?V0 + 0
   \   000017   600F         JZ      ??HalTimerConfig_0
   \   000019   24FE         ADD     A,#-0x2
   \   00001B   6007         JZ      ??HalTimerConfig_1
   \   00001D   14           DEC     A
   \   00001E   700C         JNZ     ??HalTimerConfig_2
   \   000020   7A00         MOV     R2,#0x0
   \   000022   800A         SJMP    ??HalTimerConfig_3
   \                     ??HalTimerConfig_1:
   \   000024   7A02         MOV     R2,#0x2
   \   000026   8006         SJMP    ??HalTimerConfig_3
   \                     ??HalTimerConfig_0:
   \   000028   7A01         MOV     R2,#0x1
   \   00002A   8002         SJMP    ??HalTimerConfig_3
   \                     ??HalTimerConfig_2:
   \   00002C   7A03         MOV     R2,#0x3
    304          
    305            if ((opMode & HAL_TIMER_MODE_MASK) && (timerId < HAL_TIMER_MAX) &&
    306                (channelMode & HAL_TIMER_CHANNEL_MASK) && (channel & HAL_TIMER_CHANNEL_MASK))
   \                     ??HalTimerConfig_3:
   \   00002E   7403         MOV     A,#0x3
   \   000030   5E           ANL     A,R6
   \   000031   605E         JZ      ??HalTimerConfig_4
   \   000033   E5..         MOV     A,?V0 + 0
   \   000035   C3           CLR     C
   \   000036   9404         SUBB    A,#0x4
   \   000038   5057         JNC     ??HalTimerConfig_4
   \   00003A   740F         MOV     A,#0xf
   \   00003C   5C           ANL     A,R4
   \   00003D   6052         JZ      ??HalTimerConfig_4
   \   00003F   740F         MOV     A,#0xf
   \   000041   5F           ANL     A,R7
   \   000042   604D         JZ      ??HalTimerConfig_4
    307            {
    308              halTimerRecord[hwtimerid].configured    = TRUE;
   \   000044   EA           MOV     A,R2
   \   000045   75F00A       MOV     B,#0xa
   \   000048   A4           MUL     AB
   \   000049   FA           MOV     R2,A
   \   00004A   85F0..       MOV     ?V0 + 1,B
   \   00004D   AB..         MOV     R3,?V0 + 1
   \   00004F   74..         MOV     A,#halTimerRecord & 0xff
   \   000051   2A           ADD     A,R2
   \   000052   FA           MOV     R2,A
   \   000053   74..         MOV     A,#(halTimerRecord >> 8) & 0xff
   \   000055   3B           ADDC    A,R3
   \   000056   FB           MOV     R3,A
   \   000057   8A82         MOV     DPL,R2
   \   000059   8B83         MOV     DPH,R3
   \   00005B   7401         MOV     A,#0x1
   \   00005D   F0           MOVX    @DPTR,A
    309              halTimerRecord[hwtimerid].opMode        = opMode;
   \   00005E   EE           MOV     A,R6
   \   00005F   A3           INC     DPTR
   \   000060   A3           INC     DPTR
   \   000061   F0           MOVX    @DPTR,A
    310              halTimerRecord[hwtimerid].channel       = channel;
   \   000062   EF           MOV     A,R7
   \   000063   8A82         MOV     DPL,R2
   \   000065   8B83         MOV     DPH,R3
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   A3           INC     DPTR
   \   00006A   F0           MOVX    @DPTR,A
    311              halTimerRecord[hwtimerid].channelMode   = channelMode;
   \   00006B   EC           MOV     A,R4
   \   00006C   8A82         MOV     DPL,R2
   \   00006E   8B83         MOV     DPH,R3
   \   000070   A3           INC     DPTR
   \   000071   A3           INC     DPTR
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   F0           MOVX    @DPTR,A
    312              halTimerRecord[hwtimerid].intEnable     = intEnable;
   \   000075   ED           MOV     A,R5
   \   000076   8A82         MOV     DPL,R2
   \   000078   8B83         MOV     DPH,R3
   \   00007A   A3           INC     DPTR
   \   00007B   F0           MOVX    @DPTR,A
    313              halTimerRecord[hwtimerid].callBackFunc  = cBack;
   \   00007C   8A82         MOV     DPL,R2
   \   00007E   8B83         MOV     DPH,R3
   \   000080   A3           INC     DPTR
   \   000081   A3           INC     DPTR
   \   000082   A3           INC     DPTR
   \   000083   A3           INC     DPTR
   \   000084   A3           INC     DPTR
   \   000085   A3           INC     DPTR
   \   000086   A3           INC     DPTR
   \   000087   A3           INC     DPTR
   \   000088   E8           MOV     A,R0
   \   000089   F0           MOVX    @DPTR,A
   \   00008A   A3           INC     DPTR
   \   00008B   E9           MOV     A,R1
   \   00008C   F0           MOVX    @DPTR,A
    314            }
    315            else
    316            {
    317              return HAL_TIMER_PARAMS_ERROR;
    318            }
    319            return HAL_TIMER_OK;
   \   00008D   7900         MOV     R1,#0x0
   \   00008F   8002         SJMP    ??HalTimerConfig_5
   \                     ??HalTimerConfig_4:
   \   000091   7902         MOV     R1,#0x2
   \                     ??HalTimerConfig_5:
   \   000093   7F02         MOV     R7,#0x2
   \   000095   02....       LJMP    ?BANKED_LEAVE_XDATA
    320          }
    321          
    322          
    323          /***************************************************************************************************
    324           * @fn      HalTimerStart
    325           *
    326           * @brief   Start the Timer Service
    327           *
    328           * @param   timerId      - ID of the timer
    329           *          timerPerTick - number of micro sec per tick, (ticks x prescale) / clock = usec/tick
    330           *
    331           * @return  Status - OK or Not OK
    332           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    333          uint8 HalTimerStart (uint8 timerId, uint32 timePerTick)
   \                     HalTimerStart:
    334          {
   \   000000   74EF         MOV     A,#-0x11
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 17
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   8C..         MOV     ?V0 + 2,R4
   \   00000B   8D..         MOV     ?V0 + 3,R5
    335            uint8 hwtimerid;
    336          
    337            hwtimerid = halTimerRemap (timerId);
   \   00000D   E9           MOV     A,R1
   \   00000E   600F         JZ      ??HalTimerStart_0
   \   000010   24FE         ADD     A,#-0x2
   \   000012   6007         JZ      ??HalTimerStart_1
   \   000014   14           DEC     A
   \   000015   700C         JNZ     ??HalTimerStart_2
   \   000017   7C00         MOV     R4,#0x0
   \   000019   800A         SJMP    ??HalTimerStart_3
   \                     ??HalTimerStart_1:
   \   00001B   7C02         MOV     R4,#0x2
   \   00001D   8006         SJMP    ??HalTimerStart_3
   \                     ??HalTimerStart_0:
   \   00001F   7C01         MOV     R4,#0x1
   \   000021   8002         SJMP    ??HalTimerStart_3
   \                     ??HalTimerStart_2:
   \   000023   7C03         MOV     R4,#0x3
    338          
    339            if (halTimerRecord[hwtimerid].configured)
   \                     ??HalTimerStart_3:
   \   000025   EC           MOV     A,R4
   \   000026   75F00A       MOV     B,#0xa
   \   000029   A4           MUL     AB
   \   00002A   FA           MOV     R2,A
   \   00002B   ABF0         MOV     R3,B
   \   00002D   74..         MOV     A,#halTimerRecord & 0xff
   \   00002F   2A           ADD     A,R2
   \   000030   FE           MOV     R6,A
   \   000031   74..         MOV     A,#(halTimerRecord >> 8) & 0xff
   \   000033   3B           ADDC    A,R3
   \   000034   FF           MOV     R7,A
   \   000035   8E82         MOV     DPL,R6
   \   000037   8F83         MOV     DPH,R7
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   7003         JNZ     $+5
   \   00003C   02....       LJMP    ??HalTimerStart_4 & 0xFFFF
    340            {
    341              halTimerSetCount (hwtimerid, timePerTick);
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   E0           MOVX    A,@DPTR
   \   000047   F5..         MOV     ?V0 + 4,A
   \   000049   E4           CLR     A
   \   00004A   F5..         MOV     ?V0 + 5,A
   \   00004C   F5..         MOV     ?V0 + 6,A
   \   00004E   F5..         MOV     ?V0 + 7,A
   \   000050   78..         MOV     R0,#?V0 + 0
   \   000052   79..         MOV     R1,#?V0 + 4
   \   000054   12....       LCALL   ?L_MUL
   \   000057   8E82         MOV     DPL,R6
   \   000059   8F83         MOV     DPH,R7
   \   00005B   A3           INC     DPTR
   \   00005C   A3           INC     DPTR
   \   00005D   A3           INC     DPTR
   \   00005E   A3           INC     DPTR
   \   00005F   A3           INC     DPTR
   \   000060   A3           INC     DPTR
   \   000061   E0           MOVX    A,@DPTR
   \   000062   F5..         MOV     ?V0 + 4,A
   \   000064   78..         MOV     R0,#?V0 + 0
   \   000066   79..         MOV     R1,#?V0 + 4
   \   000068   12....       LCALL   ?UL_DIV_MOD
   \   00006B   85....       MOV     ?V0 + 2,?V0 + 0
   \   00006E   85....       MOV     ?V0 + 3,?V0 + 1
   \   000071   74..         MOV     A,#halTimerChannel & 0xff
   \   000073   2A           ADD     A,R2
   \   000074   F8           MOV     R0,A
   \   000075   74..         MOV     A,#(halTimerChannel >> 8) & 0xff
   \   000077   3B           ADDC    A,R3
   \   000078   F9           MOV     R1,A
   \   000079   8882         MOV     DPL,R0
   \   00007B   8983         MOV     DPH,R1
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   FA           MOV     R2,A
   \   000081   A3           INC     DPTR
   \   000082   E0           MOVX    A,@DPTR
   \   000083   F583         MOV     DPH,A
   \   000085   8A82         MOV     DPL,R2
   \   000087   E5..         MOV     A,?V0 + 3
   \   000089   F0           MOVX    @DPTR,A
   \   00008A   8882         MOV     DPL,R0
   \   00008C   8983         MOV     DPH,R1
   \   00008E   A3           INC     DPTR
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   E0           MOVX    A,@DPTR
   \   000093   FA           MOV     R2,A
   \   000094   A3           INC     DPTR
   \   000095   E0           MOVX    A,@DPTR
   \   000096   F583         MOV     DPH,A
   \   000098   8A82         MOV     DPL,R2
   \   00009A   E5..         MOV     A,?V0 + 2
   \   00009C   F0           MOVX    @DPTR,A
    342              halTimerSetPrescale (hwtimerid, halTimerRecord[hwtimerid].prescale);
   \   00009D   8E82         MOV     DPL,R6
   \   00009F   8F83         MOV     DPH,R7
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   A3           INC     DPTR
   \   0000A4   A3           INC     DPTR
   \   0000A5   A3           INC     DPTR
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   FA           MOV     R2,A
   \   0000A8   EC           MOV     A,R4
   \   0000A9   6016         JZ      ??HalTimerStart_5
   \   0000AB   14           DEC     A
   \   0000AC   600B         JZ      ??HalTimerStart_6
   \   0000AE   14           DEC     A
   \   0000AF   7016         JNZ     ??HalTimerStart_7
   \   0000B1   53EB1F       ANL     0xeb,#0x1f
   \   0000B4   EA           MOV     A,R2
   \   0000B5   42EB         ORL     0xeb,A
   \   0000B7   800E         SJMP    ??HalTimerStart_7
   \                     ??HalTimerStart_6:
   \   0000B9   53CB1F       ANL     0xcb,#0x1f
   \   0000BC   EA           MOV     A,R2
   \   0000BD   42CB         ORL     0xcb,A
   \   0000BF   8006         SJMP    ??HalTimerStart_7
   \                     ??HalTimerStart_5:
   \   0000C1   53E4F3       ANL     0xe4,#0xf3
   \   0000C4   EA           MOV     A,R2
   \   0000C5   42E4         ORL     0xe4,A
    343              halTimerSetOpMode (hwtimerid, halTimerRecord[hwtimerid].opMode);
   \                     ??HalTimerStart_7:
   \   0000C7   8E82         MOV     DPL,R6
   \   0000C9   8F83         MOV     DPH,R7
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   E0           MOVX    A,@DPTR
   \   0000CE   14           DEC     A
   \   0000CF   6032         JZ      ??HalTimerStart_8
   \   0000D1   14           DEC     A
   \   0000D2   600E         JZ      ??HalTimerStart_9
   \   0000D4   14           DEC     A
   \   0000D5   704B         JNZ     ??HalTimerStart_10
   \   0000D7   EC           MOV     A,R4
   \   0000D8   7048         JNZ     ??HalTimerStart_10
   \   0000DA   53E4FC       ANL     0xe4,#0xfc
   \   0000DD   85E4E4       MOV     0xe4,0xe4
   \   0000E0   8040         SJMP    ??HalTimerStart_10
   \                     ??HalTimerStart_9:
   \   0000E2   EC           MOV     A,R4
   \   0000E3   6016         JZ      ??HalTimerStart_11
   \   0000E5   14           DEC     A
   \   0000E6   600B         JZ      ??HalTimerStart_12
   \   0000E8   14           DEC     A
   \   0000E9   7037         JNZ     ??HalTimerStart_10
   \   0000EB   53EBFC       ANL     0xeb,#0xfc
   \   0000EE   43EB02       ORL     0xeb,#0x2
   \   0000F1   802F         SJMP    ??HalTimerStart_10
   \                     ??HalTimerStart_12:
   \   0000F3   53CBFC       ANL     0xcb,#0xfc
   \   0000F6   43CB02       ORL     0xcb,#0x2
   \   0000F9   8027         SJMP    ??HalTimerStart_10
   \                     ??HalTimerStart_11:
   \   0000FB   53E4FC       ANL     0xe4,#0xfc
   \   0000FE   43E402       ORL     0xe4,#0x2
   \   000101   801F         SJMP    ??HalTimerStart_10
   \                     ??HalTimerStart_8:
   \   000103   EC           MOV     A,R4
   \   000104   6016         JZ      ??HalTimerStart_13
   \   000106   14           DEC     A
   \   000107   600B         JZ      ??HalTimerStart_14
   \   000109   14           DEC     A
   \   00010A   7016         JNZ     ??HalTimerStart_10
   \   00010C   53EBFC       ANL     0xeb,#0xfc
   \   00010F   85EBEB       MOV     0xeb,0xeb
   \   000112   800E         SJMP    ??HalTimerStart_10
   \                     ??HalTimerStart_14:
   \   000114   53CBFC       ANL     0xcb,#0xfc
   \   000117   85CBCB       MOV     0xcb,0xcb
   \   00011A   8006         SJMP    ??HalTimerStart_10
   \                     ??HalTimerStart_13:
   \   00011C   53E4FC       ANL     0xe4,#0xfc
   \   00011F   43E401       ORL     0xe4,#0x1
    344              halTimerSetChannelMode (hwtimerid, halTimerRecord[hwtimerid].channelMode);
   \                     ??HalTimerStart_10:
   \   000122   EE           MOV     A,R6
   \   000123   2404         ADD     A,#0x4
   \   000125   FA           MOV     R2,A
   \   000126   EF           MOV     A,R7
   \   000127   3400         ADDC    A,#0x0
   \   000129   FB           MOV     R3,A
   \   00012A   8A..         MOV     ?V0 + 0,R2
   \   00012C   8B..         MOV     ?V0 + 1,R3
   \   00012E   8A82         MOV     DPL,R2
   \   000130   F583         MOV     DPH,A
   \   000132   E0           MOVX    A,@DPTR
   \   000133   6402         XRL     A,#0x2
   \   000135   7020         JNZ     ??HalTimerStart_15
   \   000137   8882         MOV     DPL,R0
   \   000139   8983         MOV     DPH,R1
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   FA           MOV     R2,A
   \   00013D   A3           INC     DPTR
   \   00013E   E0           MOVX    A,@DPTR
   \   00013F   F583         MOV     DPH,A
   \   000141   8A82         MOV     DPL,R2
   \   000143   E0           MOVX    A,@DPTR
   \   000144   54C7         ANL     A,#0xc7
   \   000146   F0           MOVX    @DPTR,A
   \   000147   8882         MOV     DPL,R0
   \   000149   8983         MOV     DPH,R1
   \   00014B   E0           MOVX    A,@DPTR
   \   00014C   F8           MOV     R0,A
   \   00014D   A3           INC     DPTR
   \   00014E   E0           MOVX    A,@DPTR
   \   00014F   F583         MOV     DPH,A
   \   000151   8882         MOV     DPL,R0
   \   000153   E0           MOVX    A,@DPTR
   \   000154   441C         ORL     A,#0x1c
   \   000156   F0           MOVX    @DPTR,A
    345          
    346              if (hwtimerid == HW_TIMER_3)
   \                     ??HalTimerStart_15:
   \   000157   7401         MOV     A,#0x1
   \   000159   6C           XRL     A,R4
   \   00015A   7005         JNZ     ??HalTimerStart_16
    347              {
    348                T3CTL |= HAL_TIMER34_START;
   \   00015C   43CB10       ORL     0xcb,#0x10
   \   00015F   8008         SJMP    ??HalTimerStart_17
    349              }
    350              if (hwtimerid == HW_TIMER_4)
   \                     ??HalTimerStart_16:
   \   000161   7402         MOV     A,#0x2
   \   000163   6C           XRL     A,R4
   \   000164   7003         JNZ     ??HalTimerStart_17
    351              {
    352                T4CTL |= HAL_TIMER34_START;
   \   000166   43EB10       ORL     0xeb,#0x10
    353              }
    354              HalTimerInterruptEnable (hwtimerid, halTimerRecord[hwtimerid].channelMode,
    355                                       halTimerRecord[hwtimerid].intEnable);
   \                     ??HalTimerStart_17:
   \   000169                ; Setup parameters for call to function HalTimerInterruptEnable
   \   000169   8E82         MOV     DPL,R6
   \   00016B   8F83         MOV     DPH,R7
   \   00016D   A3           INC     DPTR
   \   00016E   E0           MOVX    A,@DPTR
   \   00016F   FB           MOV     R3,A
   \   000170   85..82       MOV     DPL,?V0 + 0
   \   000173   85..83       MOV     DPH,?V0 + 1
   \   000176   E0           MOVX    A,@DPTR
   \   000177   FA           MOV     R2,A
   \   000178   EC           MOV     A,R4
   \   000179   F9           MOV     R1,A
   \   00017A   12....       LCALL   ??HalTimerInterruptEnable?relay
    356            }
    357            else
    358            {
    359              return HAL_TIMER_NOT_CONFIGURED;
    360            }
    361            return HAL_TIMER_OK;
   \   00017D   7900         MOV     R1,#0x0
   \   00017F   8002         SJMP    ??HalTimerStart_18
   \                     ??HalTimerStart_4:
   \   000181   7903         MOV     R1,#0x3
   \                     ??HalTimerStart_18:
   \   000183   7F09         MOV     R7,#0x9
   \   000185   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000188                REQUIRE T3CTL
   \   000188                REQUIRE T4CTL
   \   000188                REQUIRE T1CTL
    362          }
    363          
    364          /***************************************************************************************************
    365           * @fn      HalTimerTick
    366           *
    367           * @brief   Check the counter for expired counter.
    368           *
    369           * @param   None
    370           *
    371           * @return  None
    372           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    373          void HalTimerTick (void)
   \                     HalTimerTick:
    374          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    375            if (!halTimerRecord[HW_TIMER_1].intEnable)
   \   000004   90....       MOV     DPTR,#halTimerRecord + 1
   \   000007   E0           MOVX    A,@DPTR
   \   000008   7003         JNZ     ??HalTimerTick_0
    376            {
    377              halProcessTimer1 ();
   \   00000A                ; Setup parameters for call to function halProcessTimer1
   \   00000A   12....       LCALL   ??halProcessTimer1?relay
    378            }
    379          
    380            if (!halTimerRecord[HW_TIMER_3].intEnable)
   \                     ??HalTimerTick_0:
   \   00000D   90....       MOV     DPTR,#halTimerRecord + 11
   \   000010   E0           MOVX    A,@DPTR
   \   000011   7003         JNZ     ??HalTimerTick_1
    381            {
    382              halProcessTimer3 ();
   \   000013                ; Setup parameters for call to function halProcessTimer3
   \   000013   12....       LCALL   ??halProcessTimer3?relay
    383            }
    384          
    385            if (!halTimerRecord[HW_TIMER_4].intEnable)
   \                     ??HalTimerTick_1:
   \   000016   90....       MOV     DPTR,#halTimerRecord + 21
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   7003         JNZ     ??HalTimerTick_2
    386            {
    387              halProcessTimer4 ();
   \   00001C                ; Setup parameters for call to function halProcessTimer4
   \   00001C   12....       LCALL   ??halProcessTimer4?relay
    388            }
    389          }
   \                     ??HalTimerTick_2:
   \   00001F   02....       LJMP    ?Subroutine0 & 0xFFFF
    390          
    391          /***************************************************************************************************
    392           * @fn      HalTimerStop
    393           *
    394           * @brief   Stop the Timer Service
    395           *
    396           * @param   timerId - ID of the timer
    397           *
    398           * @return  Status - OK or Not OK
    399           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    400          uint8 HalTimerStop (uint8 timerId)
   \                     HalTimerStop:
    401          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   E9           MOV     A,R1
    402            uint8 hwtimerid;
    403          
    404            hwtimerid = halTimerRemap (timerId);
   \   000001   6017         JZ      ??HalTimerStop_0
   \   000003   24FE         ADD     A,#-0x2
   \   000005   600E         JZ      ??HalTimerStop_1
   \   000007   14           DEC     A
   \   000008   7015         JNZ     ??HalTimerStop_2
    405          
    406            switch (hwtimerid)
    407            {
    408              case HW_TIMER_1:
    409                halTimerSetOpMode(HW_TIMER_1, HAL_TIMER_MODE_STOP);
   \   00000A   53E4FC       ANL     0xe4,#0xfc
   \   00000D   85E4E4       MOV     0xe4,0xe4
    410                break;
    411              case HW_TIMER_3:
    412                T3CTL &= ~(HAL_TIMER34_START);
    413                break;
    414              case HW_TIMER_4:
    415                T4CTL &= ~(HAL_TIMER34_START);
    416                break;
    417              default:
    418                return HAL_TIMER_INVALID_ID;
    419            }
    420            return HAL_TIMER_OK;
   \                     ??HalTimerStop_3:
   \   000010   7900         MOV     R1,#0x0
   \                     ??HalTimerStop_4:
   \   000012   02....       LJMP    ?BRET
   \                     ??HalTimerStop_1:
   \   000015   53EBEF       ANL     0xeb,#0xef
   \   000018   80F6         SJMP    ??HalTimerStop_3
   \                     ??HalTimerStop_0:
   \   00001A   53CBEF       ANL     0xcb,#0xef
   \   00001D   80F1         SJMP    ??HalTimerStop_3
   \                     ??HalTimerStop_2:
   \   00001F   7904         MOV     R1,#0x4
   \   000021   80EF         SJMP    ??HalTimerStop_4
   \   000023                REQUIRE T3CTL
   \   000023                REQUIRE T4CTL
   \   000023                REQUIRE T1CTL
    421          }
    422          
    423          /***************************************************************************************************
    424           * @fn      halTimerSetCount
    425           *
    426           * @brief   Stop the Timer Service
    427           *
    428           * @param   hwtimerid - ID of the timer
    429           *          timerPerTick - Number micro sec per ticks
    430           *
    431           * @return  Status - OK or Not OK
    432           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    433          uint8 halTimerSetCount (uint8 hwtimerid, uint32 timePerTick)
   \                     halTimerSetCount:
    434          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   8A..         MOV     ?V0 + 0,R2
   \   000008   8B..         MOV     ?V0 + 1,R3
   \   00000A   8C..         MOV     ?V0 + 2,R4
   \   00000C   8D..         MOV     ?V0 + 3,R5
    435            uint16  count;
    436            uint8   high, low;
    437          
    438            /* Load count = ((sec/tick) x clock) / prescale */
    439            count = (uint16)((timePerTick * halTimerRecord[hwtimerid].clock) / halTimerRecord[hwtimerid].prescaleVal);
   \   00000E   75F00A       MOV     B,#0xa
   \   000011   A4           MUL     AB
   \   000012   FA           MOV     R2,A
   \   000013   ABF0         MOV     R3,B
   \   000015   74..         MOV     A,#halTimerRecord & 0xff
   \   000017   2A           ADD     A,R2
   \   000018   F8           MOV     R0,A
   \   000019   74..         MOV     A,#(halTimerRecord >> 8) & 0xff
   \   00001B   3B           ADDC    A,R3
   \   00001C   F9           MOV     R1,A
   \   00001D   E8           MOV     A,R0
   \   00001E   FC           MOV     R4,A
   \   00001F   E9           MOV     A,R1
   \   000020   FD           MOV     R5,A
   \   000021   8C82         MOV     DPL,R4
   \   000023   8D83         MOV     DPH,R5
   \   000025   A3           INC     DPTR
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   A3           INC     DPTR
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F5..         MOV     ?V0 + 4,A
   \   00002F   E4           CLR     A
   \   000030   F5..         MOV     ?V0 + 5,A
   \   000032   F5..         MOV     ?V0 + 6,A
   \   000034   F5..         MOV     ?V0 + 7,A
   \   000036   78..         MOV     R0,#?V0 + 0
   \   000038   79..         MOV     R1,#?V0 + 4
   \   00003A   12....       LCALL   ?L_MUL
   \   00003D   8C82         MOV     DPL,R4
   \   00003F   8D83         MOV     DPH,R5
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F5..         MOV     ?V0 + 4,A
   \   00004A   78..         MOV     R0,#?V0 + 0
   \   00004C   79..         MOV     R1,#?V0 + 4
   \   00004E   12....       LCALL   ?UL_DIV_MOD
    440            high = (uint8) (count >> 8);
    441            low = (uint8) count;
    442          
    443            *(halTimerChannel[hwtimerid].TxCCH) = high;
   \   000051   74..         MOV     A,#halTimerChannel & 0xff
   \   000053   2A           ADD     A,R2
   \   000054   F8           MOV     R0,A
   \   000055   74..         MOV     A,#(halTimerChannel >> 8) & 0xff
   \   000057   3B           ADDC    A,R3
   \   000058   F9           MOV     R1,A
   \   000059   8882         MOV     DPL,R0
   \   00005B   8983         MOV     DPH,R1
   \   00005D   A3           INC     DPTR
   \   00005E   A3           INC     DPTR
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   FA           MOV     R2,A
   \   000061   A3           INC     DPTR
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F583         MOV     DPH,A
   \   000065   8A82         MOV     DPL,R2
   \   000067   E5..         MOV     A,?V0 + 1
   \   000069   F0           MOVX    @DPTR,A
    444            *(halTimerChannel[hwtimerid].TxCCL) = low;
   \   00006A   8882         MOV     DPL,R0
   \   00006C   8983         MOV     DPH,R1
   \   00006E   A3           INC     DPTR
   \   00006F   A3           INC     DPTR
   \   000070   A3           INC     DPTR
   \   000071   A3           INC     DPTR
   \   000072   E0           MOVX    A,@DPTR
   \   000073   F8           MOV     R0,A
   \   000074   A3           INC     DPTR
   \   000075   E0           MOVX    A,@DPTR
   \   000076   F583         MOV     DPH,A
   \   000078   8882         MOV     DPL,R0
   \   00007A   E5..         MOV     A,?V0 + 0
   \   00007C   F0           MOVX    @DPTR,A
    445          
    446            return HAL_TIMER_OK;
   \   00007D   7900         MOV     R1,#0x0
   \   00007F   7F08         MOV     R7,#0x8
   \   000081   02....       LJMP    ?BANKED_LEAVE_XDATA
    447          }
    448          
    449          /***************************************************************************************************
    450           * @fn      halTimerSetPrescale
    451           *
    452           * @brief   Stop the Timer Service
    453           *
    454           * @param   hwtimerid - ID of the timer
    455           *          prescale - Prescale of the clock
    456           *
    457           * @return  Status - OK or Not OK
    458           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    459          uint8 halTimerSetPrescale (uint8 hwtimerid, uint8 prescale)
   \                     halTimerSetPrescale:
    460          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   E9           MOV     A,R1
    461            switch (hwtimerid)
   \   000001   6008         JZ      ??halTimerSetPrescale_0
   \   000003   14           DEC     A
   \   000004   6010         JZ      ??halTimerSetPrescale_1
   \   000006   14           DEC     A
   \   000007   6015         JZ      ??halTimerSetPrescale_2
   \   000009   801B         SJMP    ??halTimerSetPrescale_3
    462            {
    463              case HW_TIMER_1:
    464                T1CTL &= ~(HAL_TIMER1_16_TC_BITS);
   \                     ??halTimerSetPrescale_0:
   \   00000B   53E4F3       ANL     0xe4,#0xf3
    465                T1CTL |= prescale;
   \   00000E   EA           MOV     A,R2
   \   00000F   42E4         ORL     0xe4,A
    466                break;
    467              case HW_TIMER_3:
    468                T3CTL &= ~(HAL_TIMER34_8_TC_BITS);
    469                T3CTL |= prescale;
    470                break;
    471              case HW_TIMER_4:
    472                T4CTL &= ~(HAL_TIMER34_8_TC_BITS);
    473                T4CTL |= prescale;
    474                break;
    475              default:
    476                return HAL_TIMER_INVALID_ID;
    477            }
    478            return HAL_TIMER_OK;
   \                     ??halTimerSetPrescale_4:
   \   000011   7900         MOV     R1,#0x0
   \                     ??halTimerSetPrescale_5:
   \   000013   02....       LJMP    ?BRET
   \                     ??halTimerSetPrescale_1:
   \   000016   53CB1F       ANL     0xcb,#0x1f
   \   000019   EA           MOV     A,R2
   \   00001A   42CB         ORL     0xcb,A
   \   00001C   80F3         SJMP    ??halTimerSetPrescale_4
   \                     ??halTimerSetPrescale_2:
   \   00001E   53EB1F       ANL     0xeb,#0x1f
   \   000021   EA           MOV     A,R2
   \   000022   42EB         ORL     0xeb,A
   \   000024   80EB         SJMP    ??halTimerSetPrescale_4
   \                     ??halTimerSetPrescale_3:
   \   000026   7904         MOV     R1,#0x4
   \   000028   80E9         SJMP    ??halTimerSetPrescale_5
   \   00002A                REQUIRE T1CTL
   \   00002A                REQUIRE T3CTL
   \   00002A                REQUIRE T4CTL
    479          }
    480          
    481          /***************************************************************************************************
    482           * @fn      halTimerSetOpMode
    483           *
    484           * @brief   Setup operate modes
    485           *
    486           * @param   hwtimerid - ID of the timer
    487           *          opMode - operation mode of the timer
    488           *
    489           * @return  Status - OK or Not OK
    490           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    491          uint8 halTimerSetOpMode (uint8 hwtimerid, uint8 opMode)
   \                     halTimerSetOpMode:
    492          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   E9           MOV     A,R1
   \   000001   F8           MOV     R0,A
    493            /* Load Waveform Generation Mode */
    494            switch (opMode)
   \   000002   EA           MOV     A,R2
   \   000003   14           DEC     A
   \   000004   6008         JZ      ??halTimerSetOpMode_0
   \   000006   14           DEC     A
   \   000007   602F         JZ      ??halTimerSetOpMode_1
   \   000009   14           DEC     A
   \   00000A   604F         JZ      ??halTimerSetOpMode_2
   \   00000C   8058         SJMP    ??halTimerSetOpMode_3
    495            {
    496              case HAL_TIMER_MODE_NORMAL:
    497                switch (hwtimerid)
   \                     ??halTimerSetOpMode_0:
   \   00000E   E8           MOV     A,R0
   \   00000F   6008         JZ      ??halTimerSetOpMode_4
   \   000011   14           DEC     A
   \   000012   6010         JZ      ??halTimerSetOpMode_5
   \   000014   14           DEC     A
   \   000015   6015         JZ      ??halTimerSetOpMode_6
   \   000017   801B         SJMP    ??halTimerSetOpMode_7
    498                {
    499                  case HW_TIMER_1:
    500                    T1CTL &= ~(HAL_TIMER1_OPMODE_BITS);
   \                     ??halTimerSetOpMode_4:
   \   000019   53E4FC       ANL     0xe4,#0xfc
    501                    T1CTL |= HAL_TIMER1_OPMODE_FREERUN;
   \   00001C   43E401       ORL     0xe4,#0x1
    502                    break;
    503                  case HW_TIMER_3:
    504                    T3CTL &= ~(HAL_TIMER34_OPMODE_BITS);
    505                    T3CTL |= HAL_TIMER34_OPMODE_FREERUN;
    506                    break;
    507                  case HW_TIMER_4:
    508                    T4CTL &= ~(HAL_TIMER34_OPMODE_BITS);
    509                    T4CTL |= HAL_TIMER34_OPMODE_FREERUN;
    510                    break;
    511                  default:
    512                    return HAL_TIMER_INVALID_ID;
    513                }
    514                break;
    515          
    516              case HAL_TIMER_MODE_CTC:
    517                switch (hwtimerid)
    518                {
    519                  case HW_TIMER_1:
    520                    T1CTL &= ~(HAL_TIMER1_OPMODE_BITS);
    521                    T1CTL |= HAL_TIMER1_OPMODE_MODULO;
    522                    break;
    523                  case HW_TIMER_3:
    524                    T3CTL &= ~(HAL_TIMER34_OPMODE_BITS);
    525                    T3CTL |= HAL_TIMER34_OPMODE_MODULO;
    526                    break;
    527                  case HW_TIMER_4:
    528                    T4CTL &= ~(HAL_TIMER34_OPMODE_BITS);
    529                    T4CTL |= HAL_TIMER34_OPMODE_MODULO;
    530                    break;
    531                  default:
    532                    return HAL_TIMER_INVALID_ID;
    533                }
    534                break;
    535          
    536              case HAL_TIMER_MODE_STOP:
    537                if (hwtimerid == HW_TIMER_1)
    538                {
    539                  T1CTL &= ~(HAL_TIMER1_OPMODE_BITS);
    540                  T1CTL |= HAL_TIMER1_OPMODE_STOP;
    541                }
    542                break;
    543          
    544              default:
    545                return HAL_TIMER_INVALID_OP_MODE;
    546            }
    547            return HAL_TIMER_OK;
   \                     ??halTimerSetOpMode_8:
   \   00001F   7900         MOV     R1,#0x0
   \                     ??halTimerSetOpMode_9:
   \   000021   02....       LJMP    ?BRET
   \                     ??halTimerSetOpMode_5:
   \   000024   53CBFC       ANL     0xcb,#0xfc
   \   000027   85CBCB       MOV     0xcb,0xcb
   \   00002A   80F3         SJMP    ??halTimerSetOpMode_8
   \                     ??halTimerSetOpMode_6:
   \   00002C   53EBFC       ANL     0xeb,#0xfc
   \   00002F   85EBEB       MOV     0xeb,0xeb
   \   000032   80EB         SJMP    ??halTimerSetOpMode_8
   \                     ??halTimerSetOpMode_7:
   \   000034   7904         MOV     R1,#0x4
   \   000036   80E9         SJMP    ??halTimerSetOpMode_9
   \                     ??halTimerSetOpMode_1:
   \   000038   E8           MOV     A,R0
   \   000039   6008         JZ      ??halTimerSetOpMode_10
   \   00003B   14           DEC     A
   \   00003C   600D         JZ      ??halTimerSetOpMode_11
   \   00003E   14           DEC     A
   \   00003F   6012         JZ      ??halTimerSetOpMode_12
   \   000041   80F1         SJMP    ??halTimerSetOpMode_7
   \                     ??halTimerSetOpMode_10:
   \   000043   53E4FC       ANL     0xe4,#0xfc
   \   000046   43E402       ORL     0xe4,#0x2
   \   000049   80D4         SJMP    ??halTimerSetOpMode_8
   \                     ??halTimerSetOpMode_11:
   \   00004B   53CBFC       ANL     0xcb,#0xfc
   \   00004E   43CB02       ORL     0xcb,#0x2
   \   000051   80CC         SJMP    ??halTimerSetOpMode_8
   \                     ??halTimerSetOpMode_12:
   \   000053   53EBFC       ANL     0xeb,#0xfc
   \   000056   43EB02       ORL     0xeb,#0x2
   \   000059   80C4         SJMP    ??halTimerSetOpMode_8
   \                     ??halTimerSetOpMode_2:
   \   00005B   E8           MOV     A,R0
   \   00005C   70C1         JNZ     ??halTimerSetOpMode_8
   \   00005E   53E4FC       ANL     0xe4,#0xfc
   \   000061   85E4E4       MOV     0xe4,0xe4
   \   000064   80B9         SJMP    ??halTimerSetOpMode_8
   \                     ??halTimerSetOpMode_3:
   \   000066   7906         MOV     R1,#0x6
   \   000068   80B7         SJMP    ??halTimerSetOpMode_9
   \   00006A                REQUIRE T1CTL
   \   00006A                REQUIRE T3CTL
   \   00006A                REQUIRE T4CTL
    548          }
    549          
    550          /***************************************************************************************************
    551           * @fn      halTimerSetChannelMode
    552           *
    553           * @brief   Setup channel modes.  Currently, only output compare mode is supported.  Input capture
    554           *          mode is NOT supported.  Additionally, mapping timer channel inputs/outputs to I/O pins
    555           *          is NOT supported.
    556           *
    557           * @param   hwtimerid - ID of the timer
    558           *          channelMode - channel mode of the timer
    559           *
    560           * @return  Status - OK or Not OK
    561           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    562          uint8 halTimerSetChannelMode (uint8 hwtimerid, uint8 channelMode)
   \                     halTimerSetChannelMode:
    563          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FC           MOV     R4,A
    564            switch (channelMode)
   \   000006   EA           MOV     A,R2
   \   000007   14           DEC     A
   \   000008   6033         JZ      ??halTimerSetChannelMode_0
   \   00000A   14           DEC     A
   \   00000B   7035         JNZ     ??halTimerSetChannelMode_1
    565            {
    566              case HAL_TIMER_CH_MODE_OUTPUT_COMPARE:
    567                *(halTimerChannel[hwtimerid].TxCCTL) &= ~(T134CCTL_CMP_BITS);
   \   00000D   EC           MOV     A,R4
   \   00000E   75F00A       MOV     B,#0xa
   \   000011   A4           MUL     AB
   \   000012   F8           MOV     R0,A
   \   000013   A9F0         MOV     R1,B
   \   000015   74..         MOV     A,#halTimerChannel & 0xff
   \   000017   28           ADD     A,R0
   \   000018   F8           MOV     R0,A
   \   000019   74..         MOV     A,#(halTimerChannel >> 8) & 0xff
   \   00001B   39           ADDC    A,R1
   \   00001C   F9           MOV     R1,A
   \   00001D   8882         MOV     DPL,R0
   \   00001F   8983         MOV     DPH,R1
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FB           MOV     R3,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F583         MOV     DPH,A
   \   000027   8B82         MOV     DPL,R3
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   54C7         ANL     A,#0xc7
   \   00002C   F0           MOVX    @DPTR,A
    568                *(halTimerChannel[hwtimerid].TxCCTL) |= (T134CCTL_CMP_OC | T134CCTL_MODE);
   \   00002D   8882         MOV     DPL,R0
   \   00002F   8983         MOV     DPH,R1
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F8           MOV     R0,A
   \   000033   A3           INC     DPTR
   \   000034   E0           MOVX    A,@DPTR
   \   000035   F583         MOV     DPH,A
   \   000037   8882         MOV     DPL,R0
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   441C         ORL     A,#0x1c
   \   00003C   F0           MOVX    @DPTR,A
    569                break;
    570          
    571              case HAL_TIMER_CH_MODE_INPUT_CAPTURE:       /* Not Supported */
    572          /*
    573                *(halTimerChannel[hwtimerid].TxCCTL) &= ~(T134CCTL_CAP_BITS | T134CCTL_MODE);
    574                *(halTimerChannel[hwtimerid].TxCCTL) |= T134CCTL_CAP_RE;
    575          */
    576                break;
    577          
    578              default:
    579                return HAL_TIMER_INVALID_CH_MODE;
    580            }
    581            return HAL_TIMER_OK;
   \                     ??halTimerSetChannelMode_0:
   \   00003D   7900         MOV     R1,#0x0
   \                     ??halTimerSetChannelMode_2:
   \   00003F   02....       LJMP    ?Subroutine0 & 0xFFFF
   \                     ??halTimerSetChannelMode_1:
   \   000042   7905         MOV     R1,#0x5
   \   000044   80F9         SJMP    ??halTimerSetChannelMode_2
    582          }
    583          
    584          /***************************************************************************************************
    585           * @fn      HalTimerInterruptEnable
    586           *
    587           * @brief   Setup operate modes
    588           *
    589           * @param   hwtimerid - ID of the timer
    590           *          channelMode - channel mode
    591           *          enable - TRUE or FALSE
    592           *
    593           * @return  Status - OK or Not OK
    594           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    595          uint8 HalTimerInterruptEnable (uint8 hwtimerid, uint8 channelMode, bool enable)
   \                     HalTimerInterruptEnable:
    596          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    597            switch (channelMode)
   \   000007   EA           MOV     A,R2
   \   000008   14           DEC     A
   \   000009   7003         JNZ     $+5
   \   00000B   02....       LJMP    ??HalTimerInterruptEnable_0 & 0xFFFF
   \   00000E   14           DEC     A
   \   00000F   607F         JZ      ??HalTimerInterruptEnable_0
   \   000011   24FE         ADD     A,#-0x2
   \   000013   6003         JZ      $+5
   \   000015   02....       LJMP    ??HalTimerInterruptEnable_1 & 0xFFFF
    598            {
    599              case HAL_TIMER_CH_MODE_OVERFLOW:
    600          
    601                if (enable)
   \   000018   EE           MOV     A,R6
   \   000019   75F00A       MOV     B,#0xa
   \   00001C   A4           MUL     AB
   \   00001D   FC           MOV     R4,A
   \   00001E   ADF0         MOV     R5,B
   \   000020   74..         MOV     A,#halTimerChannel & 0xff
   \   000022   2C           ADD     A,R4
   \   000023   F8           MOV     R0,A
   \   000024   74..         MOV     A,#(halTimerChannel >> 8) & 0xff
   \   000026   3D           ADDC    A,R5
   \   000027   F9           MOV     R1,A
   \   000028   E8           MOV     A,R0
   \   000029   2408         ADD     A,#0x8
   \   00002B   F582         MOV     DPL,A
   \   00002D   E9           MOV     A,R1
   \   00002E   3400         ADDC    A,#0x0
   \   000030   F583         MOV     DPH,A
   \   000032   E8           MOV     A,R0
   \   000033   2406         ADD     A,#0x6
   \   000035   F8           MOV     R0,A
   \   000036   E9           MOV     A,R1
   \   000037   3400         ADDC    A,#0x0
   \   000039   F9           MOV     R1,A
   \   00003A   EB           MOV     A,R3
   \   00003B   6040         JZ      ??HalTimerInterruptEnable_2
    602                {
    603                  *(halTimerChannel[hwtimerid].TxOVF) |= halTimerChannel[hwtimerid].ovfbit;
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   FC           MOV     R4,A
   \   00003F   8882         MOV     DPL,R0
   \   000041   8983         MOV     DPH,R1
   \   000043   E0           MOVX    A,@DPTR
   \   000044   F8           MOV     R0,A
   \   000045   A3           INC     DPTR
   \   000046   E0           MOVX    A,@DPTR
   \   000047   F583         MOV     DPH,A
   \   000049   8882         MOV     DPL,R0
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   4C           ORL     A,R4
   \                     ??HalTimerInterruptEnable_3:
   \   00004D   F0           MOVX    @DPTR,A
    604                }
    605                else
    606                {
    607                  *(halTimerChannel[hwtimerid].TxOVF) &= ((halTimerChannel[hwtimerid].ovfbit) ^ 0xFF);
    608                }
    609                break;
    610          
    611              case HAL_TIMER_CH_MODE_OUTPUT_COMPARE:
    612              case HAL_TIMER_CH_MODE_INPUT_CAPTURE:
    613          
    614                if (enable)
    615                {
    616                  *(halTimerChannel[hwtimerid].TxCCTL) |= T134CCTL_IM;
    617                }
    618                else
    619                {
    620                  *(halTimerChannel[hwtimerid].TxCCTL) &= ~(T134CCTL_IM);
    621                }
    622                break;
    623          
    624              default:
    625                return HAL_TIMER_INVALID_CH_MODE;
    626            }
    627          
    628            if (halTimerRecord[hwtimerid].intEnable)
   \   00004E   EE           MOV     A,R6
   \   00004F   75F00A       MOV     B,#0xa
   \   000052   A4           MUL     AB
   \   000053   FC           MOV     R4,A
   \   000054   74..         MOV     A,#halTimerChannel & 0xff
   \   000056   2C           ADD     A,R4
   \   000057   F8           MOV     R0,A
   \   000058   74..         MOV     A,#(halTimerChannel >> 8) & 0xff
   \   00005A   3D           ADDC    A,R5
   \   00005B   F9           MOV     R1,A
   \   00005C   8882         MOV     DPL,R0
   \   00005E   8983         MOV     DPH,R1
   \   000060   A3           INC     DPTR
   \   000061   A3           INC     DPTR
   \   000062   A3           INC     DPTR
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F8           MOV     R0,A
   \   00006B   74..         MOV     A,#(halTimerRecord + 1) & 0xff
   \   00006D   2C           ADD     A,R4
   \   00006E   F582         MOV     DPL,A
   \   000070   74..         MOV     A,#((halTimerRecord + 1) >> 8) & 0xff
   \   000072   3D           ADDC    A,R5
   \   000073   F583         MOV     DPH,A
   \   000075   E0           MOVX    A,@DPTR
   \   000076   6046         JZ      ??HalTimerInterruptEnable_4
    629            {
    630              IEN1 |= halTimerChannel[hwtimerid].intbit;
   \   000078   E8           MOV     A,R0
   \   000079   42B8         ORL     0xb8,A
   \   00007B   8046         SJMP    ??HalTimerInterruptEnable_5
    631            }
   \                     ??HalTimerInterruptEnable_2:
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   F4           CPL     A
   \   00007F   FC           MOV     R4,A
   \   000080   8882         MOV     DPL,R0
   \   000082   8983         MOV     DPH,R1
   \   000084   E0           MOVX    A,@DPTR
   \   000085   F8           MOV     R0,A
   \   000086   A3           INC     DPTR
   \   000087   E0           MOVX    A,@DPTR
   \   000088   F583         MOV     DPH,A
   \   00008A   8882         MOV     DPL,R0
   \   00008C   E0           MOVX    A,@DPTR
   \   00008D   5C           ANL     A,R4
   \   00008E   80BD         SJMP    ??HalTimerInterruptEnable_3
   \                     ??HalTimerInterruptEnable_0:
   \   000090   EE           MOV     A,R6
   \   000091   75F00A       MOV     B,#0xa
   \   000094   A4           MUL     AB
   \   000095   FC           MOV     R4,A
   \   000096   ADF0         MOV     R5,B
   \   000098   74..         MOV     A,#halTimerChannel & 0xff
   \   00009A   2C           ADD     A,R4
   \   00009B   F8           MOV     R0,A
   \   00009C   74..         MOV     A,#(halTimerChannel >> 8) & 0xff
   \   00009E   3D           ADDC    A,R5
   \   00009F   F9           MOV     R1,A
   \   0000A0   8882         MOV     DPL,R0
   \   0000A2   8983         MOV     DPH,R1
   \   0000A4   E0           MOVX    A,@DPTR
   \   0000A5   F8           MOV     R0,A
   \   0000A6   A3           INC     DPTR
   \   0000A7   E0           MOVX    A,@DPTR
   \   0000A8   F9           MOV     R1,A
   \   0000A9   8882         MOV     DPL,R0
   \   0000AB   8983         MOV     DPH,R1
   \   0000AD   EB           MOV     A,R3
   \   0000AE   6005         JZ      ??HalTimerInterruptEnable_6
   \   0000B0   E0           MOVX    A,@DPTR
   \   0000B1   D2E6         SETB    0xE0 /* A   */.6
   \   0000B3   8098         SJMP    ??HalTimerInterruptEnable_3
   \                     ??HalTimerInterruptEnable_6:
   \   0000B5   E0           MOVX    A,@DPTR
   \   0000B6   C2E6         CLR     0xE0 /* A   */.6
   \   0000B8   8093         SJMP    ??HalTimerInterruptEnable_3
   \                     ??HalTimerInterruptEnable_1:
   \   0000BA   7905         MOV     R1,#0x5
   \   0000BC   8007         SJMP    ??HalTimerInterruptEnable_7
    632            else
    633            {
    634              IEN1 &= ((halTimerChannel[hwtimerid].intbit) ^ 0xFF);
   \                     ??HalTimerInterruptEnable_4:
   \   0000BE   74FF         MOV     A,#-0x1
   \   0000C0   68           XRL     A,R0
   \   0000C1   52B8         ANL     0xb8,A
    635            }
    636            return HAL_TIMER_OK;
   \                     ??HalTimerInterruptEnable_5:
   \   0000C3   7900         MOV     R1,#0x0
   \                     ??HalTimerInterruptEnable_7:
   \   0000C5                REQUIRE ?Subroutine1
   \   0000C5                REQUIRE _A_IEN1
   \   0000C5                ; // Fall through to label ?Subroutine1
    637          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    638          
    639          /***************************************************************************************************
    640           * @fn      halTimerSendCallBack
    641           *
    642           * @brief   Send Callback back to the caller
    643           *
    644           * @param   timerId - ID of the timer
    645           *          channel - channel where the interrupt occurs
    646           *          channelMode - channel mode
    647           *
    648           *
    649           * @return  None
    650           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    651          void halTimerSendCallBack (uint8 timerId, uint8 channel, uint8 channelMode)
   \                     halTimerSendCallBack:
    652          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
    653            uint8 hwtimerid;
    654          
    655            hwtimerid = halTimerRemap (timerId);
   \   000007   E9           MOV     A,R1
   \   000008   600E         JZ      ??halTimerSendCallBack_0
   \   00000A   24FE         ADD     A,#-0x2
   \   00000C   6006         JZ      ??halTimerSendCallBack_1
   \   00000E   14           DEC     A
   \   00000F   700B         JNZ     ??halTimerSendCallBack_2
   \   000011   E4           CLR     A
   \   000012   800A         SJMP    ??halTimerSendCallBack_3
   \                     ??halTimerSendCallBack_1:
   \   000014   7402         MOV     A,#0x2
   \   000016   8006         SJMP    ??halTimerSendCallBack_3
   \                     ??halTimerSendCallBack_0:
   \   000018   7401         MOV     A,#0x1
   \   00001A   8002         SJMP    ??halTimerSendCallBack_3
   \                     ??halTimerSendCallBack_2:
   \   00001C   7403         MOV     A,#0x3
   \                     ??halTimerSendCallBack_3:
   \   00001E   75F00A       MOV     B,#0xa
   \   000021   A4           MUL     AB
   \   000022   F8           MOV     R0,A
   \   000023   A9F0         MOV     R1,B
   \   000025   74..         MOV     A,#(halTimerRecord + 8) & 0xff
   \   000027   28           ADD     A,R0
   \   000028   F582         MOV     DPL,A
   \   00002A   74..         MOV     A,#((halTimerRecord + 8) >> 8) & 0xff
   \   00002C   39           ADDC    A,R1
   \   00002D   F583         MOV     DPH,A
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F8           MOV     R0,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F9           MOV     R1,A
   \   000034   8882         MOV     DPL,R0
   \   000036   8983         MOV     DPH,R1
   \   000038   E582         MOV     A,DPL
   \   00003A   4583         ORL     A,DPH
   \   00003C   6005         JZ      ??halTimerSendCallBack_4
    656          
    657            if (halTimerRecord[hwtimerid].callBackFunc)
    658              (halTimerRecord[hwtimerid].callBackFunc) (timerId, channel, channelMode);
   \   00003E                ; Setup parameters for indirect call
   \   00003E   A9..         MOV     R1,?V0 + 0
   \   000040   12....       LCALL   ?CALL_IND
    659          }
   \                     ??halTimerSendCallBack_4:
   \   000043   80..         SJMP    ?Subroutine1
    660          
    661          /***************************************************************************************************
    662           * @fn      halTimerRemap
    663           *
    664           * @brief   Maps API HAL_TIMER_ID to HW Timer ID.
    665           *          HAL_TIMER_0 --> HW Timer 3 8bit
    666           *          HAL_TIMER_2 --> HW Timer 4 8bit
    667           *          HAL_TIMER_3 --> HW Timer 1 16bit
    668           *
    669           * @param   timerId - ID of the timer
    670           *
    671           * @return  HW timer ID
    672           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    673          uint8 halTimerRemap (uint8 timerId)
   \                     halTimerRemap:
    674          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   E9           MOV     A,R1
    675            switch (timerId)
   \   000001   6009         JZ      ??halTimerRemap_0
   \   000003   24FE         ADD     A,#-0x2
   \   000005   6009         JZ      ??halTimerRemap_1
   \   000007   14           DEC     A
   \   000008   600A         JZ      ??halTimerRemap_2
   \   00000A   800C         SJMP    ??halTimerRemap_3
    676            {
    677              case HAL_TIMER_0:
    678                return HW_TIMER_3;
   \                     ??halTimerRemap_0:
   \   00000C   7901         MOV     R1,#0x1
   \   00000E   800A         SJMP    ??halTimerRemap_4
    679              case HAL_TIMER_2:
    680                return HW_TIMER_4;
   \                     ??halTimerRemap_1:
   \   000010   7902         MOV     R1,#0x2
   \   000012   8006         SJMP    ??halTimerRemap_4
    681              case HAL_TIMER_3:
    682                return HW_TIMER_1;
   \                     ??halTimerRemap_2:
   \   000014   7900         MOV     R1,#0x0
   \   000016   8002         SJMP    ??halTimerRemap_4
    683              default:
    684                return HW_TIMER_INVALID;
   \                     ??halTimerRemap_3:
   \   000018   7903         MOV     R1,#0x3
   \                     ??halTimerRemap_4:
   \   00001A   02....       LJMP    ?BRET
    685            }
    686          }
    687          
    688          /***************************************************************************************************
    689           * @fn      halProcessTimer1
    690           *
    691           * @brief   Processes Timer 1 Events.
    692           *
    693           * @param
    694           *
    695           * @return
    696           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    697          void halProcessTimer1 (void)
   \                     halProcessTimer1:
    698          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    699            if (halTimerRecord[halTimerRemap(HAL_TIMER_3)].channelMode == HAL_TIMER_CH_MODE_OUTPUT_COMPARE)
   \   000004   90....       MOV     DPTR,#halTimerRecord + 4
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F8           MOV     R0,A
   \   000009   7402         MOV     A,#0x2
   \   00000B   68           XRL     A,R0
   \   00000C   7069         JNZ     ??halProcessTimer1_0
    700            {
    701              if (T1CTL & T1CTL_CH0IF)
   \   00000E   E5E4         MOV     A,0xe4
   \   000010   A2E5         MOV     C,0xE0 /* A   */.5
   \   000012   501E         JNC     ??halProcessTimer1_1
    702              {
    703                T1CTL &= ~(T1CTL_CH0IF);
   \   000014   53E4DF       ANL     0xe4,#0xdf
    704                halTimerSendCallBack (HAL_TIMER_3, HAL_TIMER_CHANNEL_A, HAL_TIMER_CH_MODE_OUTPUT_COMPARE);
   \   000017   90....       MOV     DPTR,#halTimerRecord + 8
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F8           MOV     R0,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F9           MOV     R1,A
   \   00001F   8882         MOV     DPL,R0
   \   000021   8983         MOV     DPH,R1
   \   000023   E582         MOV     A,DPL
   \   000025   4583         ORL     A,DPH
   \   000027   6009         JZ      ??halProcessTimer1_1
   \   000029                ; Setup parameters for indirect call
   \   000029   7B02         MOV     R3,#0x2
   \   00002B   7A02         MOV     R2,#0x2
   \   00002D   7903         MOV     R1,#0x3
   \   00002F   12....       LCALL   ?CALL_IND
    705              }
    706              if (T1CTL & T1CTL_CH1IF)
   \                     ??halProcessTimer1_1:
   \   000032   E5E4         MOV     A,0xe4
   \   000034   A2E6         MOV     C,0xE0 /* A   */.6
   \   000036   501E         JNC     ??halProcessTimer1_2
    707              {
    708                T1CTL &= ~(T1CTL_CH1IF);
   \   000038   53E4BF       ANL     0xe4,#0xbf
    709                halTimerSendCallBack (HAL_TIMER_3, HAL_TIMER_CHANNEL_B, HAL_TIMER_CH_MODE_OUTPUT_COMPARE);
   \   00003B   90....       MOV     DPTR,#halTimerRecord + 8
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F8           MOV     R0,A
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F9           MOV     R1,A
   \   000043   8882         MOV     DPL,R0
   \   000045   8983         MOV     DPH,R1
   \   000047   E582         MOV     A,DPL
   \   000049   4583         ORL     A,DPH
   \   00004B   6009         JZ      ??halProcessTimer1_2
   \   00004D                ; Setup parameters for indirect call
   \   00004D   7B02         MOV     R3,#0x2
   \   00004F   7A04         MOV     R2,#0x4
   \   000051   7903         MOV     R1,#0x3
   \   000053   12....       LCALL   ?CALL_IND
    710              }
    711              if (T1CTL & T1CTL_CH2IF)
   \                     ??halProcessTimer1_2:
   \   000056   E5E4         MOV     A,0xe4
   \   000058   A2E7         MOV     C,0xE0 /* A   */.7
   \   00005A   5044         JNC     ??halProcessTimer1_3
    712              {
    713                T1CTL &= ~(T1CTL_CH2IF);
   \   00005C   53E47F       ANL     0xe4,#0x7f
    714                halTimerSendCallBack (HAL_TIMER_3, HAL_TIMER_CHANNEL_C, HAL_TIMER_CH_MODE_OUTPUT_COMPARE);
   \   00005F   90....       MOV     DPTR,#halTimerRecord + 8
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F8           MOV     R0,A
   \   000064   A3           INC     DPTR
   \   000065   E0           MOVX    A,@DPTR
   \   000066   F9           MOV     R1,A
   \   000067   8882         MOV     DPL,R0
   \   000069   8983         MOV     DPH,R1
   \   00006B   E582         MOV     A,DPL
   \   00006D   4583         ORL     A,DPH
   \   00006F   602F         JZ      ??halProcessTimer1_3
   \   000071                ; Setup parameters for indirect call
   \   000071   7B02         MOV     R3,#0x2
   \   000073   7A08         MOV     R2,#0x8
   \   000075   8024         SJMP    ??halProcessTimer1_4
    715              }
    716            }
    717            else if (halTimerRecord[halTimerRemap(HAL_TIMER_3)].channelMode == HAL_TIMER_CH_MODE_OVERFLOW)
   \                     ??halProcessTimer1_0:
   \   000077   7404         MOV     A,#0x4
   \   000079   68           XRL     A,R0
   \   00007A   7024         JNZ     ??halProcessTimer1_3
    718            {
    719              if (T1CTL & T1CTL_OVFIF)
   \   00007C   E5E4         MOV     A,0xe4
   \   00007E   A2E4         MOV     C,0xE0 /* A   */.4
   \   000080   501E         JNC     ??halProcessTimer1_3
    720              {
    721                T1CTL &= ~(T1CTL_OVFIF);
   \   000082   53E4EF       ANL     0xe4,#0xef
    722                halTimerSendCallBack (HAL_TIMER_3, HAL_TIMER_CHANNEL_SINGLE, HAL_TIMER_CH_MODE_OVERFLOW);
   \   000085   90....       MOV     DPTR,#halTimerRecord + 8
   \   000088   E0           MOVX    A,@DPTR
   \   000089   F8           MOV     R0,A
   \   00008A   A3           INC     DPTR
   \   00008B   E0           MOVX    A,@DPTR
   \   00008C   F9           MOV     R1,A
   \   00008D   8882         MOV     DPL,R0
   \   00008F   8983         MOV     DPH,R1
   \   000091   E582         MOV     A,DPL
   \   000093   4583         ORL     A,DPH
   \   000095   6009         JZ      ??halProcessTimer1_3
   \   000097                ; Setup parameters for indirect call
   \   000097   7B04         MOV     R3,#0x4
   \   000099   7A01         MOV     R2,#0x1
   \                     ??halProcessTimer1_4:
   \   00009B   7903         MOV     R1,#0x3
   \   00009D   12....       LCALL   ?CALL_IND
    723              }
    724            }
    725          }
   \                     ??halProcessTimer1_3:
   \   0000A0                REQUIRE ?Subroutine0
   \   0000A0                REQUIRE T1CTL
   \   0000A0                ; // Fall through to label ?Subroutine0
    726          
    727          /***************************************************************************************************
    728           * @fn      halProcessTimer3
    729           *
    730           * @brief   Processes Timer 3 Events.
    731           *
    732           * @param
    733           *
    734           * @return
    735           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    736          void halProcessTimer3 (void)
   \                     halProcessTimer3:
    737          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    738            if (halTimerRecord[halTimerRemap(HAL_TIMER_0)].channelMode == HAL_TIMER_CH_MODE_OUTPUT_COMPARE)
   \   000004   90....       MOV     DPTR,#halTimerRecord + 14
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F8           MOV     R0,A
   \   000009   7402         MOV     A,#0x2
   \   00000B   68           XRL     A,R0
   \   00000C   703F         JNZ     ??halProcessTimer3_0
    739            {
    740              if (TIMIF & TIMIF_T3CH0IF)
   \   00000E   A2D9         MOV     C,0xd8.1
   \   000010   501D         JNC     ??halProcessTimer3_1
    741              {
    742                TIMIF &= ~(TIMIF_T3CH0IF);
   \   000012   C2D9         CLR     0xd8.1
    743                halTimerSendCallBack (HAL_TIMER_0, HAL_TIMER_CHANNEL_A, HAL_TIMER_CH_MODE_OUTPUT_COMPARE);
   \   000014   90....       MOV     DPTR,#halTimerRecord + 18
   \   000017   E0           MOVX    A,@DPTR
   \   000018   F8           MOV     R0,A
   \   000019   A3           INC     DPTR
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F9           MOV     R1,A
   \   00001C   8882         MOV     DPL,R0
   \   00001E   8983         MOV     DPH,R1
   \   000020   E582         MOV     A,DPL
   \   000022   4583         ORL     A,DPH
   \   000024   6009         JZ      ??halProcessTimer3_1
   \   000026                ; Setup parameters for indirect call
   \   000026   7B02         MOV     R3,#0x2
   \   000028   7A02         MOV     R2,#0x2
   \   00002A   7900         MOV     R1,#0x0
   \   00002C   12....       LCALL   ?CALL_IND
    744              }
    745              if (TIMIF & TIMIF_T3CH1IF)
   \                     ??halProcessTimer3_1:
   \   00002F   A2DA         MOV     C,0xd8.2
   \   000031   5040         JNC     ??halProcessTimer3_2
    746              {
    747                TIMIF &= ~(TIMIF_T3CH1IF);
   \   000033   C2DA         CLR     0xd8.2
    748                halTimerSendCallBack (HAL_TIMER_0, HAL_TIMER_CHANNEL_B, HAL_TIMER_CH_MODE_OUTPUT_COMPARE);
   \   000035   90....       MOV     DPTR,#halTimerRecord + 18
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F8           MOV     R0,A
   \   00003A   A3           INC     DPTR
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   F9           MOV     R1,A
   \   00003D   8882         MOV     DPL,R0
   \   00003F   8983         MOV     DPH,R1
   \   000041   E582         MOV     A,DPL
   \   000043   4583         ORL     A,DPH
   \   000045   602C         JZ      ??halProcessTimer3_2
   \   000047                ; Setup parameters for indirect call
   \   000047   7B02         MOV     R3,#0x2
   \   000049   7A04         MOV     R2,#0x4
   \   00004B   8021         SJMP    ??halProcessTimer3_3
    749              }
    750            }
    751            else if (halTimerRecord[halTimerRemap(HAL_TIMER_0)].channelMode == HAL_TIMER_CH_MODE_OVERFLOW)
   \                     ??halProcessTimer3_0:
   \   00004D   7404         MOV     A,#0x4
   \   00004F   68           XRL     A,R0
   \   000050   7021         JNZ     ??halProcessTimer3_2
    752            {
    753              if (TIMIF & TIMIF_T3OVFIF)
   \   000052   A2D8         MOV     C,0xd8.0
   \   000054   501D         JNC     ??halProcessTimer3_2
    754              {
    755                TIMIF &= ~(TIMIF_T3OVFIF);
   \   000056   C2D8         CLR     0xd8.0
    756                halTimerSendCallBack (HAL_TIMER_0, HAL_TIMER_CHANNEL_SINGLE, HAL_TIMER_CH_MODE_OVERFLOW);
   \   000058   90....       MOV     DPTR,#halTimerRecord + 18
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   F8           MOV     R0,A
   \   00005D   A3           INC     DPTR
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   F9           MOV     R1,A
   \   000060   8882         MOV     DPL,R0
   \   000062   8983         MOV     DPH,R1
   \   000064   E582         MOV     A,DPL
   \   000066   4583         ORL     A,DPH
   \   000068   6009         JZ      ??halProcessTimer3_2
   \   00006A                ; Setup parameters for indirect call
   \   00006A   7B04         MOV     R3,#0x4
   \   00006C   7A01         MOV     R2,#0x1
   \                     ??halProcessTimer3_3:
   \   00006E   7900         MOV     R1,#0x0
   \   000070   12....       LCALL   ?CALL_IND
    757              }
    758            }
    759          }
   \                     ??halProcessTimer3_2:
   \   000073   80..         SJMP    ?Subroutine0
   \   000075                REQUIRE _A_TIMIF
    760          
    761          /***************************************************************************************************
    762           * @fn      halProcessTimer4
    763           *
    764           * @brief   Processes Timer 4 Events.
    765           *
    766           * @param
    767           *
    768           * @return
    769           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    770          void halProcessTimer4 (void)
   \                     halProcessTimer4:
    771          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    772            if (halTimerRecord[halTimerRemap(HAL_TIMER_2)].channelMode == HAL_TIMER_CH_MODE_OUTPUT_COMPARE)
   \   000004   90....       MOV     DPTR,#halTimerRecord + 24
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F8           MOV     R0,A
   \   000009   7402         MOV     A,#0x2
   \   00000B   68           XRL     A,R0
   \   00000C   703F         JNZ     ??halProcessTimer4_0
    773            {
    774              if (TIMIF & TIMIF_T4CH0IF)
   \   00000E   A2DC         MOV     C,0xd8.4
   \   000010   501D         JNC     ??halProcessTimer4_1
    775              {
    776                TIMIF &= ~(TIMIF_T4CH0IF);
   \   000012   C2DC         CLR     0xd8.4
    777                halTimerSendCallBack (HAL_TIMER_2, HAL_TIMER_CHANNEL_A, HAL_TIMER_CH_MODE_OUTPUT_COMPARE);
   \   000014   90....       MOV     DPTR,#halTimerRecord + 28
   \   000017   E0           MOVX    A,@DPTR
   \   000018   F8           MOV     R0,A
   \   000019   A3           INC     DPTR
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F9           MOV     R1,A
   \   00001C   8882         MOV     DPL,R0
   \   00001E   8983         MOV     DPH,R1
   \   000020   E582         MOV     A,DPL
   \   000022   4583         ORL     A,DPH
   \   000024   6009         JZ      ??halProcessTimer4_1
   \   000026                ; Setup parameters for indirect call
   \   000026   7B02         MOV     R3,#0x2
   \   000028   7A02         MOV     R2,#0x2
   \   00002A   7902         MOV     R1,#0x2
   \   00002C   12....       LCALL   ?CALL_IND
    778              }
    779              if (TIMIF & TIMIF_T4CH1IF)
   \                     ??halProcessTimer4_1:
   \   00002F   A2DD         MOV     C,0xd8.5
   \   000031   5040         JNC     ??halProcessTimer4_2
    780              {
    781                TIMIF &= ~(TIMIF_T4CH1IF);
   \   000033   C2DD         CLR     0xd8.5
    782                halTimerSendCallBack (HAL_TIMER_2, HAL_TIMER_CHANNEL_B, HAL_TIMER_CH_MODE_OUTPUT_COMPARE);
   \   000035   90....       MOV     DPTR,#halTimerRecord + 28
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F8           MOV     R0,A
   \   00003A   A3           INC     DPTR
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   F9           MOV     R1,A
   \   00003D   8882         MOV     DPL,R0
   \   00003F   8983         MOV     DPH,R1
   \   000041   E582         MOV     A,DPL
   \   000043   4583         ORL     A,DPH
   \   000045   602C         JZ      ??halProcessTimer4_2
   \   000047                ; Setup parameters for indirect call
   \   000047   7B02         MOV     R3,#0x2
   \   000049   7A04         MOV     R2,#0x4
   \   00004B   8021         SJMP    ??halProcessTimer4_3
    783              }
    784            }
    785            else if (halTimerRecord[halTimerRemap(HAL_TIMER_2)].channelMode == HAL_TIMER_CH_MODE_OVERFLOW)
   \                     ??halProcessTimer4_0:
   \   00004D   7404         MOV     A,#0x4
   \   00004F   68           XRL     A,R0
   \   000050   7021         JNZ     ??halProcessTimer4_2
    786            if (TIMIF & TIMIF_T4OVFIF)
   \   000052   A2DB         MOV     C,0xd8.3
   \   000054   501D         JNC     ??halProcessTimer4_2
    787            {
    788              TIMIF &= ~(TIMIF_T4OVFIF);
   \   000056   C2DB         CLR     0xd8.3
    789              halTimerSendCallBack (HAL_TIMER_2, HAL_TIMER_CHANNEL_SINGLE, HAL_TIMER_CH_MODE_OVERFLOW);
   \   000058   90....       MOV     DPTR,#halTimerRecord + 28
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   F8           MOV     R0,A
   \   00005D   A3           INC     DPTR
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   F9           MOV     R1,A
   \   000060   8882         MOV     DPL,R0
   \   000062   8983         MOV     DPH,R1
   \   000064   E582         MOV     A,DPL
   \   000066   4583         ORL     A,DPH
   \   000068   6009         JZ      ??halProcessTimer4_2
   \   00006A                ; Setup parameters for indirect call
   \   00006A   7B04         MOV     R3,#0x4
   \   00006C   7A01         MOV     R2,#0x1
   \                     ??halProcessTimer4_3:
   \   00006E   7902         MOV     R1,#0x2
   \   000070   12....       LCALL   ?CALL_IND
    790            }
    791          }
   \                     ??halProcessTimer4_2:
   \   000073   02....       LJMP    ?Subroutine0 & 0xFFFF
   \   000076                REQUIRE _A_TIMIF
    792          
    793          /***************************************************************************************************
    794           *                                    INTERRUPT SERVICE ROUTINE
    795           ***************************************************************************************************/
    796          
    797          /**************************************************************************************************
    798           * @fn      halTimer1Isr
    799           *
    800           * @brief   Timer 1 ISR
    801           *
    802           * @param
    803           *
    804           * @return
    805           **************************************************************************************************/

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
    806          HAL_ISR_FUNCTION( halTimer1Isr, T1_VECTOR )
   \                     halTimer1Isr:
    807          {
   \   000000   C0E0         PUSH    A
   \   000002   C0D0         PUSH    PSW
   \   000004   E8           MOV     A,R0
   \   000005   C0E0         PUSH    A
   \   000007   E9           MOV     A,R1
   \   000008   C0E0         PUSH    A
   \   00000A   EA           MOV     A,R2
   \   00000B   C0E0         PUSH    A
   \   00000D   EB           MOV     A,R3
   \   00000E   C0E0         PUSH    A
   \   000010   EC           MOV     A,R4
   \   000011   C0E0         PUSH    A
   \   000013   ED           MOV     A,R5
   \   000014   C0E0         PUSH    A
   \   000016   C082         PUSH    DPL
   \   000018   C083         PUSH    DPH
   \   00001A   C0F0         PUSH    B
   \   00001C                ; Saved register size: 11
   \   00001C                ; Auto size: 0
    808            halProcessTimer1 ();
   \   00001C                ; Setup parameters for call to function halProcessTimer1
   \   00001C   12....       LCALL   ??halProcessTimer1?relay
    809          }
   \   00001F                REQUIRE ?Subroutine2
   \   00001F                ; // Fall through to label ?Subroutine2

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   D0F0         POP     B
   \   000002   D083         POP     DPH
   \   000004   D082         POP     DPL
   \   000006   D0E0         POP     A
   \   000008   FD           MOV     R5,A
   \   000009   D0E0         POP     A
   \   00000B   FC           MOV     R4,A
   \   00000C   D0E0         POP     A
   \   00000E   FB           MOV     R3,A
   \   00000F   D0E0         POP     A
   \   000011   FA           MOV     R2,A
   \   000012   D0E0         POP     A
   \   000014   F9           MOV     R1,A
   \   000015   D0E0         POP     A
   \   000017   F8           MOV     R0,A
   \   000018   D0D0         POP     PSW
   \   00001A   D0E0         POP     A
   \   00001C   32           RETI
    810          
    811          /**************************************************************************************************
    812           * @fn      halTimer3Isr
    813           *
    814           * @brief   Timer 3 ISR
    815           *
    816           * @param
    817           *
    818           * @return
    819           **************************************************************************************************/

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
    820          HAL_ISR_FUNCTION( halTimer3Isr, T3_VECTOR )
   \                     halTimer3Isr:
    821          {
   \   000000   C0E0         PUSH    A
   \   000002   C0D0         PUSH    PSW
   \   000004   E8           MOV     A,R0
   \   000005   C0E0         PUSH    A
   \   000007   E9           MOV     A,R1
   \   000008   C0E0         PUSH    A
   \   00000A   EA           MOV     A,R2
   \   00000B   C0E0         PUSH    A
   \   00000D   EB           MOV     A,R3
   \   00000E   C0E0         PUSH    A
   \   000010   EC           MOV     A,R4
   \   000011   C0E0         PUSH    A
   \   000013   ED           MOV     A,R5
   \   000014   C0E0         PUSH    A
   \   000016   C082         PUSH    DPL
   \   000018   C083         PUSH    DPH
   \   00001A   C0F0         PUSH    B
   \   00001C                ; Saved register size: 11
   \   00001C                ; Auto size: 0
    822            halProcessTimer3 ();
   \   00001C                ; Setup parameters for call to function halProcessTimer3
   \   00001C   12....       LCALL   ??halProcessTimer3?relay
    823          }
   \   00001F   80..         SJMP    ?Subroutine2
    824          
    825          /**************************************************************************************************
    826           * @fn      halTimer4Isr
    827           *
    828           * @brief   Timer 4 ISR
    829           *
    830           * @param
    831           *
    832           * @return
    833           **************************************************************************************************/

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
    834          HAL_ISR_FUNCTION( halTimer4Isr, T4_VECTOR )
   \                     halTimer4Isr:
    835          {
   \   000000   C0E0         PUSH    A
   \   000002   C0D0         PUSH    PSW
   \   000004   E8           MOV     A,R0
   \   000005   C0E0         PUSH    A
   \   000007   E9           MOV     A,R1
   \   000008   C0E0         PUSH    A
   \   00000A   EA           MOV     A,R2
   \   00000B   C0E0         PUSH    A
   \   00000D   EB           MOV     A,R3
   \   00000E   C0E0         PUSH    A
   \   000010   EC           MOV     A,R4
   \   000011   C0E0         PUSH    A
   \   000013   ED           MOV     A,R5
   \   000014   C0E0         PUSH    A
   \   000016   C082         PUSH    DPL
   \   000018   C083         PUSH    DPH
   \   00001A   C0F0         PUSH    B
   \   00001C                ; Saved register size: 11
   \   00001C                ; Auto size: 0
    836            halProcessTimer4 ();
   \   00001C                ; Setup parameters for call to function halProcessTimer4
   \   00001C   12....       LCALL   ??halProcessTimer4?relay
    837          }
   \   00001F   80..         SJMP    ?Subroutine2

   \                                 In  segment INTVEC, offset 0x4b, root
   \                     `??halTimer1Isr??INTVEC 75`:
   \   00004B   02....       LJMP       (halTimer1Isr)

   \                                 In  segment INTVEC, offset 0x5b, root
   \                     `??halTimer3Isr??INTVEC 91`:
   \   00005B   02....       LJMP       (halTimer3Isr)

   \                                 In  segment INTVEC, offset 0x63, root
   \                     `??halTimer4Isr??INTVEC 99`:
   \   000063   02....       LJMP       (halTimer4Isr)

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalTimerInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalTimerInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalTimerConfig?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalTimerConfig

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalTimerStart?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalTimerStart

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalTimerTick?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalTimerTick

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalTimerStop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalTimerStop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halTimerSetCount?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halTimerSetCount

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halTimerSetPrescale?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halTimerSetPrescale

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halTimerSetOpMode?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halTimerSetOpMode

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halTimerSetChannelMode?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halTimerSetChannelMode

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalTimerInterruptEnable?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalTimerInterruptEnable

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halTimerSendCallBack?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halTimerSendCallBack

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halTimerRemap?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halTimerRemap

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halProcessTimer1?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halProcessTimer1

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halProcessTimer3?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halProcessTimer3

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halProcessTimer4?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halProcessTimer4
    838          
    839          /***************************************************************************************************
    840          ***************************************************************************************************/
    841          

   Maximum stack usage in bytes:

     Function                     ISTACK PSTACK XSTACK
     --------                     ------ ------ ------
     HalTimerConfig                   1      0     12
     HalTimerInit                     2      0      0
     HalTimerInterruptEnable          0      0     26
     HalTimerStart                    1      0     17
       -> HalTimerInterruptEnable     0      0     34
     HalTimerStop                     0      0      0
     HalTimerTick                     2      0      0
       -> halProcessTimer1            4      0      0
       -> halProcessTimer3            4      0      0
       -> halProcessTimer4            4      0      0
     halProcessTimer1                 2      0      0
     halProcessTimer3                 2      0      0
     halProcessTimer4                 2      0      0
     halTimer1Isr                    11      0      0
       -> halProcessTimer1           22      0      0
     halTimer3Isr                    11      0      0
       -> halProcessTimer3           22      0      0
     halTimer4Isr                    11      0      0
       -> halProcessTimer4           22      0      0
     halTimerRemap                    0      0      0
     halTimerSendCallBack             0      0      9
     halTimerSetChannelMode           2      0      0
     halTimerSetCount                 1      0     16
     halTimerSetOpMode                0      0      0
     halTimerSetPrescale              0      0      0


   Segment part sizes:

     Function/Label                  Bytes
     --------------                  -----
     _A_IEN1                            1
     T3CTL                              1
     T3CCTL0                            1
     T3CCTL1                            1
     _A_TIMIF                           1
     T1CTL                              1
     T1CCTL0                            1
     T1CCTL1                            1
     T1CCTL2                            1
     T4CTL                              1
     T4CCTL0                            1
     T4CCTL1                            1
     halTimerRecord                    30
     halTimerChannel                   30
     HalTimerInit                     222
     ?Subroutine0                       7
     HalTimerConfig                   152
     HalTimerStart                    392
     HalTimerTick                      34
     HalTimerStop                      35
     halTimerSetCount                 132
     halTimerSetPrescale               42
     halTimerSetOpMode                106
     halTimerSetChannelMode            70
     HalTimerInterruptEnable          197
     ?Subroutine1                       5
     halTimerSendCallBack              69
     halTimerRemap                     29
     halProcessTimer1                 160
     halProcessTimer3                 117
     halProcessTimer4                 118
     halTimer1Isr                      31
     ?Subroutine2                      29
     halTimer3Isr                      33
     halTimer4Isr                      33
     ??halTimer1Isr??INTVEC 75          3
     ??halTimer3Isr??INTVEC 91          3
     ??halTimer4Isr??INTVEC 99          3
     ??HalTimerInit?relay               6
     ??HalTimerConfig?relay             6
     ??HalTimerStart?relay              6
     ??HalTimerTick?relay               6
     ??HalTimerStop?relay               6
     ??halTimerSetCount?relay           6
     ??halTimerSetPrescale?relay        6
     ??halTimerSetOpMode?relay          6
     ??halTimerSetChannelMode?relay     6
     ??HalTimerInterruptEnable?relay    6
     ??halTimerSendCallBack?relay       6
     ??halTimerRemap?relay              6
     ??halProcessTimer1?relay           6
     ??halProcessTimer3?relay           6
     ??halProcessTimer4?relay           6

 
 1 887 bytes in segment BANKED_CODE
    90 bytes in segment BANK_RELAYS
     9 bytes in segment INTVEC
   126 bytes in segment NEAR_CODE
    12 bytes in segment SFR_AN
    60 bytes in segment XDATA_Z
 
 2 103 bytes of CODE  memory (+  9 bytes shared)
     0 bytes of DATA  memory (+ 12 bytes shared)
    60 bytes of XDATA memory

Errors: none
Warnings: none
