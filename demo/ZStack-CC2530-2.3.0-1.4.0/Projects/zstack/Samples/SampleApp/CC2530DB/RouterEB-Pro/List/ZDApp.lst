###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         23/May/2015  15:18:49 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Components\stack\zdo\ZDApp.c                       #
#    Command line       =  -f E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4 #
#                          .0\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\Tools\CC2530DB\f8wRouter.cfg (-DCPU32MHZ      #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DRTR_NWK -DBLINK_LEDS) -f                       #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\Tools\CC2530DB\f8wConfig.cfg (-DSECURE=0         #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF1                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Components\stack\zdo\ZDApp.c -D ZIGBEEPRO -D       #
#                          ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC  #
#                          -D LCD_SUPPORTED=DEBUG -D ROUTER_ME -lC            #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\List\ -lA E:\wireless-switch\demo\ZStack-CC2 #
#                          530-2.3.0-1.4.0\Projects\zstack\Samples\SampleApp\ #
#                          CC2530DB\RouterEB-Pro\List\ --diag_suppress        #
#                          Pe001,Pa010 -o E:\wireless-switch\demo\ZStack-CC25 #
#                          30-2.3.0-1.4.0\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\RouterEB-Pro\Obj\ -e --debug --core=plain  #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I E:\wireless-switch\demo\ZS #
#                          tack-CC2530-2.3.0-1.4.0\Projects\zstack\Samples\Sa #
#                          mpleApp\CC2530DB\ -I E:\wireless-switch\demo\ZStac #
#                          k-CC2530-2.3.0-1.4.0\Projects\zstack\Samples\Sampl #
#                          eApp\CC2530DB\..\SOURCE\ -I                        #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\ZMAIN\TI2530DB\ -I E:\wireless-switch\demo\ZStac #
#                          k-CC2530-2.3.0-1.4.0\Projects\zstack\Samples\Sampl #
#                          eApp\CC2530DB\..\..\..\..\..\COMPONENTS\MT\ -I     #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\HAL\INCLUDE\ -I                 #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\HAL\TARGET\CC2530EB\ -I         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\OSAL\MCU\CCSOC\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\OSAL\INCLUDE\ -I                #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\AF\ -I                    #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\NWK\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SEC\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SAPI\ -I                  #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SYS\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\ZDO\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\ZMAC\F8W\ -I                    #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\ZMAC\ -I                        #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\SERVICES\SADDR\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\SERVICES\SDATA\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\INCLUDE\ -I                 #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\HIGH_LEVEL\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\ -I         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP #
#                          \ -Ohs --require_prototypes                        #
#    List file          =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\List\ZDApp.lst                               #
#    Object file        =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\Obj\ZDApp.r51                                #
#                                                                             #
#                                                                             #
###############################################################################

E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\Components\stack\zdo\ZDApp.c
      1          /**************************************************************************************************
      2            Filename:       ZDApp.c
      3            Revised:        $Date: 2010-01-04 12:16:55 -0800 (Mon, 04 Jan 2010) $
      4            Revision:       $Revision: 21428 $
      5          
      6            Description:    This file contains the interface to the Zigbee Device Application. This is the
      7                            Application part that the use can change. This also contains the Task functions.
      8          
      9          
     10            Copyright 2004-2009 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com. 
     39          **************************************************************************************************/
     40          
     41          /*********************************************************************
     42           * INCLUDES
     43           */
     44          #include "ZComDef.h"
     45          #include "ZMac.h"
     46          #include "OSAL.h"
     47          #include "OSAL_Tasks.h"
     48          #include "OSAL_PwrMgr.h"
     49          #include "OSAL_Nv.h"
     50          #include "AF.h"
     51          #include "APSMEDE.h"
     52          #include "NLMEDE.h"
     53          #include "AddrMgr.h"
     54          #include "ZDProfile.h"
     55          #include "ZDObject.h"
     56          #include "ZDConfig.h"
     57          #include "ZDSecMgr.h"
     58          #include "ZDApp.h"
     59          #include "DebugTrace.h"
     60          #include "nwk_util.h"
     61          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc9
   \   unsigned char volatile __sfr WDCTL
   \                     WDCTL:
   \   000000                DS 1
     62          #include "ZGlobals.h"
     63          #include "ZDNwkMgr.h"
     64          #include "rtg.h"
     65          
     66          #include "ssp.h"
     67          
     68          /* HAL */
     69          #include "hal_led.h"
     70          #include "hal_lcd.h"
     71          #include "hal_key.h"
     72          
     73          #if defined( MT_MAC_FUNC ) || defined( MT_MAC_CB_FUNC )
     74            #error "ERROR! MT_MAC functionalities should be disabled on ZDO devices"
     75          #endif
     76          /*********************************************************************
     77           * MACROS
     78           */
     79          
     80          /*********************************************************************
     81           * CONSTANTS
     82           */
     83          #if !defined( NWK_START_DELAY )
     84            #define NWK_START_DELAY             100   // in milliseconds
     85          #endif
     86          
     87          #if !defined( EXTENDED_JOINING_RANDOM_MASK )
     88            #define EXTENDED_JOINING_RANDOM_MASK 0x007F
     89          #endif
     90          
     91          #if !defined( BEACON_REQUEST_DELAY )
     92            #define BEACON_REQUEST_DELAY        100   // in milliseconds
     93          #endif
     94          
     95          #if !defined( BEACON_REQ_DELAY_MASK )
     96            #define BEACON_REQ_DELAY_MASK       0x007F
     97          #endif
     98          
     99          #define MAX_RESUME_RETRY            3
    100          
    101          #define MAX_DEVICE_UNAUTH_TIMEOUT   5000  // 5 seconds
    102          
    103          // Beacon Order Settings (see NLMEDE.h)
    104          #define DEFAULT_BEACON_ORDER        BEACON_ORDER_NO_BEACONS
    105          #define DEFAULT_SUPERFRAME_ORDER    DEFAULT_BEACON_ORDER
    106          
    107          #if !defined( MAX_NWK_FRAMECOUNTER_CHANGES )
    108            // The number of times the frame counter can change before
    109            // saving to NV
    110            #define MAX_NWK_FRAMECOUNTER_CHANGES    1000
    111          #endif
    112          
    113          // Leave control bits
    114          #define ZDAPP_LEAVE_CTRL_INIT 0
    115          #define ZDAPP_LEAVE_CTRL_SET  1
    116          #define ZDAPP_LEAVE_CTRL_RA   2
    117          
    118          // Standard time to update NWK NV data
    119          #define ZDAPP_UPDATE_NWK_NV_TIME 700
    120          
    121          // Address Manager Stub Implementation
    122          #define ZDApp_NwkWriteNVRequest AddrMgrWriteNVRequest
    123          
    124          // Size of the ZDO callback function table zdoCBFunc[]
    125          #define MAX_ZDO_CB_FUNC 1
    126          
    127          
    128          /*********************************************************************
    129           * GLOBAL VARIABLES
    130           */
    131          
    132          #if defined( LCD_SUPPORTED )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    133            uint8 MatchRsps = 0;
   \                     MatchRsps:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    134          #endif
    135          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    136          uint8 zdoDiscCounter = 1;
   \                     zdoDiscCounter:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zdoDiscCounter>`
   \   000001                REQUIRE __INIT_XDATA_I
    137          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    138          zAddrType_t ZDAppNwkAddr;
   \                     ZDAppNwkAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z
    139          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    140          uint8 zdappMgmtNwkDiscRspTransSeq;
   \                     zdappMgmtNwkDiscRspTransSeq:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    141          uint8 zdappMgmtNwkDiscReqInProgress = FALSE;
   \                     zdappMgmtNwkDiscReqInProgress:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    142          zAddrType_t zdappMgmtNwkDiscRspAddr;
   \                     zdappMgmtNwkDiscRspAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    143          uint8 zdappMgmtNwkDiscStartIndex;
   \                     zdappMgmtNwkDiscStartIndex:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    144          uint8 zdappMgmtSavedNwkState;
   \                     zdappMgmtSavedNwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    145          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    146          uint16 nwkFrameCounterChanges = 0;
   \                     nwkFrameCounterChanges:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    147          uint8 continueJoining = TRUE;
   \                     continueJoining:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for continueJoining>`
   \   000001                REQUIRE __INIT_XDATA_I
    148          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    149          uint8  _tmpRejoinState;
   \                     _tmpRejoinState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    150          
    151          // The extended PanID used in ZDO layer for rejoin.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    152          uint8 ZDO_UseExtendedPANID[Z_EXTADDR_LEN];
   \                     ZDO_UseExtendedPANID:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
    153          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    154          pfnZdoCb zdoCBFunc[MAX_ZDO_CB_FUNC];
   \                     zdoCBFunc:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    155          
    156          /*********************************************************************
    157           * EXTERNAL VARIABLES
    158           */
    159          
    160          /*********************************************************************
    161           * EXTERNAL FUNCTIONS
    162           */
    163          
    164          /*********************************************************************
    165           * LOCAL FUNCTIONS
    166           */
    167          
    168          void ZDApp_NetworkStartEvt( void );
    169          void ZDApp_DeviceAuthEvt( void );
    170          void ZDApp_SaveNetworkStateEvt( void );
    171          
    172          uint8 ZDApp_ReadNetworkRestoreState( void );
    173          uint8 ZDApp_RestoreNetworkState( void );
    174          void ZDAppDetermineDeviceType( void );
    175          void ZDApp_InitUserDesc( void );
    176          void ZDAppCheckForHoldKey( void );
    177          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr );
    178          void ZDApp_ProcessNetworkJoin( void );
    179          void ZDApp_SetCoordAddress( uint8 endPoint, uint8 dstEP );
    180          void ZDApp_SaveNwkKey( void );
    181          uint8 ZDApp_RestoreNwkKey( void );
    182            
    183          void ZDApp_SecInit( uint8 state );
    184          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events );
    185          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr );
    186          
    187          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf );
    188          
    189          void ZDApp_ResetTimerStart( uint16 delay );
    190          void ZDApp_ResetTimerCancel( void );
    191          void ZDApp_LeaveCtrlInit( void );
    192          void ZDApp_LeaveCtrlSet( uint8 ra );
    193          uint8 ZDApp_LeaveCtrlBypass( void );
    194          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay );
    195          void ZDApp_LeaveReset( uint8 ra );
    196          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
    197                                  uint8 removeChildren );
    198          void ZDApp_NodeProfileSync( ZDO_NetworkDiscoveryCfm_t* cfm );
    199          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg );
    200          void ZDApp_RegisterCBs( void );
    201          
    202          /*********************************************************************
    203           * LOCAL VARIABLES
    204           */
    205          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    206          uint8 ZDAppTaskID;
   \                     ZDAppTaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    207          uint8 nwkStatus;
   \                     nwkStatus:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    208          endPointDesc_t *ZDApp_AutoFindMode_epDesc = (endPointDesc_t *)NULL;
   \                     ZDApp_AutoFindMode_epDesc:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    209          uint8 ZDApp_LeaveCtrl;
   \                     ZDApp_LeaveCtrl:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    210          
    211          #if defined( HOLD_AUTO_START )
    212            devStates_t devState = DEV_HOLD;
    213          #else

   \                                 In  segment XDATA_I, align 1, keep-with-next
    214            devStates_t devState = DEV_INIT;
   \                     devState:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for devState>`
   \   000001                REQUIRE __INIT_XDATA_I
    215          #endif
    216          
    217          #if ( ZG_BUILD_RTRONLY_TYPE ) || ( ZG_BUILD_ENDDEVICE_TYPE )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    218            devStartModes_t devStartMode = MODE_JOIN;     // Assume joining
   \                     devStartMode:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    219            //devStartModes_t devStartMode = MODE_RESUME; // if already "directly joined"
    220                                  // to parent. Set to make the device do an Orphan scan.
    221          #else
    222            // Set the default to coodinator
    223            devStartModes_t devStartMode = MODE_HARD;
    224          #endif
    225          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    226          uint8 retryCnt;
   \                     retryCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    227          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    228          endPointDesc_t ZDApp_epDesc =
   \                     ZDApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for ZDApp_epDesc>`
   \   000006                REQUIRE __INIT_XDATA_I
    229          {
    230            ZDO_EP,
    231            &ZDAppTaskID,
    232            (SimpleDescriptionFormat_t *)NULL,  // No Simple description for ZDO
    233            (afNetworkLatencyReq_t)0            // No Network Latency req
    234          };
    235          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    236          uint16 ZDApp_SavedPollRate = POLL_RATE;
   \                     ZDApp_SavedPollRate:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for ZDApp_SavedPollRate>`
   \   000002                REQUIRE __INIT_XDATA_I
    237          
    238          /*********************************************************************
    239           * @fn      ZDApp_Init
    240           *
    241           * @brief   ZDApp Initialization function.
    242           *
    243           * @param   task_id - ZDApp Task ID
    244           *
    245           * @return  None
    246           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    247          void ZDApp_Init( uint8 task_id )
   \                     ZDApp_Init:
    248          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    249            // Save the task ID
    250            ZDAppTaskID = task_id;
   \   000006   90....       MOV     DPTR,#ZDAppTaskID
   \   000009   F0           MOVX    @DPTR,A
    251          
    252            // Initialize the ZDO global device short address storage
    253            ZDAppNwkAddr.addrMode = Addr16Bit;
   \   00000A   90....       MOV     DPTR,#ZDAppNwkAddr + 8
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    254            ZDAppNwkAddr.addr.shortAddr = INVALID_NODE_ADDR;
   \   000010   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000013   74FE         MOV     A,#-0x2
   \   000015   F0           MOVX    @DPTR,A
   \   000016   A3           INC     DPTR
   \   000017   04           INC     A
   \   000018   F0           MOVX    @DPTR,A
    255            (void)NLME_GetExtAddr();  // Load the saveExtAddr pointer.
   \   000019                ; Setup parameters for call to function NLME_GetExtAddr
   \   000019   12....       LCALL   ??NLME_GetExtAddr?relay
    256          
    257            // Check for manual "Hold Auto Start"
    258            ZDAppCheckForHoldKey();
   \   00001C                ; Setup parameters for call to function HalKeyRead
   \   00001C   12....       LCALL   ??HalKeyRead?relay
   \   00001F   E9           MOV     A,R1
   \   000020   6401         XRL     A,#0x1
   \   000022   7005         JNZ     ??ZDApp_Init_0
   \   000024   90....       MOV     DPTR,#devState
   \   000027   E4           CLR     A
   \   000028   F0           MOVX    @DPTR,A
    259          
    260            // Initialize ZDO items and setup the device - type of device to create.
    261            ZDO_Init();
   \                     ??ZDApp_Init_0:
   \   000029                ; Setup parameters for call to function ZDO_Init
   \   000029   12....       LCALL   ??ZDO_Init?relay
    262          
    263            // Register the endpoint description with the AF
    264            // This task doesn't have a Simple description, but we still need
    265            // to register the endpoint.
    266            afRegister( (endPointDesc_t *)&ZDApp_epDesc );
   \   00002C                ; Setup parameters for call to function afRegister
   \   00002C   7A..         MOV     R2,#ZDApp_epDesc & 0xff
   \   00002E   7B..         MOV     R3,#(ZDApp_epDesc >> 8) & 0xff
   \   000030   12....       LCALL   ??afRegister?relay
    267          
    268          #if defined( ZDO_USERDESC_RESPONSE )
    269            ZDApp_InitUserDesc();
   \   000033                ; Setup parameters for call to function ZDApp_InitUserDesc
   \   000033   12....       LCALL   ??ZDApp_InitUserDesc?relay
    270          #endif // ZDO_USERDESC_RESPONSE
    271          
    272            // Start the device?
    273            if ( devState != DEV_HOLD )
   \   000036   90....       MOV     DPTR,#devState
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   6009         JZ      ??ZDApp_Init_1
    274            {
    275              ZDOInitDevice( 0 );
   \   00003C                ; Setup parameters for call to function ZDOInitDevice
   \   00003C   7A00         MOV     R2,#0x0
   \   00003E   7B00         MOV     R3,#0x0
   \   000040   12....       LCALL   ??ZDOInitDevice?relay
   \   000043   800D         SJMP    ??ZDApp_Init_2
    276            }
    277            else
    278            {
    279              // Blink LED to indicate HOLD_START
    280              HalLedBlink ( HAL_LED_4, 0, 50, 500 );
   \                     ??ZDApp_Init_1:
   \   000045                ; Setup parameters for call to function HalLedBlink
   \   000045   7CF4         MOV     R4,#-0xc
   \   000047   7D01         MOV     R5,#0x1
   \   000049   7B32         MOV     R3,#0x32
   \   00004B   7A00         MOV     R2,#0x0
   \   00004D   7908         MOV     R1,#0x8
   \   00004F   12....       LCALL   ??HalLedBlink?relay
    281            }
    282            
    283            ZDApp_RegisterCBs();
   \                     ??ZDApp_Init_2:
   \   000052                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000052   7A01         MOV     R2,#0x1
   \   000054   7B80         MOV     R3,#-0x80
   \   000056   90....       MOV     DPTR,#ZDAppTaskID
   \   000059   E0           MOVX    A,@DPTR
   \   00005A   F9           MOV     R1,A
   \   00005B   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   00005E                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00005E   7A00         MOV     R2,#0x0
   \   000060   7B80         MOV     R3,#-0x80
   \   000062   90....       MOV     DPTR,#ZDAppTaskID
   \   000065   E0           MOVX    A,@DPTR
   \   000066   F9           MOV     R1,A
   \   000067   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   00006A                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00006A   7A21         MOV     R2,#0x21
   \   00006C   7B00         MOV     R3,#0x0
   \   00006E   90....       MOV     DPTR,#ZDAppTaskID
   \   000071   E0           MOVX    A,@DPTR
   \   000072   F9           MOV     R1,A
   \   000073   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   000076                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000076   7A22         MOV     R2,#0x22
   \   000078   7B00         MOV     R3,#0x0
   \   00007A   90....       MOV     DPTR,#ZDAppTaskID
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   F9           MOV     R1,A
   \   00007F   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    284          } /* ZDApp_Init() */
   \   000082   02....       LJMP    ??Subroutine7_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine7_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    285          
    286          /*********************************************************************
    287           * @fn          ZDApp_SecInit
    288           *
    289           * @brief       ZDApp initialize security.
    290           *
    291           * @param       state - device initialization state
    292           *
    293           * @return      none
    294           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    295          void ZDApp_SecInit( uint8 state )
   \                     ZDApp_SecInit:
    296          {  
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    297            if ( ZG_SECURE_ENABLED && ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    298            {
    299              // Set the Trust Center bit
    300              ZDO_Config_Node_Descriptor.ServerMask |= PRIM_TRUST_CENTER;
    301            }
    302          
    303            if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
    304            {
    305              ZDO_Config_Node_Descriptor.CapabilityFlags |= CAPINFO_SECURITY_CAPABLE;
    306            }
    307              
    308            // Initialize ZigBee Device Security Manager
    309            ZDSecMgrInit(state);
   \   000005                ; Setup parameters for call to function ZDSecMgrInit
   \   000005   12....       LCALL   ??ZDSecMgrInit?relay
    310          
    311            if ( ZG_SECURE_ENABLED )
    312            {
    313              if ( state != ZDO_INITDEV_RESTORED_NETWORK_STATE )
    314              {
    315                nwkFrameCounter = 0;
    316            
    317                if( _NIB.nwkKeyLoaded == FALSE )
    318                {
    319                  if ( ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE          ) ||
    320                       ( ( zgSecurityMode == ZG_SECURITY_RESIDENTIAL ) && zgPreConfigKeys )    )
    321                  {
    322                      SSP_UpdateNwkKey( (byte*)zgPreConfigKey, 0);
    323                      SSP_SwitchNwkKey( 0 );
    324                  }
    325                }
    326              }
    327            }    
    328          }
   \   000008   02....       LJMP    ??Subroutine7_0 & 0xFFFF
    329          
    330          /*********************************************************************
    331           * @fn      ZDApp_event_loop()
    332           *
    333           * @brief   Main event loop for Zigbee device objects task. This function
    334           *          should be called at periodic intervals.
    335           *
    336           * @param   task_id - Task ID
    337           * @param   events  - Bitmap of events
    338           *
    339           * @return  none
    340           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    341          UINT16 ZDApp_event_loop( uint8 task_id, UINT16 events )
   \                     ZDApp_event_loop:
    342          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    343            uint8 *msg_ptr;
    344          
    345            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   7031         JNZ     ??ZDApp_event_loop_0
    346            {
    347              while ( (msg_ptr = osal_msg_receive( ZDAppTaskID )) )
    348              {
    349                ZDApp_ProcessOSALMsg( (osal_event_hdr_t *)msg_ptr );
    350          
    351                // Release the memory
    352                osal_msg_deallocate( msg_ptr );
    353              }
    354          
    355              // Return unprocessed events
    356              return (events ^ SYS_EVENT_MSG);
    357            }
    358          
    359            if ( events & ZDO_NETWORK_INIT )
   \   00000D   EE           MOV     A,R6
   \   00000E   A2E0         MOV     C,0xE0 /* A   */.0
   \   000010   5045         JNC     ??ZDApp_event_loop_1
    360            {
    361              // Initialize apps and start the network
    362              devState = DEV_INIT;
   \   000012   90....       MOV     DPTR,#devState
   \   000015   7401         MOV     A,#0x1
   \   000017   F0           MOVX    @DPTR,A
    363              
    364              ZDO_StartDevice( (uint8)ZDO_Config_Node_Descriptor.LogicalType, devStartMode,
    365                               DEFAULT_BEACON_ORDER, DEFAULT_SUPERFRAME_ORDER );
   \   000018                ; Setup parameters for call to function ZDO_StartDevice
   \   000018   7C0F         MOV     R4,#0xf
   \   00001A   7B0F         MOV     R3,#0xf
   \   00001C   90....       MOV     DPTR,#devStartMode
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   FA           MOV     R2,A
   \   000021   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000024   E0           MOVX    A,@DPTR
   \   000025   5407         ANL     A,#0x7
   \   000027   F9           MOV     R1,A
   \   000028   12....       LCALL   ??ZDO_StartDevice?relay
    366          
    367              // Return unprocessed events
    368              return (events ^ ZDO_NETWORK_INIT);
   \   00002B   EE           MOV     A,R6
   \   00002C   6401         XRL     A,#0x1
   \                     ??ZDApp_event_loop_2:
   \   00002E   FA           MOV     R2,A
   \   00002F   EF           MOV     A,R7
   \                     ??ZDApp_event_loop_3:
   \   000030   FB           MOV     R3,A
   \   000031   02....       LJMP    ??ZDApp_event_loop_4 & 0xFFFF
    369            }
   \                     ??ZDApp_event_loop_5:
   \   000034                ; Setup parameters for call to function ZDApp_ProcessOSALMsg
   \   000034   12....       LCALL   ??ZDApp_ProcessOSALMsg?relay
   \   000037                ; Setup parameters for call to function osal_msg_deallocate
   \   000037   AA..         MOV     R2,?V0 + 0
   \   000039   AB..         MOV     R3,?V0 + 1
   \   00003B   12....       LCALL   ??osal_msg_deallocate?relay
   \                     ??ZDApp_event_loop_0:
   \   00003E                ; Setup parameters for call to function osal_msg_receive
   \   00003E   90....       MOV     DPTR,#ZDAppTaskID
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F9           MOV     R1,A
   \   000043   12....       LCALL   ??osal_msg_receive?relay
   \   000046   8A..         MOV     ?V0 + 0,R2
   \   000048   8B..         MOV     ?V0 + 1,R3
   \   00004A   A9..         MOV     R1,?V0 + 1
   \   00004C   EA           MOV     A,R2
   \   00004D   49           ORL     A,R1
   \   00004E   70E4         JNZ     ??ZDApp_event_loop_5
   \   000050   EE           MOV     A,R6
   \   000051   FA           MOV     R2,A
   \   000052   EF           MOV     A,R7
   \   000053   6480         XRL     A,#0x80
   \   000055   80D9         SJMP    ??ZDApp_event_loop_3
    370          
    371            if ( ZSTACK_ROUTER_BUILD )
    372            {
    373              if ( events & ZDO_NETWORK_START )
   \                     ??ZDApp_event_loop_1:
   \   000057   5402         ANL     A,#0x2
   \   000059   6008         JZ      ??ZDApp_event_loop_6
    374              {
    375                ZDApp_NetworkStartEvt();
   \   00005B                ; Setup parameters for call to function ZDApp_NetworkStartEvt
   \   00005B   12....       LCALL   ??ZDApp_NetworkStartEvt?relay
    376            
    377                // Return unprocessed events
    378                return (events ^ ZDO_NETWORK_START);
   \   00005E   EE           MOV     A,R6
   \   00005F   6402         XRL     A,#0x2
   \                     ??ZDApp_event_loop_7:
   \   000061   80CB         SJMP    ??ZDApp_event_loop_2
    379              }
    380          
    381              if ( events & ZDO_ROUTER_START )
   \                     ??ZDApp_event_loop_6:
   \   000063   EE           MOV     A,R6
   \   000064   5420         ANL     A,#0x20
   \   000066   6027         JZ      ??ZDApp_event_loop_8
    382              {
    383                if ( nwkStatus == ZSuccess )
   \   000068   90....       MOV     DPTR,#nwkStatus
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   7010         JNZ     ??ZDApp_event_loop_9
    384                {
    385                  if ( devState == DEV_END_DEVICE )
   \   00006E   90....       MOV     DPTR,#devState
   \   000071   E0           MOVX    A,@DPTR
   \   000072   6406         XRL     A,#0x6
   \   000074   7003         JNZ     ??ZDApp_event_loop_10
    386                    devState = DEV_ROUTER;
   \   000076   7407         MOV     A,#0x7
   \   000078   F0           MOVX    @DPTR,A
    387            
    388                  osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
   \                     ??ZDApp_event_loop_10:
   \   000079                ; Setup parameters for call to function osal_pwrmgr_device
   \   000079   7900         MOV     R1,#0x0
   \   00007B   12....       LCALL   ??osal_pwrmgr_device?relay
    389                }
    390                else
    391                {
    392                  // remain as end device!!
    393                }
    394                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \                     ??ZDApp_event_loop_9:
   \   00007E                ; Setup parameters for call to function osal_set_event
   \   00007E   7A10         MOV     R2,#0x10
   \   000080   7B00         MOV     R3,#0x0
   \   000082   90....       MOV     DPTR,#ZDAppTaskID
   \   000085   E0           MOVX    A,@DPTR
   \   000086   F9           MOV     R1,A
   \   000087   12....       LCALL   ??osal_set_event?relay
    395            
    396                // Return unprocessed events
    397                return (events ^ ZDO_ROUTER_START);
   \   00008A   EE           MOV     A,R6
   \   00008B   6420         XRL     A,#0x20
   \   00008D   809F         SJMP    ??ZDApp_event_loop_2
    398              }
    399            }
    400            
    401            if ( events & ZDO_STATE_CHANGE_EVT )
   \                     ??ZDApp_event_loop_8:
   \   00008F   EE           MOV     A,R6
   \   000090   5410         ANL     A,#0x10
   \   000092   6025         JZ      ??ZDApp_event_loop_11
    402            {
    403              ZDO_UpdateNwkStatus( devState );
   \   000094                ; Setup parameters for call to function ZDO_UpdateNwkStatus
   \   000094   90....       MOV     DPTR,#devState
   \   000097   E0           MOVX    A,@DPTR
   \   000098   F9           MOV     R1,A
   \   000099   12....       LCALL   ??ZDO_UpdateNwkStatus?relay
    404              
    405              // At start up, do one MTO route discovery if the device is a concentrator
    406              if ( zgConcentratorEnable == TRUE ) 
   \   00009C   90....       MOV     DPTR,#zgConcentratorEnable
   \   00009F   E0           MOVX    A,@DPTR
   \   0000A0   6401         XRL     A,#0x1
   \   0000A2   7010         JNZ     ??ZDApp_event_loop_12
    407              {
    408                // Start next event
    409                osal_start_timerEx( NWK_TaskID, NWK_MTO_RTG_REQ_EVT, 100 );
   \   0000A4                ; Setup parameters for call to function osal_start_timerEx
   \   0000A4   7C64         MOV     R4,#0x64
   \   0000A6   7D00         MOV     R5,#0x0
   \   0000A8   7A00         MOV     R2,#0x0
   \   0000AA   7B08         MOV     R3,#0x8
   \   0000AC   90....       MOV     DPTR,#NWK_TaskID
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   F9           MOV     R1,A
   \   0000B1   12....       LCALL   ??osal_start_timerEx?relay
    410              }
    411              
    412              // Return unprocessed events
    413              return (events ^ ZDO_STATE_CHANGE_EVT);
   \                     ??ZDApp_event_loop_12:
   \   0000B4   EE           MOV     A,R6
   \   0000B5   6410         XRL     A,#0x10
   \   0000B7   80A8         SJMP    ??ZDApp_event_loop_7
    414            }
    415          
    416            if ( events & ZDO_COMMAND_CNF )
   \                     ??ZDApp_event_loop_11:
   \   0000B9   EE           MOV     A,R6
   \   0000BA   5408         ANL     A,#0x8
   \   0000BC   6006         JZ      ??ZDApp_event_loop_13
    417            {
    418              // User defined logic
    419          
    420              // Return unprocessed events
    421              return (events ^ ZDO_COMMAND_CNF);
   \   0000BE   EE           MOV     A,R6
   \   0000BF   6408         XRL     A,#0x8
   \   0000C1   FA           MOV     R2,A
   \   0000C2   801E         SJMP    ??ZDApp_event_loop_4
    422            }
    423            
    424            if ( events & ZDO_NWK_UPDATE_NV )
   \                     ??ZDApp_event_loop_13:
   \   0000C4   EF           MOV     A,R7
   \   0000C5   5402         ANL     A,#0x2
   \   0000C7   6006         JZ      ??ZDApp_event_loop_14
    425            {
    426              ZDApp_SaveNetworkStateEvt();
    427          
    428              // Return unprocessed events
    429              return (events ^ ZDO_NWK_UPDATE_NV);
   \   0000C9   EF           MOV     A,R7
   \   0000CA   6402         XRL     A,#0x2
   \   0000CC   02....       LJMP    ??ZDApp_event_loop_3 & 0xFFFF
    430            }
    431          
    432            if ( events & ZDO_DEVICE_RESET )
   \                     ??ZDApp_event_loop_14:
   \   0000CF   EE           MOV     A,R6
   \   0000D0   5404         ANL     A,#0x4
   \   0000D2   600A         JZ      ??ZDApp_event_loop_15
    433            {
    434              // The device has been in the UNAUTH state, so reset
    435              // Note: there will be no return from this call
    436              SystemReset();
   \   0000D4   C2AF         CLR     0xa8.7
   \   0000D6   75C9AB       MOV     0xc9,#-0x55
   \   0000D9   75C95B       MOV     0xc9,#0x5b
   \                     ??ZDApp_event_loop_16:
   \   0000DC   80FE         SJMP    ??ZDApp_event_loop_16
    437            }
    438          
    439            if ( ZG_SECURE_ENABLED )
    440            {
    441              return ( ZDApp_ProcessSecEvent( task_id, events ) );
    442            }
    443            else
    444            {
    445              // Discard or make more handlers
    446              return 0;
   \                     ??ZDApp_event_loop_15:
   \   0000DE   7A00         MOV     R2,#0x0
   \   0000E0   7B00         MOV     R3,#0x0
    447            }
   \                     ??ZDApp_event_loop_4:
   \   0000E2   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   \   0000E5                REQUIRE _A_IEN0
   \   0000E5                REQUIRE WDCTL
    448          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine10_0:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    449          
    450          /*********************************************************************
    451           * @fn      ZDApp_ProcessSecEvent()
    452           *
    453           * @brief   Process incoming security events.
    454           *
    455           * @param   task_id - Task ID
    456           * @param   events  - Bitmap of events
    457           *
    458           * @return  none
    459           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    460          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events )
   \                     ZDApp_ProcessSecEvent:
    461          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    462            (void)task_id;  // Intentionally unreferenced parameter
    463            
    464            if ( ZSTACK_ROUTER_BUILD )
    465            {
    466              if ( events & ZDO_NEW_DEVICE )
   \   00000E   EE           MOV     A,R6
   \   00000F   5440         ANL     A,#0x40
   \   000011   6021         JZ      ??ZDApp_ProcessSecEvent_0
    467              {
    468                // process the new device event
    469                if ( ZDSecMgrNewDeviceEvent() == TRUE )
   \   000013                ; Setup parameters for call to function ZDSecMgrNewDeviceEvent
   \   000013   12....       LCALL   ??ZDSecMgrNewDeviceEvent?relay
   \   000016   E9           MOV     A,R1
   \   000017   6401         XRL     A,#0x1
   \   000019   7010         JNZ     ??ZDApp_ProcessSecEvent_1
    470                {
    471                  osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 1000 );
   \   00001B                ; Setup parameters for call to function osal_start_timerEx
   \   00001B   7CE8         MOV     R4,#-0x18
   \   00001D   7D03         MOV     R5,#0x3
   \   00001F   7A40         MOV     R2,#0x40
   \   000021   7B00         MOV     R3,#0x0
   \   000023   90....       MOV     DPTR,#ZDAppTaskID
   \   000026   E0           MOVX    A,@DPTR
   \   000027   F9           MOV     R1,A
   \   000028   12....       LCALL   ??osal_start_timerEx?relay
    472                }
    473          
    474                // Return unprocessed events
    475                return (events ^ ZDO_NEW_DEVICE);
   \                     ??ZDApp_ProcessSecEvent_1:
   \   00002B   EE           MOV     A,R6
   \   00002C   6440         XRL     A,#0x40
   \                     ??ZDApp_ProcessSecEvent_2:
   \   00002E   FA           MOV     R2,A
   \   00002F   EF           MOV     A,R7
   \   000030   FB           MOV     R3,A
   \   000031   02....       LJMP    ??ZDApp_ProcessSecEvent_3 & 0xFFFF
    476              }
    477            }
    478          
    479            if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH) 
    480                || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
    481            {
    482              if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    483              { 
    484                if ( events & ZDO_SECMGR_EVENT )
    485                {
    486                  ZDSecMgrEvent();
    487          
    488                  // Return unprocessed events
    489                  return (events ^ ZDO_SECMGR_EVENT);
    490                }
    491              }
    492            }
    493            
    494            if ( events & ZDO_DEVICE_AUTH )
   \                     ??ZDApp_ProcessSecEvent_0:
   \   000034   EE           MOV     A,R6
   \   000035   5480         ANL     A,#0x80
   \   000037   6008         JZ      ??ZDApp_ProcessSecEvent_4
    495            {
    496              ZDApp_DeviceAuthEvt();
   \   000039                ; Setup parameters for call to function ZDApp_DeviceAuthEvt
   \   000039   12....       LCALL   ??ZDApp_DeviceAuthEvt?relay
    497          
    498              // Return unprocessed events
    499              return (events ^ ZDO_DEVICE_AUTH);
   \   00003C   EE           MOV     A,R6
   \   00003D   6480         XRL     A,#0x80
   \   00003F   80ED         SJMP    ??ZDApp_ProcessSecEvent_2
    500            }
    501          
    502            if ( events & ZDO_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_4:
   \   000041   EF           MOV     A,R7
   \   000042   5404         ANL     A,#0x4
   \   000044   607B         JZ      ??ZDApp_ProcessSecEvent_5
    503            {
    504              if ( nwkFrameCounterChanges++ > MAX_NWK_FRAMECOUNTER_CHANGES )
   \   000046   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   F8           MOV     R0,A
   \   00004B   A3           INC     DPTR
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   F9           MOV     R1,A
   \   00004E   E8           MOV     A,R0
   \   00004F   2401         ADD     A,#0x1
   \   000051   FA           MOV     R2,A
   \   000052   E9           MOV     A,R1
   \   000053   3400         ADDC    A,#0x0
   \   000055   FB           MOV     R3,A
   \   000056   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000059   EA           MOV     A,R2
   \   00005A   F0           MOVX    @DPTR,A
   \   00005B   A3           INC     DPTR
   \   00005C   EB           MOV     A,R3
   \   00005D   F0           MOVX    @DPTR,A
   \   00005E   C3           CLR     C
   \   00005F   E8           MOV     A,R0
   \   000060   94E9         SUBB    A,#-0x17
   \   000062   E9           MOV     A,R1
   \   000063   9403         SUBB    A,#0x3
   \   000065   4052         JC      ??ZDApp_ProcessSecEvent_6
    505                ZDApp_SaveNwkKey();
   \   000067                ; Setup parameters for call to function SSP_ReadNwkActiveKey
   \   000067   85..82       MOV     DPL,?XSP + 0
   \   00006A   85..83       MOV     DPH,?XSP + 1
   \   00006D   AA82         MOV     R2,DPL
   \   00006F   AB83         MOV     R3,DPH
   \   000071   12....       LCALL   ??SSP_ReadNwkActiveKey?relay
   \   000074   90....       MOV     DPTR,#__Constant_1
   \   000077   78..         MOV     R0,#?V0 + 0
   \   000079   12....       LCALL   ?L_MOV_X
   \   00007C   7411         MOV     A,#0x11
   \   00007E   12....       LCALL   ?XSTACK_DISP0_8
   \   000081   78..         MOV     R0,#?V0 + 0
   \   000083   12....       LCALL   ?L_ADD_TO_X
   \   000086                ; Setup parameters for call to function osal_nv_write
   \   000086   85..82       MOV     DPL,?XSP + 0
   \   000089   85..83       MOV     DPH,?XSP + 1
   \   00008C   8582..       MOV     ?V0 + 0,DPL
   \   00008F   8583..       MOV     ?V0 + 1,DPH
   \   000092   78..         MOV     R0,#?V0 + 0
   \   000094   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000097   75..15       MOV     ?V0 + 0,#0x15
   \   00009A   75..00       MOV     ?V0 + 1,#0x0
   \   00009D   78..         MOV     R0,#?V0 + 0
   \   00009F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A2   7C00         MOV     R4,#0x0
   \   0000A4   7D00         MOV     R5,#0x0
   \   0000A6   7A82         MOV     R2,#-0x7e
   \   0000A8   7B00         MOV     R3,#0x0
   \   0000AA   12....       LCALL   ??osal_nv_write?relay
   \   0000AD   7404         MOV     A,#0x4
   \   0000AF   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B2   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   0000B5   E4           CLR     A
   \   0000B6   F0           MOVX    @DPTR,A
   \   0000B7   A3           INC     DPTR
   \   0000B8   F0           MOVX    @DPTR,A
    506          
    507              // Return unprocessed events
    508              return (events ^ ZDO_FRAMECOUNTER_CHANGE);
   \                     ??ZDApp_ProcessSecEvent_6:
   \   0000B9   EE           MOV     A,R6
   \   0000BA   FA           MOV     R2,A
   \   0000BB   EF           MOV     A,R7
   \   0000BC   6404         XRL     A,#0x4
   \   0000BE   FB           MOV     R3,A
   \   0000BF   8004         SJMP    ??ZDApp_ProcessSecEvent_3
    509            }
    510            
    511            // Discard or make more handlers
    512            return 0;
   \                     ??ZDApp_ProcessSecEvent_5:
   \   0000C1   7A00         MOV     R2,#0x0
   \   0000C3   7B00         MOV     R3,#0x0
   \                     ??ZDApp_ProcessSecEvent_3:
   \   0000C5   02....       LJMP    ?Subroutine2 & 0xFFFF
    513          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7415         MOV     A,#0x15
   \   000002                REQUIRE ??Subroutine9_0
   \   000002                ; // Fall through to label ??Subroutine9_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine9_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F04         MOV     R7,#0x4
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA
    514          
    515          /*********************************************************************
    516           * Application Functions
    517           */
    518          
    519          /*********************************************************************
    520           * @fn      ZDOInitDevice
    521           *
    522           * @brief   Start the device in the network.  This function will read
    523           *   ZCD_NV_STARTUP_OPTION (NV item) to determine whether or not to
    524           *   restore the network state of the device.
    525           *
    526           * @param   startDelay - timeDelay to start device (in milliseconds).
    527           *      There is a jitter added to this delay:
    528           *              ((NWK_START_DELAY + startDelay)
    529           *              + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK))
    530           *
    531           * NOTE:    If the application would like to force a "new" join, the
    532           *          application should set the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    533           *          bit in the ZCD_NV_STARTUP_OPTION NV item before calling
    534           *          this function. "new" join means to not restore the network
    535           *          state of the device. Use zgWriteStartupOptions() to set these
    536           *          options.
    537           *
    538           * @return
    539           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    540           *          restored.
    541           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was initialized.
    542           *          This could mean that ZCD_NV_STARTUP_OPTION said to not restore, or
    543           *          it could mean that there was no network state to restore.
    544           *    ZDO_INITDEV_LEAVE_NOT_STARTED - Before the reset, a network leave was issued
    545           *          with the rejoin option set to TRUE.  So, the device was not
    546           *          started in the network (one time only).  The next time this
    547           *          function is called it will start.
    548           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    549          uint8 ZDOInitDevice( uint16 startDelay )
   \                     ZDOInitDevice:
    550          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    551            uint8 networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    552            uint16 extendedDelay = 0;
    553          
    554            if ( devState == DEV_HOLD )
   \   000005   90....       MOV     DPTR,#devState
   \   000008   E0           MOVX    A,@DPTR
   \   000009   7005         JNZ     ??ZDOInitDevice_0
    555            {    
    556              // Initialize the RAM items table, in case an NV item has been updated.
    557              zgInitItems( FALSE );
   \   00000B                ; Setup parameters for call to function zgInitItems
   \   00000B   7900         MOV     R1,#0x0
   \   00000D   12....       LCALL   ??zgInitItems?relay
    558            }
    559          
    560            ZDConfig_InitDescriptors();
   \                     ??ZDOInitDevice_0:
   \   000010                ; Setup parameters for call to function ZDConfig_InitDescriptors
   \   000010   12....       LCALL   ??ZDConfig_InitDescriptors?relay
    561            //devtag.071807.todo - fix this temporary solution
    562            _NIB.CapabilityInfo = ZDO_Config_Node_Descriptor.CapabilityFlags;
   \   000013   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000016   E0           MOVX    A,@DPTR
   \   000017   90....       MOV     DPTR,#_NIB + 14
   \   00001A   F0           MOVX    @DPTR,A
    563            
    564            devState = DEV_INIT;    // Remove the Hold state
   \   00001B   90....       MOV     DPTR,#devState
   \   00001E   7401         MOV     A,#0x1
   \   000020   F0           MOVX    @DPTR,A
    565          
    566            // Initialize leave control logic
    567            ZDApp_LeaveCtrlInit();
   \   000021   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000024   E4           CLR     A
   \   000025   F0           MOVX    @DPTR,A
   \   000026                ; Setup parameters for call to function osal_nv_item_init
   \   000026   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000029   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   00002C   78..         MOV     R0,#?V0 + 0
   \   00002E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000031   7C01         MOV     R4,#0x1
   \   000033   7D00         MOV     R5,#0x0
   \   000035   7A85         MOV     R2,#-0x7b
   \   000037   7B00         MOV     R3,#0x0
   \   000039   12....       LCALL   ??osal_nv_item_init?relay
   \   00003C   7402         MOV     A,#0x2
   \   00003E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000041   E9           MOV     A,R1
   \   000042   7020         JNZ     ??ZDOInitDevice_1
   \   000044                ; Setup parameters for call to function osal_nv_read
   \   000044   78..         MOV     R0,#?V0 + 0
   \   000046   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000049   75..01       MOV     ?V0 + 0,#0x1
   \   00004C   75..00       MOV     ?V0 + 1,#0x0
   \   00004F   78..         MOV     R0,#?V0 + 0
   \   000051   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000054   7C00         MOV     R4,#0x0
   \   000056   7D00         MOV     R5,#0x0
   \   000058   7A85         MOV     R2,#-0x7b
   \   00005A   7B00         MOV     R3,#0x0
   \   00005C   12....       LCALL   ??osal_nv_read?relay
   \   00005F   7404         MOV     A,#0x4
   \   000061   12....       LCALL   ?DEALLOC_XSTACK8
    568          
    569            // Check leave control reset settings
    570            ZDApp_LeaveCtrlStartup( &devState, &startDelay );
   \                     ??ZDOInitDevice_1:
   \   000064   7E00         MOV     R6,#0x0
   \   000066   7F00         MOV     R7,#0x0
   \   000068   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   A2E0         MOV     C,0xE0 /* A   */.0
   \   00006E   503A         JNC     ??ZDOInitDevice_2
   \   000070   A2E1         MOV     C,0xE0 /* A   */.1
   \   000072   5006         JNC     ??ZDOInitDevice_3
   \   000074   7E88         MOV     R6,#-0x78
   \   000076   7F13         MOV     R7,#0x13
   \   000078   8005         SJMP    ??ZDOInitDevice_4
   \                     ??ZDOInitDevice_3:
   \   00007A   90....       MOV     DPTR,#devState
   \   00007D   E4           CLR     A
   \   00007E   F0           MOVX    @DPTR,A
   \                     ??ZDOInitDevice_4:
   \   00007F   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000082   E4           CLR     A
   \   000083   F0           MOVX    @DPTR,A
   \   000084                ; Setup parameters for call to function osal_nv_write
   \   000084   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000087   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   00008A   78..         MOV     R0,#?V0 + 0
   \   00008C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008F   75..01       MOV     ?V0 + 0,#0x1
   \   000092   75..00       MOV     ?V0 + 1,#0x0
   \   000095   78..         MOV     R0,#?V0 + 0
   \   000097   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009A   7C00         MOV     R4,#0x0
   \   00009C   7D00         MOV     R5,#0x0
   \   00009E   7A85         MOV     R2,#-0x7b
   \   0000A0   7B00         MOV     R3,#0x0
   \   0000A2   12....       LCALL   ??osal_nv_write?relay
   \   0000A5   7404         MOV     A,#0x4
   \   0000A7   12....       LCALL   ?DEALLOC_XSTACK8
    571          
    572            // Leave may make the hold state come back
    573            if ( devState == DEV_HOLD )
   \                     ??ZDOInitDevice_2:
   \   0000AA   90....       MOV     DPTR,#devState
   \   0000AD   E0           MOVX    A,@DPTR
   \   0000AE   7017         JNZ     ??ZDOInitDevice_5
    574            {
    575              // Set the NV startup option to force a "new" join.
    576              zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   0000B0                ; Setup parameters for call to function zgWriteStartupOptions
   \   0000B0   7A02         MOV     R2,#0x2
   \   0000B2   79FF         MOV     R1,#-0x1
   \   0000B4   12....       LCALL   ??zgWriteStartupOptions?relay
    577          
    578              // Notify the applications 
    579              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   0000B7                ; Setup parameters for call to function osal_set_event
   \   0000B7   7A10         MOV     R2,#0x10
   \   0000B9   7B00         MOV     R3,#0x0
   \   0000BB   90....       MOV     DPTR,#ZDAppTaskID
   \   0000BE   E0           MOVX    A,@DPTR
   \   0000BF   F9           MOV     R1,A
   \   0000C0   12....       LCALL   ??osal_set_event?relay
    580              
    581              return ( ZDO_INITDEV_LEAVE_NOT_STARTED );   // Don't join - (one time).
   \   0000C3   7902         MOV     R1,#0x2
   \   0000C5   804A         SJMP    ??ZDOInitDevice_6
    582            }
    583          
    584          #if defined ( NV_RESTORE )
    585            // Get Keypad directly to see if a reset nv is needed.
    586            // Hold down the SW_BYPASS_NV key (defined in OnBoard.h)
    587            // while booting to skip past NV Restore.
    588            if ( HalKeyRead() == SW_BYPASS_NV )
    589              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    590            else
    591            {
    592              // Determine if NV should be restored
    593              networkStateNV = ZDApp_ReadNetworkRestoreState();
    594            }
    595          
    596            if ( networkStateNV == ZDO_INITDEV_RESTORED_NETWORK_STATE )
    597            {
    598              networkStateNV = ZDApp_RestoreNetworkState();
    599            }
    600            else
    601            {
    602              // Wipe out the network state in NV
    603              NLME_InitNV();
    604              NLME_SetDefaultNV();
    605            }
    606          #endif
    607          
    608            if ( networkStateNV == ZDO_INITDEV_NEW_NETWORK_STATE )
    609            {
    610              ZDAppDetermineDeviceType();
   \                     ??ZDOInitDevice_5:
   \   0000C7                ; Setup parameters for call to function ZDAppDetermineDeviceType
   \   0000C7   12....       LCALL   ??ZDAppDetermineDeviceType?relay
    611          
    612              // Only delay if joining network - not restoring network state
    613              extendedDelay = (uint16)((NWK_START_DELAY + startDelay)
    614                        + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK));
   \   0000CA                ; Setup parameters for call to function osal_rand
   \   0000CA   12....       LCALL   ??osal_rand?relay
   \   0000CD   EA           MOV     A,R2
   \   0000CE   547F         ANL     A,#0x7f
   \   0000D0   F8           MOV     R0,A
   \   0000D1   EE           MOV     A,R6
   \   0000D2   28           ADD     A,R0
   \   0000D3   F8           MOV     R0,A
   \   0000D4   EF           MOV     A,R7
   \   0000D5   3400         ADDC    A,#0x0
   \   0000D7   F9           MOV     R1,A
   \   0000D8   E8           MOV     A,R0
   \   0000D9   2464         ADD     A,#0x64
   \   0000DB   FE           MOV     R6,A
   \   0000DC   E9           MOV     A,R1
   \   0000DD   3400         ADDC    A,#0x0
   \   0000DF   FF           MOV     R7,A
    615            }
    616          
    617            // Initialize the security for type of device
    618            ZDApp_SecInit( networkStateNV );
   \   0000E0                ; Setup parameters for call to function ZDSecMgrInit
   \   0000E0   7901         MOV     R1,#0x1
   \   0000E2   12....       LCALL   ??ZDSecMgrInit?relay
    619            
    620            // Trigger the network start
    621            ZDApp_NetworkInit( extendedDelay );
   \   0000E5   EE           MOV     A,R6
   \   0000E6   4F           ORL     A,R7
   \   0000E7   6012         JZ      ??ZDOInitDevice_7
   \   0000E9                ; Setup parameters for call to function osal_start_timerEx
   \   0000E9   EE           MOV     A,R6
   \   0000EA   FC           MOV     R4,A
   \   0000EB   EF           MOV     A,R7
   \   0000EC   FD           MOV     R5,A
   \   0000ED   7A01         MOV     R2,#0x1
   \   0000EF   7B00         MOV     R3,#0x0
   \   0000F1   90....       MOV     DPTR,#ZDAppTaskID
   \   0000F4   E0           MOVX    A,@DPTR
   \   0000F5   F9           MOV     R1,A
   \   0000F6   12....       LCALL   ??osal_start_timerEx?relay
   \   0000F9   800C         SJMP    ??ZDOInitDevice_8
   \                     ??ZDOInitDevice_7:
   \   0000FB                ; Setup parameters for call to function osal_set_event
   \   0000FB   7A01         MOV     R2,#0x1
   \   0000FD   7B00         MOV     R3,#0x0
   \   0000FF   90....       MOV     DPTR,#ZDAppTaskID
   \   000102   E0           MOVX    A,@DPTR
   \   000103   F9           MOV     R1,A
   \   000104   12....       LCALL   ??osal_set_event?relay
    622          
    623            // set broadcast address mask to support broadcast filtering
    624            NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \                     ??ZDOInitDevice_8:
   \   000107                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   000107   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00010A   E0           MOVX    A,@DPTR
   \   00010B   F9           MOV     R1,A
   \   00010C   12....       LCALL   ??NLME_SetBroadcastFilter?relay
    625            
    626            return ( networkStateNV );
   \   00010F   7901         MOV     R1,#0x1
   \                     ??ZDOInitDevice_6:
   \   000111   02....       LJMP    ??Subroutine10_0 & 0xFFFF
    627          }
    628          
    629          /*********************************************************************
    630           * @fn      ZDApp_ReadNetworkRestoreState
    631           *
    632           * @brief   Read the ZCD_NV_STARTUP_OPTION NV Item to state whether
    633           *          or not to restore the network state.
    634           *          If the read value has the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    635           *          bit set return the ZDO_INITDEV_NEW_NETWORK_STATE.
    636           *
    637           * @param   none
    638           *
    639           * @return  ZDO_INITDEV_NEW_NETWORK_STATE
    640           *          or ZDO_INITDEV_RESTORED_NETWORK_STATE based on whether or
    641           *          not ZCD_STARTOPT_DEFAULT_NETWORK_STATE bit is set in
    642           *          ZCD_NV_STARTUP_OPTION
    643           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    644          uint8 ZDApp_ReadNetworkRestoreState( void )
   \                     ZDApp_ReadNetworkRestoreState:
    645          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    646            uint8 networkStateNV = ZDO_INITDEV_RESTORED_NETWORK_STATE;
   \   000005   7E00         MOV     R6,#0x0
    647          
    648            // Look for the New Network State option.
    649            if ( zgReadStartupOptions() & ZCD_STARTOPT_DEFAULT_NETWORK_STATE )
   \   000007                ; Setup parameters for call to function zgReadStartupOptions
   \   000007   12....       LCALL   ??zgReadStartupOptions?relay
   \   00000A   E9           MOV     A,R1
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   5001         JNC     ??ZDApp_ReadNetworkRestoreState_0
    650            {
    651              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
   \   00000F   0E           INC     R6
    652            }
    653          
    654            return ( networkStateNV );
   \                     ??ZDApp_ReadNetworkRestoreState_0:
   \   000010   EE           MOV     A,R6
   \   000011   F9           MOV     R1,A
   \   000012   80..         SJMP    ??Subroutine7_0
    655          }
    656          
    657          /*********************************************************************
    658           * @fn      ZDAppDetermineDeviceType()
    659           *
    660           * @brief   Determines the type of device to start. 
    661           *
    662           *          Looks at zgDeviceLogicalType and determines what type of
    663           *          device to start.  The types are:
    664           *            ZG_DEVICETYPE_COORDINATOR
    665           *            ZG_DEVICETYPE_ROUTER
    666           *            ZG_DEVICETYPE_ENDDEVICE
    667           *
    668           * @param   none
    669           *
    670           * @return  none
    671           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    672          void ZDAppDetermineDeviceType( void )
   \                     ZDAppDetermineDeviceType:
    673          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    674            if ( zgDeviceLogicalType == ZG_DEVICETYPE_COORDINATOR )
   \   000004   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000007   E0           MOVX    A,@DPTR
   \   000008   700E         JNZ     ??ZDAppDetermineDeviceType_0
    675            {
    676              devStartMode = MODE_HARD;     // Start as a coordinator
   \   00000A   90....       MOV     DPTR,#devStartMode
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    677              ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000010   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000013   E0           MOVX    A,@DPTR
   \   000014   54F8         ANL     A,#0xf8
   \   000016   802E         SJMP    ??ZDAppDetermineDeviceType_1
    678            }
    679            else
    680            {
    681              if ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER  )
   \                     ??ZDAppDetermineDeviceType_0:
   \   000018   6401         XRL     A,#0x1
   \   00001A   700A         JNZ     ??ZDAppDetermineDeviceType_2
    682                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_ROUTER;
   \   00001C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   54F8         ANL     A,#0xf8
   \   000022   4401         ORL     A,#0x1
   \   000024   800D         SJMP    ??ZDAppDetermineDeviceType_3
    683              else if ( zgDeviceLogicalType == ZG_DEVICETYPE_ENDDEVICE )
   \                     ??ZDAppDetermineDeviceType_2:
   \   000026   E0           MOVX    A,@DPTR
   \   000027   6402         XRL     A,#0x2
   \   000029   7009         JNZ     ??ZDAppDetermineDeviceType_4
    684                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   00002B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   54F8         ANL     A,#0xf8
   \   000031   4402         ORL     A,#0x2
   \                     ??ZDAppDetermineDeviceType_3:
   \   000033   F0           MOVX    @DPTR,A
    685              
    686              // If AIB_apsUseExtendedPANID is set to a non-zero value by commissioning
    687              // The device shall do rejoin the network. Otherwise, do normal join
    688              if ( nwk_ExtPANIDValid( AIB_apsUseExtendedPANID ) == false )
   \                     ??ZDAppDetermineDeviceType_4:
   \   000034                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000034   7A..         MOV     R2,#AIB_apsUseExtendedPANID & 0xff
   \   000036   7B..         MOV     R3,#(AIB_apsUseExtendedPANID >> 8) & 0xff
   \   000038   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   00003B   E9           MOV     A,R1
   \   00003C   90....       MOV     DPTR,#devStartMode
   \   00003F   7003         JNZ     ??ZDAppDetermineDeviceType_5
    689              {
    690                devStartMode = MODE_JOIN;     // Assume joining
   \   000041   E4           CLR     A
   \   000042   8002         SJMP    ??ZDAppDetermineDeviceType_1
    691              }
    692              else
    693              {
    694                devStartMode = MODE_REJOIN;  
   \                     ??ZDAppDetermineDeviceType_5:
   \   000044   7403         MOV     A,#0x3
   \                     ??ZDAppDetermineDeviceType_1:
   \   000046   F0           MOVX    @DPTR,A
    695              }
    696            }
    697          }
   \   000047   02....       LJMP    ?Subroutine3 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    698          
    699          /*********************************************************************
    700           * @fn      ZDApp_NetworkStartEvt()
    701           *
    702           * @brief   Process the Network Start Event
    703           *
    704           * @param   none
    705           *
    706           * @return  none
    707           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    708          void ZDApp_NetworkStartEvt( void )
   \                     ZDApp_NetworkStartEvt:
    709          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    710            if ( nwkStatus == ZSuccess )
   \   000004   90....       MOV     DPTR,#nwkStatus
   \   000007   E0           MOVX    A,@DPTR
   \   000008   7012         JNZ     ??ZDApp_NetworkStartEvt_0
    711            {
    712              // Successfully started a ZigBee network
    713              if ( devState == DEV_COORD_STARTING )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6408         XRL     A,#0x8
   \   000010   7003         JNZ     ??ZDApp_NetworkStartEvt_1
    714              {
    715                devState = DEV_ZB_COORD;
   \   000012   7409         MOV     A,#0x9
   \   000014   F0           MOVX    @DPTR,A
    716              }
    717          
    718              osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
   \                     ??ZDApp_NetworkStartEvt_1:
   \   000015                ; Setup parameters for call to function osal_pwrmgr_device
   \   000015   7900         MOV     R1,#0x0
   \   000017   12....       LCALL   ??osal_pwrmgr_device?relay
    719              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00001A                ; Setup parameters for call to function osal_set_event
   \   00001A   802B         SJMP    ??ZDApp_NetworkStartEvt_2
    720            }
    721            else
    722            {
    723              // Try again with a higher energy threshold !!
    724              if ( ( NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT ) < 0xff )
   \                     ??ZDApp_NetworkStartEvt_0:
   \   00001C                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   00001C   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   00001F   E9           MOV     A,R1
   \   000020   2410         ADD     A,#0x10
   \   000022   F8           MOV     R0,A
   \   000023   E4           CLR     A
   \   000024   3400         ADDC    A,#0x0
   \   000026   F9           MOV     R1,A
   \   000027   E8           MOV     A,R0
   \   000028   94FF         SUBB    A,#-0x1
   \   00002A   E9           MOV     A,R1
   \   00002B   9400         SUBB    A,#0x0
   \   00002D   C3           CLR     C
   \   00002E   65D0         XRL     A,PSW
   \   000030   33           RLC     A
   \   000031   500E         JNC     ??ZDApp_NetworkStartEvt_3
    725              {
    726                NLME_SetEnergyThreshold( (uint8)(NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT) );
   \   000033                ; Setup parameters for call to function NLME_SetEnergyThreshold
   \   000033                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   000033   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   000036   E9           MOV     A,R1
   \   000037   2410         ADD     A,#0x10
   \   000039   F9           MOV     R1,A
   \   00003A   12....       LCALL   ??NLME_SetEnergyThreshold?relay
    727                osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \   00003D                ; Setup parameters for call to function osal_set_event
   \   00003D   7A01         MOV     R2,#0x1
   \   00003F   8008         SJMP    ??ZDApp_NetworkStartEvt_4
    728              }
    729              else
    730              {
    731                // Failed to start network. Enter a dormant state (until user intervenes)
    732                devState = DEV_INIT;
   \                     ??ZDApp_NetworkStartEvt_3:
   \   000041   90....       MOV     DPTR,#devState
   \   000044   7401         MOV     A,#0x1
   \   000046   F0           MOVX    @DPTR,A
    733                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000047                ; Setup parameters for call to function osal_set_event
   \                     ??ZDApp_NetworkStartEvt_2:
   \   000047   7A10         MOV     R2,#0x10
   \                     ??ZDApp_NetworkStartEvt_4:
   \   000049   7B00         MOV     R3,#0x0
   \   00004B   90....       MOV     DPTR,#ZDAppTaskID
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   F9           MOV     R1,A
   \   000050   12....       LCALL   ??osal_set_event?relay
    734              }
    735            }
    736          }
   \   000053   02....       LJMP    ?Subroutine3 & 0xFFFF
    737          
    738          /*********************************************************************
    739           * @fn      ZDApp_DeviceAuthEvt()
    740           *
    741           * @brief   Process the Device Authentic Event
    742           *
    743           * @param   none
    744           *
    745           * @return  none
    746           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    747          void ZDApp_DeviceAuthEvt( void )
   \                     ZDApp_DeviceAuthEvt:
    748          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    749            // received authentication from trust center
    750            if ( devState == DEV_END_DEVICE_UNAUTH )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6405         XRL     A,#0x5
   \   000010   6003         JZ      $+5
   \   000012   02....       LJMP    ??ZDApp_DeviceAuthEvt_0 & 0xFFFF
    751            {
    752              // Stop the reset timer so it doesn't reset
    753              ZDApp_ResetTimerCancel();
   \   000015                ; Setup parameters for call to function osal_stop_timerEx
   \   000015   7A04         MOV     R2,#0x4
   \   000017   7B00         MOV     R3,#0x0
   \   000019   90....       MOV     DPTR,#ZDAppTaskID
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F9           MOV     R1,A
   \   00001E   12....       LCALL   ??osal_stop_timerEx?relay
    754          
    755              devState = DEV_END_DEVICE;
   \   000021   90....       MOV     DPTR,#devState
   \   000024   7406         MOV     A,#0x6
   \   000026   F0           MOVX    @DPTR,A
    756              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000027                ; Setup parameters for call to function osal_set_event
   \   000027   7A10         MOV     R2,#0x10
   \   000029   7B00         MOV     R3,#0x0
   \   00002B   90....       MOV     DPTR,#ZDAppTaskID
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F9           MOV     R1,A
   \   000030   12....       LCALL   ??osal_set_event?relay
    757          
    758              // Set the Power Manager Device
    759          #if defined ( POWER_SAVING )
    760              osal_pwrmgr_device( PWRMGR_BATTERY );
    761          #endif
    762          
    763              if ( ZSTACK_ROUTER_BUILD )
    764              {
    765                if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \   000033   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000036   E0           MOVX    A,@DPTR
   \   000037   5407         ANL     A,#0x7
   \   000039   6402         XRL     A,#0x2
   \   00003B   6009         JZ      ??ZDApp_DeviceAuthEvt_1
    766                {
    767                  // NOTE: first two parameters are not used, see NLMEDE.h for details
    768                  NLME_StartRouterRequest( 0, 0, false );
   \   00003D                ; Setup parameters for call to function NLME_StartRouterRequest
   \   00003D   7B00         MOV     R3,#0x0
   \   00003F   7A00         MOV     R2,#0x0
   \   000041   7900         MOV     R1,#0x0
   \   000043   12....       LCALL   ??NLME_StartRouterRequest?relay
    769                }
    770              }
    771          
    772              // Notify to save info into NV
    773              ZDApp_NVUpdate();
    774          
    775              // Save off the security
    776              ZDApp_SaveNwkKey();
   \                     ??ZDApp_DeviceAuthEvt_1:
   \   000046                ; Setup parameters for call to function SSP_ReadNwkActiveKey
   \   000046   85..82       MOV     DPL,?XSP + 0
   \   000049   85..83       MOV     DPH,?XSP + 1
   \   00004C   AA82         MOV     R2,DPL
   \   00004E   AB83         MOV     R3,DPH
   \   000050   12....       LCALL   ??SSP_ReadNwkActiveKey?relay
   \   000053   90....       MOV     DPTR,#__Constant_1
   \   000056   78..         MOV     R0,#?V0 + 0
   \   000058   12....       LCALL   ?L_MOV_X
   \   00005B   7411         MOV     A,#0x11
   \   00005D   12....       LCALL   ?XSTACK_DISP0_8
   \   000060   78..         MOV     R0,#?V0 + 0
   \   000062   12....       LCALL   ?L_ADD_TO_X
   \   000065                ; Setup parameters for call to function osal_nv_write
   \   000065   85..82       MOV     DPL,?XSP + 0
   \   000068   85..83       MOV     DPH,?XSP + 1
   \   00006B   8582..       MOV     ?V0 + 0,DPL
   \   00006E   8583..       MOV     ?V0 + 1,DPH
   \   000071   78..         MOV     R0,#?V0 + 0
   \   000073   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000076   75..15       MOV     ?V0 + 0,#0x15
   \   000079   75..00       MOV     ?V0 + 1,#0x0
   \   00007C   78..         MOV     R0,#?V0 + 0
   \   00007E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000081   7C00         MOV     R4,#0x0
   \   000083   7D00         MOV     R5,#0x0
   \   000085   7A82         MOV     R2,#-0x7e
   \   000087   7B00         MOV     R3,#0x0
   \   000089   12....       LCALL   ??osal_nv_write?relay
   \   00008C   7404         MOV     A,#0x4
   \   00008E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000091   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000094   E4           CLR     A
   \   000095   F0           MOVX    @DPTR,A
   \   000096   A3           INC     DPTR
   \   000097   F0           MOVX    @DPTR,A
    777          
    778              ZDApp_AnnounceNewAddress();
   \   000098                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000098   FA           MOV     R2,A
   \   000099   FB           MOV     R3,A
   \   00009A   12....       LCALL   ??APSME_HoldDataRequests?relay
   \   00009D                ; Setup parameters for call to function NLME_GetExtAddr
   \   00009D   12....       LCALL   ??NLME_GetExtAddr?relay
   \   0000A0   8A..         MOV     ?V0 + 0,R2
   \   0000A2   8B..         MOV     ?V0 + 1,R3
   \   0000A4   AE..         MOV     R6,?V0 + 0
   \   0000A6                ; Setup parameters for call to function NLME_GetShortAddr
   \   0000A6   12....       LCALL   ??NLME_GetShortAddr?relay
   \   0000A9                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   0000A9   75..00       MOV     ?V0 + 0,#0x0
   \   0000AC   78..         MOV     R0,#?V0 + 0
   \   0000AE   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000B1   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000B4   E0           MOVX    A,@DPTR
   \   0000B5   F9           MOV     R1,A
   \   0000B6   EE           MOV     A,R6
   \   0000B7   FC           MOV     R4,A
   \   0000B8   AD..         MOV     R5,?V0 + 1
   \   0000BA   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   0000BD   7401         MOV     A,#0x1
   \   0000BF   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000C2                ; Setup parameters for call to function APSME_HoldDataRequests
   \   0000C2   7A00         MOV     R2,#0x0
   \   0000C4   7B00         MOV     R3,#0x0
   \   0000C6   12....       LCALL   ??APSME_HoldDataRequests?relay
    779              
    780              if ( (ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE) == 0 )
   \   0000C9   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000CC   E0           MOVX    A,@DPTR
   \   0000CD   A2E3         MOV     C,0xE0 /* A   */.3
   \   0000CF   400B         JC      ??ZDApp_DeviceAuthEvt_0
    781              {
    782                NLME_SetPollRate( ZDApp_SavedPollRate );
   \   0000D1                ; Setup parameters for call to function NLME_SetPollRate
   \   0000D1   90....       MOV     DPTR,#ZDApp_SavedPollRate
   \   0000D4   E0           MOVX    A,@DPTR
   \   0000D5   FA           MOV     R2,A
   \   0000D6   A3           INC     DPTR
   \   0000D7   E0           MOVX    A,@DPTR
   \   0000D8   FB           MOV     R3,A
   \   0000D9   12....       LCALL   ??NLME_SetPollRate?relay
    783              }
    784            }
    785            else
    786            {
    787              ZDApp_NVUpdate();
    788            }
    789          }
   \                     ??ZDApp_DeviceAuthEvt_0:
   \   0000DC   02....       LJMP    ?Subroutine2 & 0xFFFF
    790          
    791          /*********************************************************************
    792           * @fn      ZDApp_SaveNetworkStateEvt()
    793           *
    794           * @brief   Process the Save the Network State Event
    795           *
    796           * @param   none
    797           *
    798           * @return  none
    799           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    800          void ZDApp_SaveNetworkStateEvt( void )
   \                     ZDApp_SaveNetworkStateEvt:
    801          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    802          #if defined ( NV_RESTORE )
    803           #if defined ( NV_TURN_OFF_RADIO )
    804            // Turn off the radio's receiver during an NV update
    805            uint8 RxOnIdle;
    806            uint8 x = false;
    807            ZMacGetReq( ZMacRxOnIdle, &RxOnIdle );
    808            ZMacSetReq( ZMacRxOnIdle, &x );
    809           #endif
    810          
    811            // Update the Network State in NV
    812            NLME_UpdateNV( NWK_NV_NIB_ENABLE        |
    813                           NWK_NV_DEVICELIST_ENABLE |
    814                           NWK_NV_BINDING_ENABLE    |
    815                           NWK_NV_ADDRMGR_ENABLE );
    816          
    817            // Reset the NV startup option to resume from NV by
    818            // clearing the "New" join option.
    819            zgWriteStartupOptions( FALSE, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
    820          
    821           #if defined ( NV_TURN_OFF_RADIO )
    822            ZMacSetReq( ZMacRxOnIdle, &RxOnIdle );
    823           #endif
    824          #endif  // NV_RESTORE
    825          }
   \   000000   02....       LJMP    ?BRET
    826          
    827          /*********************************************************************
    828           * @fn      ZDApp_RestoreNetworkState()
    829           *
    830           * @brief   This function will restore the network state of the
    831           *          device if the network state is stored in NV.
    832           *
    833           * @param   none
    834           *
    835           * @return
    836           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    837           *          restored.
    838           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was not used.
    839           *          This could mean that zgStartupOption said to not restore, or
    840           *          it could mean that there was no network state to restore.
    841           *
    842           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    843          uint8 ZDApp_RestoreNetworkState( void )
   \                     ZDApp_RestoreNetworkState:
    844          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    845            uint8 nvStat;
    846            nwkActiveKeyItems keyItems;
    847          
    848            // Initialize NWK NV items
    849            nvStat = NLME_InitNV();
   \   000005                ; Setup parameters for call to function NLME_InitNV
   \   000005   12....       LCALL   ??NLME_InitNV?relay
   \   000008   E9           MOV     A,R1
   \   000009   FE           MOV     R6,A
    850          
    851            if ( nvStat != NV_OPER_FAILED )
   \   00000A   740A         MOV     A,#0xa
   \   00000C   6E           XRL     A,R6
   \   00000D   603C         JZ      ??ZDApp_RestoreNetworkState_0
    852            {
    853              if ( NLME_RestoreFromNV() )
   \   00000F                ; Setup parameters for call to function NLME_RestoreFromNV
   \   00000F   12....       LCALL   ??NLME_RestoreFromNV?relay
   \   000012   E9           MOV     A,R1
   \   000013   6036         JZ      ??ZDApp_RestoreNetworkState_0
    854              {
    855                // Are we a coordinator
    856                ZDAppNwkAddr.addr.shortAddr = NLME_GetShortAddr();
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00001B   EA           MOV     A,R2
   \   00001C   F0           MOVX    @DPTR,A
   \   00001D   A3           INC     DPTR
   \   00001E   EB           MOV     A,R3
   \   00001F   F0           MOVX    @DPTR,A
    857                if ( ZDAppNwkAddr.addr.shortAddr == 0 )
   \   000020   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F8           MOV     R0,A
   \   000025   A3           INC     DPTR
   \   000026   E0           MOVX    A,@DPTR
   \   000027   F9           MOV     R1,A
   \   000028   E8           MOV     A,R0
   \   000029   49           ORL     A,R1
   \   00002A   7007         JNZ     ??ZDApp_RestoreNetworkState_1
    858                  ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   00002C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   54F8         ANL     A,#0xf8
   \   000032   F0           MOVX    @DPTR,A
    859                devStartMode = MODE_RESUME;
   \                     ??ZDApp_RestoreNetworkState_1:
   \   000033   90....       MOV     DPTR,#devStartMode
   \   000036   7401         MOV     A,#0x1
   \   000038   F0           MOVX    @DPTR,A
    860                osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
   \   000039                ; Setup parameters for call to function sAddrExtCpy
   \   000039   7C..         MOV     R4,#(_NIB + 53) & 0xff
   \   00003B   7D..         MOV     R5,#((_NIB + 53) >> 8) & 0xff
   \   00003D   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   00003F   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000041   12....       LCALL   ??sAddrExtCpy?relay
    861              }
    862              else
    863                nvStat = NV_ITEM_UNINIT;
    864          
    865              if ( ZG_SECURE_ENABLED )
    866              {
    867                nwkFrameCounterChanges = 0;
    868                osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
    869                osal_nv_item_init( ZCD_NV_NWKKEY, sizeof(nwkActiveKeyItems), (void *)&keyItems );
    870          
    871                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    872                {
    873                  ZDApp_RestoreNwkKey();
    874                }
    875              }
    876          
    877              // The default for RxOnWhenIdle is true for Routers and false for end devices
    878              // [setup in the NLME_RestoreFromNV()].  Change it here if you want something
    879              // other than default.
    880            }
    881          
    882            if ( nvStat == ZSUCCESS )
   \   000044   EE           MOV     A,R6
   \   000045   7004         JNZ     ??ZDApp_RestoreNetworkState_0
    883              return ( ZDO_INITDEV_RESTORED_NETWORK_STATE );
   \   000047   7900         MOV     R1,#0x0
   \   000049   8002         SJMP    ??ZDApp_RestoreNetworkState_2
    884            else
    885              return ( ZDO_INITDEV_NEW_NETWORK_STATE );
   \                     ??ZDApp_RestoreNetworkState_0:
   \   00004B   7901         MOV     R1,#0x1
   \                     ??ZDApp_RestoreNetworkState_2:
   \   00004D   02....       LJMP    ??Subroutine7_0 & 0xFFFF
    886          }
    887          
    888          /*********************************************************************
    889           * @fn      ZDApp_InitUserDesc()
    890           *
    891           * @brief   Initialize the User Descriptor, the descriptor is read from NV
    892           *          when needed.  If you want to initialize the User descriptor to
    893           *          something other than all zero, do it here.
    894           *
    895           * @param   none
    896           *
    897           * @return  none
    898           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    899          void ZDApp_InitUserDesc( void )
   \                     ZDApp_InitUserDesc:
    900          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    901            UserDescriptorFormat_t ZDO_DefaultUserDescriptor;
    902          
    903            // Initialize the User Descriptor, the descriptor is read from NV
    904            // when needed.  If you want to initialize the User descriptor to something
    905            // other than all zero, do it here.
    906            osal_memset( &ZDO_DefaultUserDescriptor, 0, sizeof( UserDescriptorFormat_t ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C11         MOV     R4,#0x11
   \   00000C   7D00         MOV     R5,#0x0
   \   00000E   7900         MOV     R1,#0x0
   \   000010   85..82       MOV     DPL,?XSP + 0
   \   000013   85..83       MOV     DPH,?XSP + 1
   \   000016   AA82         MOV     R2,DPL
   \   000018   AB83         MOV     R3,DPH
   \   00001A   12....       LCALL   ??osal_memset?relay
    907            if ( ZSUCCESS == osal_nv_item_init( ZCD_NV_USERDESC,
    908                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \   00001D                ; Setup parameters for call to function osal_nv_item_init
   \   00001D   85..82       MOV     DPL,?XSP + 0
   \   000020   85..83       MOV     DPH,?XSP + 1
   \   000023   8582..       MOV     ?V0 + 0,DPL
   \   000026   8583..       MOV     ?V0 + 1,DPH
   \   000029   78..         MOV     R0,#?V0 + 0
   \   00002B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002E   7C11         MOV     R4,#0x11
   \   000030   7D00         MOV     R5,#0x0
   \   000032   7A81         MOV     R2,#-0x7f
   \   000034   7B00         MOV     R3,#0x0
   \   000036   12....       LCALL   ??osal_nv_item_init?relay
   \   000039   7402         MOV     A,#0x2
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00003E   E9           MOV     A,R1
   \   00003F   7033         JNZ     ??ZDApp_InitUserDesc_0
    909            {
    910              if ( ZSUCCESS == osal_nv_read( ZCD_NV_USERDESC, 0,
    911                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \   000041                ; Setup parameters for call to function osal_nv_read
   \   000041   78..         MOV     R0,#?V0 + 0
   \   000043   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000046   75..11       MOV     ?V0 + 0,#0x11
   \   000049   75..00       MOV     ?V0 + 1,#0x0
   \   00004C   78..         MOV     R0,#?V0 + 0
   \   00004E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000051   7C00         MOV     R4,#0x0
   \   000053   7D00         MOV     R5,#0x0
   \   000055   7A81         MOV     R2,#-0x7f
   \   000057   7B00         MOV     R3,#0x0
   \   000059   12....       LCALL   ??osal_nv_read?relay
   \   00005C   7404         MOV     A,#0x4
   \   00005E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000061   E9           MOV     A,R1
   \   000062   7010         JNZ     ??ZDApp_InitUserDesc_0
    912              {
    913                if ( ZDO_DefaultUserDescriptor.len != 0 )
   \   000064   85..82       MOV     DPL,?XSP + 0
   \   000067   85..83       MOV     DPH,?XSP + 1
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   6007         JZ      ??ZDApp_InitUserDesc_0
    914                {
    915                  ZDO_Config_Node_Descriptor.UserDescAvail = TRUE;
   \   00006D   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000070   E0           MOVX    A,@DPTR
   \   000071   D2E4         SETB    0xE0 /* A   */.4
   \   000073   F0           MOVX    @DPTR,A
    916                }
    917              }
    918            }
    919          }
   \                     ??ZDApp_InitUserDesc_0:
   \   000074   7411         MOV     A,#0x11
   \   000076   80..         SJMP    ??Subroutine8_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine8_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   02....       LJMP    ??Subroutine10_0 & 0xFFFF
    920          
    921          /*********************************************************************
    922           * @fn      ZDAppCheckForHoldKey()
    923           *
    924           * @brief   Check for key to set the device into Hold Auto Start
    925           *
    926           * @param   none
    927           *
    928           * @return  none
    929           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    930          void ZDAppCheckForHoldKey( void )
   \                     ZDAppCheckForHoldKey:
    931          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    932          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    933            // Get Keypad directly to see if a HOLD_START is needed.
    934            // Hold down the SW_BYPASS_START key (see OnBoard.h)
    935            // while booting to avoid starting up the device.
    936            if ( HalKeyRead () == SW_BYPASS_START)
   \   000004                ; Setup parameters for call to function HalKeyRead
   \   000004   12....       LCALL   ??HalKeyRead?relay
   \   000007   E9           MOV     A,R1
   \   000008   6401         XRL     A,#0x1
   \   00000A   7005         JNZ     ??ZDAppCheckForHoldKey_0
    937            {
    938              // Change the device state to HOLD on start up
    939              devState = DEV_HOLD;
   \   00000C   90....       MOV     DPTR,#devState
   \   00000F   E4           CLR     A
   \   000010   F0           MOVX    @DPTR,A
    940            }
    941          #endif // HAL_KEY
    942          }
   \                     ??ZDAppCheckForHoldKey_0:
   \   000011   02....       LJMP    ?Subroutine3 & 0xFFFF
    943          
    944          /*********************************************************************
    945           * @fn      ZDApp_ProcessOSALMsg()
    946           *
    947           * @brief   Process the incoming task message.
    948           *
    949           * @param   msgPtr - message to process
    950           *
    951           * @return  none
    952           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    953          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessOSALMsg:
    954          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 22
   \   000005   74EA         MOV     A,#-0x16
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
    955            // Data Confirmation message fields
    956            uint8 sentEP;       // This should always be 0
    957            uint8 sentStatus;
    958            afDataConfirm_t *afDataConfirm;
    959            uint8 tmp;
    960          
    961            switch ( msgPtr->event )
   \   00000E   8A82         MOV     DPL,R2
   \   000010   8B83         MOV     DPH,R3
   \   000012   E0           MOVX    A,@DPTR
   \   000013   14           DEC     A
   \   000014   7003         JNZ     $+5
   \   000016   02....       LJMP    ??ZDApp_ProcessOSALMsg_0 & 0xFFFF
   \   000019   14           DEC     A
   \   00001A   7003         JNZ     $+5
   \   00001C   02....       LJMP    ??ZDApp_ProcessOSALMsg_1 & 0xFFFF
   \   00001F   14           DEC     A
   \   000020   7003         JNZ     $+5
   \   000022   02....       LJMP    ??ZDApp_ProcessOSALMsg_2 & 0xFFFF
   \   000025   24E9         ADD     A,#-0x17
   \   000027   600E         JZ      ??ZDApp_ProcessOSALMsg_3
   \   000029   2447         ADD     A,#0x47
   \   00002B   6010         JZ      ??ZDApp_ProcessOSALMsg_4
   \   00002D   24D6         ADD     A,#-0x2a
   \   00002F   7003         JNZ     $+5
   \   000031   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   \   000034   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
    962            {
    963              // Incoming ZDO Message
    964              case AF_INCOMING_MSG_CMD:
    965                ZDP_IncomingData( (afIncomingMSGPacket_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_3:
   \   000037                ; Setup parameters for call to function ZDP_IncomingData
   \   000037   12....       LCALL   ??ZDP_IncomingData?relay
    966                break;
   \   00003A   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
    967                
    968              case ZDO_CB_MSG:
    969                ZDApp_ProcessMsgCBs( (zdoIncomingMsg_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_4:
   \   00003D   EA           MOV     A,R2
   \   00003E   240C         ADD     A,#0xc
   \   000040   F582         MOV     DPL,A
   \   000042   EB           MOV     A,R3
   \   000043   3400         ADDC    A,#0x0
   \   000045   F583         MOV     DPH,A
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F5..         MOV     ?V0 + 2,A
   \   00004A   A3           INC     DPTR
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   F5..         MOV     ?V0 + 3,A
   \   00004E   78..         MOV     R0,#?V0 + 2
   \   000050   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for ZDApp_ProcessOSALMsg>_0`:
   \   000053   0200         DW        2
   \   000055   2100         DW        33
   \   000057   2200         DW        34
   \   000059   ....         DW        ??ZDApp_ProcessOSALMsg_7
   \   00005B   0080         DW        32768
   \   00005D   0180         DW        32769
   \   00005F   ....         DW        ??ZDApp_ProcessOSALMsg_8
   \   000061   0000         DW        0
   \   000063   ....         DW        ??ZDApp_ProcessOSALMsg_6
   \                     ??ZDApp_ProcessOSALMsg_7:
   \   000065                ; Setup parameters for call to function ZDO_ParseBindUnbindReq
   \   000065   7401         MOV     A,#0x1
   \   000067   12....       LCALL   ?XSTACK_DISP0_8
   \   00006A   AC82         MOV     R4,DPL
   \   00006C   AD83         MOV     R5,DPH
   \   00006E   12....       LCALL   ??ZDO_ParseBindUnbindReq?relay
   \   000071                ; Setup parameters for call to function ZDO_ProcessBindUnbindReq
   \   000071   7401         MOV     A,#0x1
   \   000073   12....       LCALL   ?XSTACK_DISP0_8
   \   000076   AC82         MOV     R4,DPL
   \   000078   AD83         MOV     R5,DPH
   \   00007A   AA..         MOV     R2,?V0 + 0
   \   00007C   AB..         MOV     R3,?V0 + 1
   \   00007E   12....       LCALL   ??ZDO_ProcessBindUnbindReq?relay
   \   000081   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
   \                     ??ZDApp_ProcessOSALMsg_8:
   \   000084                ; Setup parameters for call to function ZDO_ParseAddrRsp
   \   000084   12....       LCALL   ??ZDO_ParseAddrRsp?relay
   \   000087   8A..         MOV     ?V0 + 0,R2
   \   000089   8B..         MOV     ?V0 + 1,R3
   \   00008B   AE..         MOV     R6,?V0 + 0
   \   00008D   AF..         MOV     R7,?V0 + 1
   \   00008F   EE           MOV     A,R6
   \   000090   4F           ORL     A,R7
   \   000091   7003         JNZ     $+5
   \   000093   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
   \   000096   8E82         MOV     DPL,R6
   \   000098   8F83         MOV     DPH,R7
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   7011         JNZ     ??ZDApp_ProcessOSALMsg_9
   \   00009D                ; Setup parameters for call to function ZDO_UpdateAddrManager
   \   00009D   EE           MOV     A,R6
   \   00009E   2403         ADD     A,#0x3
   \   0000A0   FC           MOV     R4,A
   \   0000A1   EF           MOV     A,R7
   \   0000A2   3400         ADDC    A,#0x0
   \   0000A4   FD           MOV     R5,A
   \   0000A5   A3           INC     DPTR
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   FA           MOV     R2,A
   \   0000A8   A3           INC     DPTR
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   FB           MOV     R3,A
   \   0000AB   12....       LCALL   ??ZDO_UpdateAddrManager?relay
   \                     ??ZDApp_ProcessOSALMsg_9:
   \   0000AE                ; Setup parameters for call to function osal_mem_free
   \   0000AE   EE           MOV     A,R6
   \   0000AF   FA           MOV     R2,A
   \   0000B0   EF           MOV     A,R7
   \   0000B1   FB           MOV     R3,A
   \   0000B2   12....       LCALL   ??osal_mem_free?relay
   \   0000B5   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
    970                break;
    971          
    972              case AF_DATA_CONFIRM_CMD:
    973                // This message is received as a confirmation of a data packet sent.
    974                // The status is of ZStatus_t type [defined in NLMEDE.h]
    975                // The message fields are defined in AF.h
    976                afDataConfirm = (afDataConfirm_t *)msgPtr;
    977                sentEP = afDataConfirm->endpoint;
    978                sentStatus = afDataConfirm->hdr.status;
    979          
    980                // Action taken when confirmation is received.
    981          #if defined ( ZIGBEE_FREQ_AGILITY )
    982                if ( pZDNwkMgr_ProcessDataConfirm )
   \                     ??ZDApp_ProcessOSALMsg_5:
   \   0000B8   90....       MOV     DPTR,#pZDNwkMgr_ProcessDataConfirm
   \   0000BB   E0           MOVX    A,@DPTR
   \   0000BC   F8           MOV     R0,A
   \   0000BD   A3           INC     DPTR
   \   0000BE   E0           MOVX    A,@DPTR
   \   0000BF   F9           MOV     R1,A
   \   0000C0   E8           MOV     A,R0
   \   0000C1   49           ORL     A,R1
   \   0000C2   7003         JNZ     $+5
   \   0000C4   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
    983                  pZDNwkMgr_ProcessDataConfirm( afDataConfirm );
   \   0000C7                ; Setup parameters for indirect call
   \   0000C7   E0           MOVX    A,@DPTR
   \   0000C8   F583         MOV     DPH,A
   \   0000CA   8882         MOV     DPL,R0
   \   0000CC   12....       LCALL   ?CALL_IND
   \   0000CF   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
    984          #endif
    985                (void)sentEP;
    986                (void)sentStatus;
    987                break;
    988          
    989              case ZDO_NWK_DISC_CNF:
    990                if (devState != DEV_NWK_DISC)
   \                     ??ZDApp_ProcessOSALMsg_0:
   \   0000D2   90....       MOV     DPTR,#devState
   \   0000D5   E0           MOVX    A,@DPTR
   \   0000D6   6402         XRL     A,#0x2
   \   0000D8   6003         JZ      $+5
   \   0000DA   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
    991                  break;
    992                
    993                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \   0000DD   90....       MOV     DPTR,#zgDeviceLogicalType
   \   0000E0   E0           MOVX    A,@DPTR
   \   0000E1   6401         XRL     A,#0x1
   \   0000E3   6008         JZ      ??ZDApp_ProcessOSALMsg_10
   \   0000E5   E0           MOVX    A,@DPTR
   \   0000E6   6402         XRL     A,#0x2
   \   0000E8   6003         JZ      $+5
   \   0000EA   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
    994                {
    995                  if ( (((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->hdr.status == ZDO_SUCCESS) && (zdoDiscCounter > NUM_DISC_ATTEMPTS) )
   \                     ??ZDApp_ProcessOSALMsg_10:
   \   0000ED   8A82         MOV     DPL,R2
   \   0000EF   8B83         MOV     DPH,R3
   \   0000F1   A3           INC     DPTR
   \   0000F2   E0           MOVX    A,@DPTR
   \   0000F3   6003         JZ      $+5
   \   0000F5   02....       LJMP    ??ZDApp_ProcessOSALMsg_11 & 0xFFFF
   \   0000F8   90....       MOV     DPTR,#zdoDiscCounter
   \   0000FB   E0           MOVX    A,@DPTR
   \   0000FC   C3           CLR     C
   \   0000FD   9403         SUBB    A,#0x3
   \   0000FF   5003         JNC     $+5
   \   000101   02....       LJMP    ??ZDApp_ProcessOSALMsg_11 & 0xFFFF
    996                  {
    997                    if ( devStartMode == MODE_JOIN )
   \   000104   90....       MOV     DPTR,#devStartMode
   \   000107   E0           MOVX    A,@DPTR
   \   000108   6003         JZ      $+5
   \   00010A   02....       LJMP    ??ZDApp_ProcessOSALMsg_12 & 0xFFFF
    998                    {
    999                      devState = DEV_NWK_JOINING;
   \   00010D   90....       MOV     DPTR,#devState
   \   000110   7403         MOV     A,#0x3
   \   000112   F0           MOVX    @DPTR,A
   1000            
   1001                      ZDApp_NodeProfileSync((ZDO_NetworkDiscoveryCfm_t *)msgPtr);
   \   000113   EA           MOV     A,R2
   \   000114   2406         ADD     A,#0x6
   \   000116   F5..         MOV     ?V0 + 2,A
   \   000118   EB           MOV     A,R3
   \   000119   3400         ADDC    A,#0x0
   \   00011B   F5..         MOV     ?V0 + 3,A
   \   00011D   EA           MOV     A,R2
   \   00011E   2403         ADD     A,#0x3
   \   000120   F5..         MOV     ?V0 + 4,A
   \   000122   EB           MOV     A,R3
   \   000123   3400         ADDC    A,#0x0
   \   000125   F5..         MOV     ?V0 + 5,A
   \   000127   EA           MOV     A,R2
   \   000128   2402         ADD     A,#0x2
   \   00012A   FE           MOV     R6,A
   \   00012B   EB           MOV     A,R3
   \   00012C   3400         ADDC    A,#0x0
   \   00012E   FF           MOV     R7,A
   \   00012F   EA           MOV     A,R2
   \   000130   2404         ADD     A,#0x4
   \   000132   F5..         MOV     ?V0 + 0,A
   \   000134   EB           MOV     A,R3
   \   000135   3400         ADDC    A,#0x0
   \   000137   F5..         MOV     ?V0 + 1,A
   \   000139   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00013C   E0           MOVX    A,@DPTR
   \   00013D   A2E1         MOV     C,0xE0 /* A   */.1
   \   00013F   5051         JNC     ??ZDApp_ProcessOSALMsg_13
   \   000141                ; Setup parameters for call to function nwk_getNetworkDesc
   \   000141   85..82       MOV     DPL,?V0 + 0
   \   000144   85..83       MOV     DPH,?V0 + 1
   \   000147   E0           MOVX    A,@DPTR
   \   000148   F9           MOV     R1,A
   \   000149   8E82         MOV     DPL,R6
   \   00014B   8F83         MOV     DPH,R7
   \   00014D   E0           MOVX    A,@DPTR
   \   00014E   FC           MOV     R4,A
   \   00014F   85..82       MOV     DPL,?V0 + 4
   \   000152   85..83       MOV     DPH,?V0 + 5
   \   000155   E0           MOVX    A,@DPTR
   \   000156   FB           MOV     R3,A
   \   000157   EC           MOV     A,R4
   \   000158   2400         ADD     A,#0x0
   \   00015A   E4           CLR     A
   \   00015B   3B           ADDC    A,R3
   \   00015C   FD           MOV     R5,A
   \   00015D   AA..         MOV     R2,?V0 + 2
   \   00015F   AB..         MOV     R3,?V0 + 3
   \   000161   12....       LCALL   ??nwk_getNetworkDesc?relay
   \   000164   8A82         MOV     DPL,R2
   \   000166   8B83         MOV     DPH,R3
   \   000168   E582         MOV     A,DPL
   \   00016A   4583         ORL     A,DPH
   \   00016C   6024         JZ      ??ZDApp_ProcessOSALMsg_13
   \   00016E   A3           INC     DPTR
   \   00016F   A3           INC     DPTR
   \   000170   A3           INC     DPTR
   \   000171   A3           INC     DPTR
   \   000172   A3           INC     DPTR
   \   000173   A3           INC     DPTR
   \   000174   A3           INC     DPTR
   \   000175   A3           INC     DPTR
   \   000176   E0           MOVX    A,@DPTR
   \   000177   F8           MOV     R0,A
   \   000178   90....       MOV     DPTR,#zgStackProfile
   \   00017B   E0           MOVX    A,@DPTR
   \   00017C   68           XRL     A,R0
   \   00017D   6013         JZ      ??ZDApp_ProcessOSALMsg_13
   \   00017F   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000182   E0           MOVX    A,@DPTR
   \   000183   54F8         ANL     A,#0xf8
   \   000185   4402         ORL     A,#0x2
   \   000187   F0           MOVX    @DPTR,A
   \   000188   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00018B   740C         MOV     A,#0xc
   \   00018D   F0           MOVX    @DPTR,A
   \   00018E                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   00018E   F9           MOV     R1,A
   \   00018F   12....       LCALL   ??NLME_SetBroadcastFilter?relay
   1002            
   1003                      if ( NLME_JoinRequest( ((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->extendedPANID,
   1004                           BUILD_UINT16( ((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->panIdLSB, ((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->panIdMSB ),
   1005                           ((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->logicalChannel,
   1006                           ZDO_Config_Node_Descriptor.CapabilityFlags ) != ZSuccess )
   \                     ??ZDApp_ProcessOSALMsg_13:
   \   000192                ; Setup parameters for call to function NLME_JoinRequest
   \   000192   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000195   E0           MOVX    A,@DPTR
   \   000196   F5..         MOV     ?V0 + 6,A
   \   000198   78..         MOV     R0,#?V0 + 6
   \   00019A   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00019D   85..82       MOV     DPL,?V0 + 0
   \   0001A0   85..83       MOV     DPH,?V0 + 1
   \   0001A3   E0           MOVX    A,@DPTR
   \   0001A4   F9           MOV     R1,A
   \   0001A5   8E82         MOV     DPL,R6
   \   0001A7   8F83         MOV     DPH,R7
   \   0001A9   E0           MOVX    A,@DPTR
   \   0001AA   FC           MOV     R4,A
   \   0001AB   85..82       MOV     DPL,?V0 + 4
   \   0001AE   85..83       MOV     DPH,?V0 + 5
   \   0001B1   E0           MOVX    A,@DPTR
   \   0001B2   FB           MOV     R3,A
   \   0001B3   EC           MOV     A,R4
   \   0001B4   2400         ADD     A,#0x0
   \   0001B6   E4           CLR     A
   \   0001B7   3B           ADDC    A,R3
   \   0001B8   FD           MOV     R5,A
   \   0001B9   AA..         MOV     R2,?V0 + 2
   \   0001BB   AB..         MOV     R3,?V0 + 3
   \   0001BD   12....       LCALL   ??NLME_JoinRequest?relay
   \   0001C0   7401         MOV     A,#0x1
   \   0001C2   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDApp_ProcessOSALMsg_14:
   \   0001C5   E9           MOV     A,R1
   \   0001C6   7003         JNZ     $+5
   \   0001C8   02....       LJMP    ??ZDApp_ProcessOSALMsg_15 & 0xFFFF
   1007                      {
   1008                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1009                            + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   0001CB                ; Setup parameters for call to function osal_rand
   \   0001CB   12....       LCALL   ??osal_rand?relay
   \   0001CE   EA           MOV     A,R2
   \   0001CF   547F         ANL     A,#0x7f
   \   0001D1   2464         ADD     A,#0x64
   \   0001D3   FC           MOV     R4,A
   \   0001D4   7D00         MOV     R5,#0x0
   \   0001D6   7A01         MOV     R2,#0x1
   \   0001D8   7B00         MOV     R3,#0x0
   \   0001DA   90....       MOV     DPTR,#ZDAppTaskID
   \   0001DD   7003         JNZ     $+5
   \   0001DF   02....       LJMP    ??ZDApp_ProcessOSALMsg_16 & 0xFFFF
   \   0001E2                ; Setup parameters for call to function osal_start_timerEx
   \   0001E2   E0           MOVX    A,@DPTR
   \   0001E3   F9           MOV     R1,A
   \   0001E4   12....       LCALL   ??osal_start_timerEx?relay
   \   0001E7   02....       LJMP    ??ZDApp_ProcessOSALMsg_15 & 0xFFFF
   1010                      }
   1011                    }
   1012                    else if ( devStartMode == MODE_REJOIN )
   \                     ??ZDApp_ProcessOSALMsg_12:
   \   0001EA   6403         XRL     A,#0x3
   \   0001EC   6003         JZ      $+5
   \   0001EE   02....       LJMP    ??ZDApp_ProcessOSALMsg_15 & 0xFFFF
   1013                    {
   1014                      devState = DEV_NWK_REJOIN;
   \   0001F1   90....       MOV     DPTR,#devState
   \   0001F4   7404         MOV     A,#0x4
   \   0001F6   F0           MOVX    @DPTR,A
   1015          
   1016                      // Before trying to do rejoin, check if the device has a valid short address
   1017                      // If not, generate a random short address for itself
   1018                      if ( _NIB.nwkDevAddress == INVALID_NODE_ADDR )
   \   0001F7   90....       MOV     DPTR,#_NIB + 20
   \   0001FA   E0           MOVX    A,@DPTR
   \   0001FB   64FE         XRL     A,#0xfe
   \   0001FD   7003         JNZ     ??ZDApp_ProcessOSALMsg_17
   \   0001FF   A3           INC     DPTR
   \   000200   E0           MOVX    A,@DPTR
   \   000201   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_17:
   \   000202   7014         JNZ     ??ZDApp_ProcessOSALMsg_18
   1019                      {
   1020                        _NIB.nwkDevAddress = osal_rand();
   \   000204                ; Setup parameters for call to function osal_rand
   \   000204   12....       LCALL   ??osal_rand?relay
   \   000207   90....       MOV     DPTR,#_NIB + 20
   \   00020A   EA           MOV     A,R2
   \   00020B   F0           MOVX    @DPTR,A
   \   00020C   A3           INC     DPTR
   \   00020D   EB           MOV     A,R3
   \   00020E   F0           MOVX    @DPTR,A
   1021                        ZMacSetReq( ZMacShortAddress, (byte*)&_NIB.nwkDevAddress );
   \   00020F                ; Setup parameters for call to function ZMacSetReq
   \   00020F   7A..         MOV     R2,#(_NIB + 20) & 0xff
   \   000211   7B..         MOV     R3,#((_NIB + 20) >> 8) & 0xff
   \   000213   7953         MOV     R1,#0x53
   \   000215   12....       LCALL   ??ZMacSetReq?relay
   1022                      }
   1023          
   1024                      if ( ZG_SECURE_ENABLED )
   1025                      {
   1026                        ZDApp_RestoreNwkKey();
   1027                      }
   1028                      
   1029                      // Check if the device has a valid PanID, if not, set it to the discovered Pan
   1030                      if ( _NIB.nwkPanId == INVALID_PAN_ID )
   \                     ??ZDApp_ProcessOSALMsg_18:
   \   000218   90....       MOV     DPTR,#_NIB + 33
   \   00021B   E0           MOVX    A,@DPTR
   \   00021C   64FE         XRL     A,#0xfe
   \   00021E   7003         JNZ     ??ZDApp_ProcessOSALMsg_19
   \   000220   A3           INC     DPTR
   \   000221   E0           MOVX    A,@DPTR
   \   000222   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_19:
   \   000223   7026         JNZ     ??ZDApp_ProcessOSALMsg_20
   1031                      {
   1032                        _NIB.nwkPanId = BUILD_UINT16( ((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->panIdLSB, ((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->panIdMSB );
   \   000225   85..82       MOV     DPL,?V0 + 0
   \   000228   85..83       MOV     DPH,?V0 + 1
   \   00022B   A3           INC     DPTR
   \   00022C   A3           INC     DPTR
   \   00022D   E0           MOVX    A,@DPTR
   \   00022E   FA           MOV     R2,A
   \   00022F   85..82       MOV     DPL,?V0 + 0
   \   000232   85..83       MOV     DPH,?V0 + 1
   \   000235   A3           INC     DPTR
   \   000236   A3           INC     DPTR
   \   000237   A3           INC     DPTR
   \   000238   E0           MOVX    A,@DPTR
   \   000239   F9           MOV     R1,A
   \   00023A   EA           MOV     A,R2
   \   00023B   90....       MOV     DPTR,#_NIB + 33
   \   00023E   F0           MOVX    @DPTR,A
   \   00023F   A3           INC     DPTR
   \   000240   E9           MOV     A,R1
   \   000241   F0           MOVX    @DPTR,A
   1033                        ZMacSetReq( ZMacPanId, (byte*)&(_NIB.nwkPanId) );
   \   000242                ; Setup parameters for call to function ZMacSetReq
   \   000242   7A..         MOV     R2,#(_NIB + 33) & 0xff
   \   000244   7B..         MOV     R3,#((_NIB + 33) >> 8) & 0xff
   \   000246   7950         MOV     R1,#0x50
   \   000248   12....       LCALL   ??ZMacSetReq?relay
   1034                      }
   1035          
   1036                      tmp = true;
   \                     ??ZDApp_ProcessOSALMsg_20:
   \   00024B   85..82       MOV     DPL,?XSP + 0
   \   00024E   85..83       MOV     DPH,?XSP + 1
   \   000251   7401         MOV     A,#0x1
   \   000253   F0           MOVX    @DPTR,A
   1037                      ZMacSetReq( ZMacRxOnIdle, &tmp ); // Set receiver always on during rejoin 
   \   000254                ; Setup parameters for call to function ZMacSetReq
   \   000254   AA82         MOV     R2,DPL
   \   000256   AB83         MOV     R3,DPH
   \   000258   7952         MOV     R1,#0x52
   \   00025A   12....       LCALL   ??ZMacSetReq?relay
   1038                      if ( NLME_ReJoinRequest( ZDO_UseExtendedPANID, ((ZDO_NetworkDiscoveryCfm_t *)msgPtr)->logicalChannel) != ZSuccess )
   \   00025D                ; Setup parameters for call to function NLME_ReJoinRequest
   \   00025D   85..82       MOV     DPL,?V0 + 0
   \   000260   85..83       MOV     DPH,?V0 + 1
   \   000263   A3           INC     DPTR
   \   000264   A3           INC     DPTR
   \   000265   A3           INC     DPTR
   \   000266   A3           INC     DPTR
   \   000267   E0           MOVX    A,@DPTR
   \   000268   F9           MOV     R1,A
   \   000269   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   00026B   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   00026D   12....       LCALL   ??NLME_ReJoinRequest?relay
   \   000270   02....       LJMP    ??ZDApp_ProcessOSALMsg_14 & 0xFFFF
   \                     ??ZDApp_ProcessOSALMsg_16:
   \   000273                ; Setup parameters for call to function osal_set_event
   1039                      {
   1040                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1041                            + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   1042                      }
   1043                    }
   \   000273   E0           MOVX    A,@DPTR
   \   000274   F9           MOV     R1,A
   \   000275   12....       LCALL   ??osal_set_event?relay
   1044            
   1045                    if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??ZDApp_ProcessOSALMsg_15:
   \   000278   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00027B   E0           MOVX    A,@DPTR
   \   00027C   A2E3         MOV     C,0xE0 /* A   */.3
   \   00027E   4003         JC      $+5
   \   000280   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
   1046                    {
   1047                      // The receiver is on, turn network layer polling off.
   1048                      NLME_SetPollRate( 0 );
   \   000283                ; Setup parameters for call to function NLME_SetPollRate
   \   000283   7A00         MOV     R2,#0x0
   \   000285   7B00         MOV     R3,#0x0
   \   000287   12....       LCALL   ??NLME_SetPollRate?relay
   1049                      NLME_SetQueuedPollRate( 0 );
   \   00028A                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   00028A   7A00         MOV     R2,#0x0
   \   00028C   7B00         MOV     R3,#0x0
   \   00028E   12....       LCALL   ??NLME_SetQueuedPollRate?relay
   1050                      NLME_SetResponseRate( 0 );
   \   000291                ; Setup parameters for call to function NLME_SetResponseRate
   \   000291   7A00         MOV     R2,#0x0
   \   000293   7B00         MOV     R3,#0x0
   \   000295   12....       LCALL   ??NLME_SetResponseRate?relay
   \   000298   8073         SJMP    ??ZDApp_ProcessOSALMsg_6
   1051                    }
   1052                    else
   1053                    {
   1054                      if ( (ZG_SECURE_ENABLED) && (devStartMode == MODE_JOIN) )
   1055                      {
   1056                        ZDApp_SavedPollRate = zgPollRate;
   1057                        NLME_SetPollRate( zgRejoinPollRate );
   1058                      }
   1059                    }
   1060                  }
   1061                  else
   1062                  {
   1063                    if ( continueJoining )
   \                     ??ZDApp_ProcessOSALMsg_11:
   \   00029A   90....       MOV     DPTR,#continueJoining
   \   00029D   E0           MOVX    A,@DPTR
   \   00029E   606D         JZ      ??ZDApp_ProcessOSALMsg_6
   1064                    {
   1065              #if defined ( MANAGED_SCAN )
   1066                      ZDApp_NetworkInit( MANAGEDSCAN_DELAY_BETWEEN_SCANS );
   1067              #else
   1068                      zdoDiscCounter++;
   \   0002A0   90....       MOV     DPTR,#zdoDiscCounter
   \   0002A3   E0           MOVX    A,@DPTR
   \   0002A4   04           INC     A
   \   0002A5   F0           MOVX    @DPTR,A
   1069                      ZDApp_NetworkInit( (uint16)(BEACON_REQUEST_DELAY
   1070                            + ((uint16)(osal_rand()& BEACON_REQ_DELAY_MASK))) );
   \   0002A6                ; Setup parameters for call to function osal_rand
   \   0002A6   12....       LCALL   ??osal_rand?relay
   \   0002A9   EA           MOV     A,R2
   \   0002AA   2464         ADD     A,#0x64
   \   0002AC   FC           MOV     R4,A
   \   0002AD   E4           CLR     A
   \   0002AE   3400         ADDC    A,#0x0
   \   0002B0   FD           MOV     R5,A
   \   0002B1   EC           MOV     A,R4
   \   0002B2   4D           ORL     A,R5
   \   0002B3   604C         JZ      ??ZDApp_ProcessOSALMsg_21
   \   0002B5                ; Setup parameters for call to function osal_start_timerEx
   \   0002B5   7A01         MOV     R2,#0x1
   \   0002B7   7B00         MOV     R3,#0x0
   \   0002B9   90....       MOV     DPTR,#ZDAppTaskID
   \   0002BC   E0           MOVX    A,@DPTR
   \   0002BD   F9           MOV     R1,A
   \   0002BE   12....       LCALL   ??osal_start_timerEx?relay
   \   0002C1   804A         SJMP    ??ZDApp_ProcessOSALMsg_6
   1071              #endif
   1072                    }
   1073                  }
   1074                }
   1075                break;
   1076          
   1077              case ZDO_NWK_JOIN_IND:
   1078                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_1:
   \   0002C3   90....       MOV     DPTR,#zgDeviceLogicalType
   \   0002C6   E0           MOVX    A,@DPTR
   \   0002C7   6401         XRL     A,#0x1
   \   0002C9   6005         JZ      ??ZDApp_ProcessOSALMsg_22
   \   0002CB   E0           MOVX    A,@DPTR
   \   0002CC   6402         XRL     A,#0x2
   \   0002CE   703D         JNZ     ??ZDApp_ProcessOSALMsg_6
   1079                {
   1080                  ZDApp_ProcessNetworkJoin();
   \                     ??ZDApp_ProcessOSALMsg_22:
   \   0002D0                ; Setup parameters for call to function ZDApp_ProcessNetworkJoin
   \   0002D0   12....       LCALL   ??ZDApp_ProcessNetworkJoin?relay
   \   0002D3   8038         SJMP    ??ZDApp_ProcessOSALMsg_6
   1081                }
   1082                break;
   1083          
   1084              case ZDO_NWK_JOIN_REQ:
   1085                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_2:
   \   0002D5   90....       MOV     DPTR,#zgDeviceLogicalType
   \   0002D8   E0           MOVX    A,@DPTR
   \   0002D9   6401         XRL     A,#0x1
   \   0002DB   6005         JZ      ??ZDApp_ProcessOSALMsg_23
   \   0002DD   E0           MOVX    A,@DPTR
   \   0002DE   6402         XRL     A,#0x2
   \   0002E0   702B         JNZ     ??ZDApp_ProcessOSALMsg_6
   1086                {
   1087                  retryCnt = 0;
   \                     ??ZDApp_ProcessOSALMsg_23:
   \   0002E2   90....       MOV     DPTR,#retryCnt
   \   0002E5   E4           CLR     A
   \   0002E6   F0           MOVX    @DPTR,A
   1088                  devStartMode = MODE_RESUME;
   \   0002E7   90....       MOV     DPTR,#devStartMode
   \   0002EA   04           INC     A
   \   0002EB   F0           MOVX    @DPTR,A
   1089                  _tmpRejoinState = true;
   \   0002EC   90....       MOV     DPTR,#_tmpRejoinState
   \   0002EF   F0           MOVX    @DPTR,A
   1090                  osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
   \   0002F0                ; Setup parameters for call to function sAddrExtCpy
   \   0002F0   7C..         MOV     R4,#(_NIB + 53) & 0xff
   \   0002F2   7D..         MOV     R5,#((_NIB + 53) >> 8) & 0xff
   \   0002F4   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   0002F6   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   0002F8   12....       LCALL   ??sAddrExtCpy?relay
   1091                  zgDefaultStartingScanDuration = BEACON_ORDER_60_MSEC;
   \   0002FB   90....       MOV     DPTR,#zgDefaultStartingScanDuration
   \   0002FE   7402         MOV     A,#0x2
   \   000300   F0           MOVX    @DPTR,A
   1092                  ZDApp_NetworkInit( 0 );
   \   000301                ; Setup parameters for call to function osal_set_event
   \                     ??ZDApp_ProcessOSALMsg_21:
   \   000301   7A01         MOV     R2,#0x1
   \   000303   7B00         MOV     R3,#0x0
   \   000305   90....       MOV     DPTR,#ZDAppTaskID
   \   000308   E0           MOVX    A,@DPTR
   \   000309   F9           MOV     R1,A
   \   00030A   12....       LCALL   ??osal_set_event?relay
   1093                }
   1094                break;
   1095          
   1096              default:
   1097                if ( ZG_SECURE_ENABLED )
   1098                  ZDApp_ProcessSecMsg( msgPtr );
   1099                break;
   1100            }
   1101          
   1102          }
   \                     ??ZDApp_ProcessOSALMsg_6:
   \   00030D   7416         MOV     A,#0x16
   \   00030F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000312   7F08         MOV     R7,#0x8
   \   000314   02....       LJMP    ?BANKED_LEAVE_XDATA
   1103          
   1104          /*********************************************************************
   1105           * @fn      ZDApp_ProcessMsgCBs()
   1106           *
   1107           * @brief   Process response messages
   1108           *
   1109           * @param   none
   1110           *
   1111           * @return  none
   1112           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   7415         MOV     A,#0x15
   \   000002                REQUIRE ??Subroutine8_0
   \   000002                ; // Fall through to label ??Subroutine8_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1113          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_ProcessMsgCBs:
   1114          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1115            switch ( inMsg->clusterID )
   \   00000E   EE           MOV     A,R6
   \   00000F   240C         ADD     A,#0xc
   \   000011   F582         MOV     DPL,A
   \   000013   EF           MOV     A,R7
   \   000014   3400         ADDC    A,#0x0
   \   000016   F583         MOV     DPH,A
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 0,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F5..         MOV     ?V0 + 1,A
   \   00001F   78..         MOV     R0,#?V0 + 0
   \   000021   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for ZDApp_ProcessMsgCBs>_0`:
   \   000024   0200         DW        2
   \   000026   2100         DW        33
   \   000028   2200         DW        34
   \   00002A   ....         DW        ??ZDApp_ProcessMsgCBs_0
   \   00002C   0080         DW        32768
   \   00002E   0180         DW        32769
   \   000030   ....         DW        ??ZDApp_ProcessMsgCBs_1
   \   000032   0000         DW        0
   \   000034   ....         DW        ??ZDApp_ProcessMsgCBs_2
   1116            {
   1117          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1118              case NWK_addr_rsp:
   1119              case IEEE_addr_rsp:
   1120                {
   1121                  ZDO_NwkIEEEAddrResp_t *pAddrRsp;
   1122                  pAddrRsp = ZDO_ParseAddrRsp( inMsg );
   \                     ??ZDApp_ProcessMsgCBs_1:
   \   000036                ; Setup parameters for call to function ZDO_ParseAddrRsp
   \   000036   12....       LCALL   ??ZDO_ParseAddrRsp?relay
   \   000039   8A..         MOV     ?V0 + 0,R2
   \   00003B   8B..         MOV     ?V0 + 1,R3
   \   00003D   AE..         MOV     R6,?V0 + 0
   \   00003F   AF..         MOV     R7,?V0 + 1
   1123                  if ( pAddrRsp )
   \   000041   EE           MOV     A,R6
   \   000042   4F           ORL     A,R7
   \   000043   603F         JZ      ??ZDApp_ProcessMsgCBs_2
   1124                  {
   1125                    if ( pAddrRsp->status == ZSuccess )
   \   000045   8E82         MOV     DPL,R6
   \   000047   8F83         MOV     DPH,R7
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   7011         JNZ     ??ZDApp_ProcessMsgCBs_3
   1126                    {
   1127                      ZDO_UpdateAddrManager( pAddrRsp->nwkAddr, pAddrRsp->extAddr );
   \   00004C                ; Setup parameters for call to function ZDO_UpdateAddrManager
   \   00004C   EE           MOV     A,R6
   \   00004D   2403         ADD     A,#0x3
   \   00004F   FC           MOV     R4,A
   \   000050   EF           MOV     A,R7
   \   000051   3400         ADDC    A,#0x0
   \   000053   FD           MOV     R5,A
   \   000054   A3           INC     DPTR
   \   000055   E0           MOVX    A,@DPTR
   \   000056   FA           MOV     R2,A
   \   000057   A3           INC     DPTR
   \   000058   E0           MOVX    A,@DPTR
   \   000059   FB           MOV     R3,A
   \   00005A   12....       LCALL   ??ZDO_UpdateAddrManager?relay
   1128                    }
   1129                    osal_mem_free( pAddrRsp );
   \                     ??ZDApp_ProcessMsgCBs_3:
   \   00005D                ; Setup parameters for call to function osal_mem_free
   \   00005D   EE           MOV     A,R6
   \   00005E   FA           MOV     R2,A
   \   00005F   EF           MOV     A,R7
   \   000060   FB           MOV     R3,A
   \   000061   12....       LCALL   ??osal_mem_free?relay
   \   000064   801E         SJMP    ??ZDApp_ProcessMsgCBs_2
   1130                  }
   1131                }
   1132                break;
   1133          #endif
   1134                
   1135          #if defined ( REFLECTOR )
   1136              case Bind_req:
   1137              case Unbind_req:
   1138                {
   1139                  ZDO_BindUnbindReq_t bindReq;
   1140                  ZDO_ParseBindUnbindReq( inMsg, &bindReq );
   \                     ??ZDApp_ProcessMsgCBs_0:
   \   000066                ; Setup parameters for call to function ZDO_ParseBindUnbindReq
   \   000066   85..82       MOV     DPL,?XSP + 0
   \   000069   85..83       MOV     DPH,?XSP + 1
   \   00006C   AC82         MOV     R4,DPL
   \   00006E   AD83         MOV     R5,DPH
   \   000070   12....       LCALL   ??ZDO_ParseBindUnbindReq?relay
   1141                  ZDO_ProcessBindUnbindReq( inMsg, &bindReq );
   \   000073                ; Setup parameters for call to function ZDO_ProcessBindUnbindReq
   \   000073   85..82       MOV     DPL,?XSP + 0
   \   000076   85..83       MOV     DPH,?XSP + 1
   \   000079   AC82         MOV     R4,DPL
   \   00007B   AD83         MOV     R5,DPH
   \   00007D   EE           MOV     A,R6
   \   00007E   FA           MOV     R2,A
   \   00007F   EF           MOV     A,R7
   \   000080   FB           MOV     R3,A
   \   000081   12....       LCALL   ??ZDO_ProcessBindUnbindReq?relay
   1142                }
   1143                break;
   1144          #endif      
   1145          
   1146          #if ( ZG_BUILD_COORDINATOR_TYPE )
   1147              case Bind_rsp:
   1148              case Unbind_rsp:
   1149                if (ZG_DEVICE_COORDINATOR_TYPE && matchED)
   1150                {
   1151                  ZDMatchSendState(
   1152                       (uint8)((inMsg->clusterID == Bind_rsp) ? ZDMATCH_REASON_BIND_RSP : ZDMATCH_REASON_UNBIND_RSP),
   1153                       ZDO_ParseBindRsp(inMsg), inMsg->TransSeq );
   1154                }
   1155                break;
   1156                
   1157              case End_Device_Bind_req:
   1158                if (ZG_DEVICE_COORDINATOR_TYPE)
   1159                {
   1160                  ZDEndDeviceBind_t bindReq;
   1161                  ZDO_ParseEndDeviceBindReq( inMsg, &bindReq );
   1162                  ZDO_MatchEndDeviceBind( &bindReq );
   1163                  
   1164                  // Freeing the cluster lists - if allocated.
   1165                  if ( bindReq.numInClusters )
   1166                    osal_mem_free( bindReq.inClusters );
   1167                  if ( bindReq.numOutClusters )
   1168                    osal_mem_free( bindReq.outClusters );
   1169                }
   1170                break;
   1171          #endif
   1172            }
   1173          }
   \                     ??ZDApp_ProcessMsgCBs_2:
   \   000084   02....       LJMP    ?Subroutine6 & 0xFFFF
   1174          
   1175          /*********************************************************************
   1176           * @fn      ZDApp_RegisterCBs()
   1177           *
   1178           * @brief   Process response messages
   1179           *
   1180           * @param   none
   1181           *
   1182           * @return  none
   1183           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1184          void ZDApp_RegisterCBs( void )
   \                     ZDApp_RegisterCBs:
   1185          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1186          #if defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1187            ZDO_RegisterForZDOMsg( ZDAppTaskID, IEEE_addr_rsp );
   \   000004                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000004   7A01         MOV     R2,#0x1
   \   000006   7B80         MOV     R3,#-0x80
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   1188          #endif
   1189          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( REFLECTOR )
   1190            ZDO_RegisterForZDOMsg( ZDAppTaskID, NWK_addr_rsp );
   \   000010                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000010   7A00         MOV     R2,#0x0
   \   000012   7B80         MOV     R3,#-0x80
   \   000014   90....       MOV     DPTR,#ZDAppTaskID
   \   000017   E0           MOVX    A,@DPTR
   \   000018   F9           MOV     R1,A
   \   000019   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   1191          #endif  
   1192          #if ZG_BUILD_COORDINATOR_TYPE
   1193            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_rsp );
   1194            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_rsp );
   1195            ZDO_RegisterForZDOMsg( ZDAppTaskID, End_Device_Bind_req );
   1196          #endif
   1197          #if defined ( REFLECTOR )
   1198            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_req );
   \   00001C                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00001C   7A21         MOV     R2,#0x21
   \   00001E   7B00         MOV     R3,#0x0
   \   000020   90....       MOV     DPTR,#ZDAppTaskID
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F9           MOV     R1,A
   \   000025   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   1199            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_req );
   \   000028                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000028   7A22         MOV     R2,#0x22
   \   00002A   7B00         MOV     R3,#0x0
   \   00002C   90....       MOV     DPTR,#ZDAppTaskID
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F9           MOV     R1,A
   \   000031   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   1200          #endif  
   1201          }
   \   000034   02....       LJMP    ?Subroutine3 & 0xFFFF
   1202          
   1203          /*********************************************************************
   1204           * @fn      ZDApp_ProcessSecMsg()
   1205           *
   1206           * @brief   Process the incoming security message.
   1207           *
   1208           * @param   msgPtr - message to process
   1209           *
   1210           * @return  none
   1211           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1212          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessSecMsg:
   1213          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1214            switch ( msgPtr->event )
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   E0           MOVX    A,@DPTR
   \   000009   24FA         ADD     A,#-0x6
   \   00000B   600A         JZ      ??ZDApp_ProcessSecMsg_0
   \   00000D   24FE         ADD     A,#-0x2
   \   00000F   6018         JZ      ??ZDApp_ProcessSecMsg_1
   \   000011   24FE         ADD     A,#-0x2
   \   000013   6021         JZ      ??ZDApp_ProcessSecMsg_2
   \   000015   802F         SJMP    ??ZDApp_ProcessSecMsg_3
   1215            {
   1216              case ZDO_ESTABLISH_KEY_CFM:
   1217                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1218                {
   1219                  ZDSecMgrEstablishKeyCfm( (ZDO_EstablishKeyCfm_t*)msgPtr );
   1220                }
   1221                break;
   1222          
   1223              case ZDO_ESTABLISH_KEY_IND:
   1224                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1225                {
   1226                  if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1227                  {
   1228                    ZDSecMgrEstablishKeyInd( (ZDO_EstablishKeyInd_t*)msgPtr );
   1229                  }
   1230                }
   1231                break;
   1232          
   1233              case ZDO_TRANSPORT_KEY_IND:
   1234                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_0:
   \   000017   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   6401         XRL     A,#0x1
   \   00001D   6005         JZ      ??ZDApp_ProcessSecMsg_4
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   6402         XRL     A,#0x2
   \   000022   7022         JNZ     ??ZDApp_ProcessSecMsg_3
   1235                {
   1236                  ZDSecMgrTransportKeyInd( (ZDO_TransportKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_4:
   \   000024                ; Setup parameters for call to function ZDSecMgrTransportKeyInd
   \   000024   12....       LCALL   ??ZDSecMgrTransportKeyInd?relay
   \   000027   801D         SJMP    ??ZDApp_ProcessSecMsg_3
   1237                }
   1238                break;
   1239          
   1240              case ZDO_UPDATE_DEVICE_IND:
   1241                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1242                {
   1243                  ZDSecMgrUpdateDeviceInd( (ZDO_UpdateDeviceInd_t*)msgPtr );
   1244                }
   1245                break;
   1246          
   1247              case ZDO_REMOVE_DEVICE_IND:
   1248                if ( ZG_BUILD_RTRONLY_TYPE && ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER ) )
   \                     ??ZDApp_ProcessSecMsg_1:
   \   000029   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   6401         XRL     A,#0x1
   \   00002F   7015         JNZ     ??ZDApp_ProcessSecMsg_3
   1249                {
   1250                  ZDSecMgrRemoveDeviceInd( (ZDO_RemoveDeviceInd_t*)msgPtr );
   \   000031                ; Setup parameters for call to function ZDSecMgrRemoveDeviceInd
   \   000031   12....       LCALL   ??ZDSecMgrRemoveDeviceInd?relay
   \   000034   8010         SJMP    ??ZDApp_ProcessSecMsg_3
   1251                }
   1252                break;
   1253          
   1254              case ZDO_REQUEST_KEY_IND:
   1255                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1256                {
   1257                  if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1258                  {
   1259                    ZDSecMgrRequestKeyInd( (ZDO_RequestKeyInd_t*)msgPtr );
   1260                  }
   1261                }
   1262                break;
   1263          
   1264              case ZDO_SWITCH_KEY_IND:
   1265                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_2:
   \   000036   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   6401         XRL     A,#0x1
   \   00003C   6005         JZ      ??ZDApp_ProcessSecMsg_5
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   6402         XRL     A,#0x2
   \   000041   7003         JNZ     ??ZDApp_ProcessSecMsg_3
   1266                {
   1267                  ZDSecMgrSwitchKeyInd( (ZDO_SwitchKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_5:
   \   000043                ; Setup parameters for call to function ZDSecMgrSwitchKeyInd
   \   000043   12....       LCALL   ??ZDSecMgrSwitchKeyInd?relay
   1268                }
   1269                break;
   1270              
   1271              case ZDO_AUTHENTICATE_IND:
   1272                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1273                {
   1274                  ZDSecMgrAuthenticateInd( (ZDO_AuthenticateInd_t*)msgPtr );
   1275                }
   1276                break;
   1277          
   1278              case ZDO_AUTHENTICATE_CFM:
   1279                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1280                {
   1281                  ZDSecMgrAuthenticateCfm( (ZDO_AuthenticateCfm_t*)msgPtr );
   1282                }
   1283                break;
   1284          
   1285              default:
   1286                // Unsupported messages
   1287                break;
   1288            }
   1289          }
   \                     ??ZDApp_ProcessSecMsg_3:
   \   000046   02....       LJMP    ?Subroutine3 & 0xFFFF
   1290          
   1291          /*********************************************************************
   1292           * @fn      ZDApp_ProcessNetworkJoin()
   1293           *
   1294           * @brief
   1295           *
   1296           *   Save off the Network key information.
   1297           *
   1298           * @param   none
   1299           *
   1300           * @return  none
   1301           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1302          void ZDApp_ProcessNetworkJoin( void )
   \                     ZDApp_ProcessNetworkJoin:
   1303          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1304            if ( (devState == DEV_NWK_JOINING) ||
   1305                ((devState == DEV_NWK_ORPHAN)  &&
   1306                 (ZDO_Config_Node_Descriptor.LogicalType == NODETYPE_ROUTER)) )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6403         XRL     A,#0x3
   \   000010   6015         JZ      ??ZDApp_ProcessNetworkJoin_0
   \   000012   E0           MOVX    A,@DPTR
   \   000013   640A         XRL     A,#0xa
   \   000015   6003         JZ      $+5
   \   000017   02....       LJMP    ??ZDApp_ProcessNetworkJoin_1 & 0xFFFF
   \   00001A   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   5407         ANL     A,#0x7
   \   000020   6401         XRL     A,#0x1
   \   000022   6003         JZ      $+5
   \   000024   02....       LJMP    ??ZDApp_ProcessNetworkJoin_2 & 0xFFFF
   1307            {
   1308              // Result of a Join attempt by this device.
   1309              if ( nwkStatus == ZSuccess )
   \                     ??ZDApp_ProcessNetworkJoin_0:
   \   000027   90....       MOV     DPTR,#nwkStatus
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   707D         JNZ     ??ZDApp_ProcessNetworkJoin_3
   1310              {
   1311                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00002D                ; Setup parameters for call to function osal_set_event
   \   00002D   7A10         MOV     R2,#0x10
   \   00002F   7B00         MOV     R3,#0x0
   \   000031   90....       MOV     DPTR,#ZDAppTaskID
   \   000034   E0           MOVX    A,@DPTR
   \   000035   F9           MOV     R1,A
   \   000036   12....       LCALL   ??osal_set_event?relay
   1312          
   1313          #if defined ( POWER_SAVING )
   1314                osal_pwrmgr_device( PWRMGR_BATTERY );
   1315          #endif
   1316          
   1317                if ( ZG_SECURE_ENABLED && ( ZDApp_RestoreNwkKey() == false ) )
   1318                {
   1319                  // wait for auth from trust center!!
   1320                  devState = DEV_END_DEVICE_UNAUTH;
   1321          
   1322                  // Start the reset timer for MAX UNAUTH time
   1323                  ZDApp_ResetTimerStart( 10000 );//MAX_DEVICE_UNAUTH_TIMEOUT );
   1324                }
   1325                else
   1326                {
   1327                  if ( ZSTACK_ROUTER_BUILD )
   1328                  {
   1329                    if ( devState == DEV_NWK_ORPHAN 
   1330                      && ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \   000039   90....       MOV     DPTR,#devState
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   640A         XRL     A,#0xa
   \   00003F   7012         JNZ     ??ZDApp_ProcessNetworkJoin_4
   \   000041   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000044   E0           MOVX    A,@DPTR
   \   000045   5407         ANL     A,#0x7
   \   000047   6402         XRL     A,#0x2
   \   000049   6040         JZ      ??ZDApp_ProcessNetworkJoin_5
   1331                    {
   1332                      // Change NIB state to router for restore
   1333                      _NIB.nwkState = NWK_ROUTER;
   \   00004B   90....       MOV     DPTR,#_NIB + 35
   \   00004E   7408         MOV     A,#0x8
   \   000050   F0           MOVX    @DPTR,A
   \   000051   8038         SJMP    ??ZDApp_ProcessNetworkJoin_5
   1334                    }
   1335                  }
   1336                          
   1337                  if ( devState == DEV_NWK_JOINING )
   \                     ??ZDApp_ProcessNetworkJoin_4:
   \   000053   E0           MOVX    A,@DPTR
   \   000054   6403         XRL     A,#0x3
   \   000056   7033         JNZ     ??ZDApp_ProcessNetworkJoin_5
   1338                  {
   1339                    ZDApp_AnnounceNewAddress();
   \   000058                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000058   7A00         MOV     R2,#0x0
   \   00005A   7B00         MOV     R3,#0x0
   \   00005C   12....       LCALL   ??APSME_HoldDataRequests?relay
   \   00005F                ; Setup parameters for call to function NLME_GetExtAddr
   \   00005F   12....       LCALL   ??NLME_GetExtAddr?relay
   \   000062   8A..         MOV     ?V0 + 0,R2
   \   000064   8B..         MOV     ?V0 + 1,R3
   \   000066   AE..         MOV     R6,?V0 + 0
   \   000068                ; Setup parameters for call to function NLME_GetShortAddr
   \   000068   12....       LCALL   ??NLME_GetShortAddr?relay
   \   00006B                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   00006B   75..00       MOV     ?V0 + 0,#0x0
   \   00006E   78..         MOV     R0,#?V0 + 0
   \   000070   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000073   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000076   E0           MOVX    A,@DPTR
   \   000077   F9           MOV     R1,A
   \   000078   EE           MOV     A,R6
   \   000079   FC           MOV     R4,A
   \   00007A   AD..         MOV     R5,?V0 + 1
   \   00007C   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   00007F   7401         MOV     A,#0x1
   \   000081   12....       LCALL   ?DEALLOC_XSTACK8
   \   000084                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000084   7A00         MOV     R2,#0x0
   \   000086   7B00         MOV     R3,#0x0
   \   000088   12....       LCALL   ??APSME_HoldDataRequests?relay
   1340                  }
   1341                  
   1342                  devState = DEV_END_DEVICE;
   \                     ??ZDApp_ProcessNetworkJoin_5:
   \   00008B   90....       MOV     DPTR,#devState
   \   00008E   7406         MOV     A,#0x6
   \   000090   F0           MOVX    @DPTR,A
   1343                  if ( ZSTACK_ROUTER_BUILD )
   1344                  {
   1345                    // NOTE: first two parameters are not used, see NLMEDE.h for details
   1346                    if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \   000091   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000094   E0           MOVX    A,@DPTR
   \   000095   5407         ANL     A,#0x7
   \   000097   6402         XRL     A,#0x2
   \   000099   7003         JNZ     $+5
   \   00009B   02....       LJMP    ??ZDApp_ProcessNetworkJoin_6 & 0xFFFF
   1347                    {
   1348                      NLME_StartRouterRequest( 0, 0, false );
   \   00009E                ; Setup parameters for call to function NLME_StartRouterRequest
   \   00009E   7B00         MOV     R3,#0x0
   \   0000A0   7A00         MOV     R2,#0x0
   \   0000A2   7900         MOV     R1,#0x0
   \   0000A4   12....       LCALL   ??NLME_StartRouterRequest?relay
   \   0000A7   02....       LJMP    ??ZDApp_ProcessNetworkJoin_6 & 0xFFFF
   1349                    }
   1350                  }
   1351                }
   1352              }
   1353              else
   1354              {
   1355                if ( (devStartMode == MODE_RESUME) && (++retryCnt >= MAX_RESUME_RETRY) )
   \                     ??ZDApp_ProcessNetworkJoin_3:
   \   0000AA   90....       MOV     DPTR,#devStartMode
   \   0000AD   E0           MOVX    A,@DPTR
   \   0000AE   6401         XRL     A,#0x1
   \   0000B0   7039         JNZ     ??ZDApp_ProcessNetworkJoin_7
   \   0000B2   90....       MOV     DPTR,#retryCnt
   \   0000B5   E0           MOVX    A,@DPTR
   \   0000B6   04           INC     A
   \   0000B7   F0           MOVX    @DPTR,A
   \   0000B8   C3           CLR     C
   \   0000B9   9403         SUBB    A,#0x3
   \   0000BB   402E         JC      ??ZDApp_ProcessNetworkJoin_7
   1356                {
   1357                  if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   0000BD   90....       MOV     DPTR,#_NIB + 33
   \   0000C0   E0           MOVX    A,@DPTR
   \   0000C1   F8           MOV     R0,A
   \   0000C2   A3           INC     DPTR
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   F9           MOV     R1,A
   \   0000C5   74FF         MOV     A,#-0x1
   \   0000C7   68           XRL     A,R0
   \   0000C8   7003         JNZ     ??ZDApp_ProcessNetworkJoin_8
   \   0000CA   74FF         MOV     A,#-0x1
   \   0000CC   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_8:
   \   0000CD   600A         JZ      ??ZDApp_ProcessNetworkJoin_9
   \   0000CF   74FE         MOV     A,#-0x2
   \   0000D1   68           XRL     A,R0
   \   0000D2   7003         JNZ     ??ZDApp_ProcessNetworkJoin_10
   \   0000D4   74FF         MOV     A,#-0x1
   \   0000D6   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_10:
   \   0000D7   7006         JNZ     ??ZDApp_ProcessNetworkJoin_11
   1358                    devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_9:
   \   0000D9   90....       MOV     DPTR,#devStartMode
   \   0000DC   E4           CLR     A
   \   0000DD   800B         SJMP    ??ZDApp_ProcessNetworkJoin_12
   1359                  else
   1360                  {
   1361                    devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_11:
   \   0000DF   90....       MOV     DPTR,#devStartMode
   \   0000E2   7403         MOV     A,#0x3
   \   0000E4   F0           MOVX    @DPTR,A
   1362                    _tmpRejoinState = true;
   \   0000E5   90....       MOV     DPTR,#_tmpRejoinState
   \   0000E8   7401         MOV     A,#0x1
   \                     ??ZDApp_ProcessNetworkJoin_12:
   \   0000EA   F0           MOVX    @DPTR,A
   1363                  }
   1364                }
   1365          
   1366                if ( (NLME_GetShortAddr() != INVALID_NODE_ADDR) ||
   1367                     (_NIB.nwkDevAddress != INVALID_NODE_ADDR) )
   \                     ??ZDApp_ProcessNetworkJoin_7:
   \   0000EB                ; Setup parameters for call to function NLME_GetShortAddr
   \   0000EB   12....       LCALL   ??NLME_GetShortAddr?relay
   \   0000EE   8A..         MOV     ?V0 + 0,R2
   \   0000F0   8B..         MOV     ?V0 + 1,R3
   \   0000F2   74FE         MOV     A,#-0x2
   \   0000F4   65..         XRL     A,?V0 + 0
   \   0000F6   7004         JNZ     ??ZDApp_ProcessNetworkJoin_13
   \   0000F8   74FF         MOV     A,#-0x1
   \   0000FA   65..         XRL     A,?V0 + 1
   \                     ??ZDApp_ProcessNetworkJoin_13:
   \   0000FC   700D         JNZ     ??ZDApp_ProcessNetworkJoin_14
   \   0000FE   90....       MOV     DPTR,#_NIB + 20
   \   000101   E0           MOVX    A,@DPTR
   \   000102   64FE         XRL     A,#0xfe
   \   000104   7003         JNZ     ??ZDApp_ProcessNetworkJoin_15
   \   000106   A3           INC     DPTR
   \   000107   E0           MOVX    A,@DPTR
   \   000108   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_15:
   \   000109   6023         JZ      ??ZDApp_ProcessNetworkJoin_16
   1368                {
   1369                  uint16 addr = INVALID_NODE_ADDR;
   \                     ??ZDApp_ProcessNetworkJoin_14:
   \   00010B   85..82       MOV     DPL,?XSP + 0
   \   00010E   85..83       MOV     DPH,?XSP + 1
   \   000111   74FE         MOV     A,#-0x2
   \   000113   F0           MOVX    @DPTR,A
   \   000114   A3           INC     DPTR
   \   000115   04           INC     A
   \   000116   F0           MOVX    @DPTR,A
   1370                  // Invalidate nwk addr so end device does not use in its data reqs.
   1371                  _NIB.nwkDevAddress = INVALID_NODE_ADDR;
   \   000117   90....       MOV     DPTR,#_NIB + 20
   \   00011A   14           DEC     A
   \   00011B   F0           MOVX    @DPTR,A
   \   00011C   A3           INC     DPTR
   \   00011D   04           INC     A
   \   00011E   F0           MOVX    @DPTR,A
   1372                  ZMacSetReq( ZMacShortAddress, (uint8 *)&addr );
   \   00011F                ; Setup parameters for call to function ZMacSetReq
   \   00011F   85..82       MOV     DPL,?XSP + 0
   \   000122   85..83       MOV     DPH,?XSP + 1
   \   000125   AA82         MOV     R2,DPL
   \   000127   AB83         MOV     R3,DPH
   \   000129   7953         MOV     R1,#0x53
   \   00012B   12....       LCALL   ??ZMacSetReq?relay
   1373                }
   1374          
   1375                // Clear the neighbor Table and network discovery tables.
   1376                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_16:
   \   00012E                ; Setup parameters for call to function nwkNeighborInitTable
   \   00012E   12....       LCALL   ??nwkNeighborInitTable?relay
   1377                NLME_NwkDiscTerm();
   \   000131                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   000131   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1378          
   1379                zdoDiscCounter = 1;
   \   000134   90....       MOV     DPTR,#zdoDiscCounter
   \   000137   7401         MOV     A,#0x1
   \   000139   F0           MOVX    @DPTR,A
   1380          
   1381          //      ZDApp_NetworkInit( (uint16)
   1382          //                         ((NWK_START_DELAY * (osal_rand() & 0x0F)) +
   1383          //                          (NWK_START_DELAY * 5)) );
   1384                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1385                     + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   00013A                ; Setup parameters for call to function osal_rand
   \                     ??ZDApp_ProcessNetworkJoin_17:
   \   00013A   12....       LCALL   ??osal_rand?relay
   \   00013D   EA           MOV     A,R2
   \   00013E   547F         ANL     A,#0x7f
   \   000140   2464         ADD     A,#0x64
   \   000142   FC           MOV     R4,A
   \   000143   7D00         MOV     R5,#0x0
   \   000145   7A01         MOV     R2,#0x1
   \   000147   7003         JNZ     $+5
   \   000149   02....       LJMP    ??ZDApp_ProcessNetworkJoin_18 & 0xFFFF
   \   00014C                ; Setup parameters for call to function osal_start_timerEx
   \   00014C   7B00         MOV     R3,#0x0
   \   00014E   90....       MOV     DPTR,#ZDAppTaskID
   \   000151   E0           MOVX    A,@DPTR
   \   000152   F9           MOV     R1,A
   \   000153   12....       LCALL   ??osal_start_timerEx?relay
   \   000156   02....       LJMP    ??ZDApp_ProcessNetworkJoin_6 & 0xFFFF
   1386              }
   1387            }
   1388            else if ( devState == DEV_NWK_ORPHAN || devState == DEV_NWK_REJOIN )
   \                     ??ZDApp_ProcessNetworkJoin_1:
   \   000159   E0           MOVX    A,@DPTR
   \   00015A   6404         XRL     A,#0x4
   \   00015C   6003         JZ      $+5
   \   00015E   02....       LJMP    ??ZDApp_ProcessNetworkJoin_19 & 0xFFFF
   1389            {
   1390              // results of an orphaning attempt by this device
   1391              if (nwkStatus == ZSuccess)
   \                     ??ZDApp_ProcessNetworkJoin_2:
   \   000161   90....       MOV     DPTR,#nwkStatus
   \   000164   E0           MOVX    A,@DPTR
   \   000165   7078         JNZ     ??ZDApp_ProcessNetworkJoin_20
   1392              {
   1393                if ( ZG_SECURE_ENABLED )
   1394                {
   1395                  ZDApp_RestoreNwkKey();
   1396                }
   1397                
   1398                devState = DEV_END_DEVICE;
   \   000167   90....       MOV     DPTR,#devState
   \   00016A   7406         MOV     A,#0x6
   \   00016C   F0           MOVX    @DPTR,A
   1399                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00016D                ; Setup parameters for call to function osal_set_event
   \   00016D   7A10         MOV     R2,#0x10
   \   00016F   7B00         MOV     R3,#0x0
   \   000171   90....       MOV     DPTR,#ZDAppTaskID
   \   000174   E0           MOVX    A,@DPTR
   \   000175   F9           MOV     R1,A
   \   000176   12....       LCALL   ??osal_set_event?relay
   1400                // setup Power Manager Device
   1401          #if defined ( POWER_SAVING )
   1402                osal_pwrmgr_device( PWRMGR_BATTERY );
   1403          #endif
   1404          
   1405                if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \   000179   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00017C   E0           MOVX    A,@DPTR
   \   00017D   A2E3         MOV     C,0xE0 /* A   */.3
   \   00017F   5015         JNC     ??ZDApp_ProcessNetworkJoin_21
   1406                {
   1407                  // The receiver is on, turn network layer polling off.
   1408                  NLME_SetPollRate( 0 );
   \   000181                ; Setup parameters for call to function NLME_SetPollRate
   \   000181   7A00         MOV     R2,#0x0
   \   000183   7B00         MOV     R3,#0x0
   \   000185   12....       LCALL   ??NLME_SetPollRate?relay
   1409                  NLME_SetQueuedPollRate( 0 );
   \   000188                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000188   7A00         MOV     R2,#0x0
   \   00018A   7B00         MOV     R3,#0x0
   \   00018C   12....       LCALL   ??NLME_SetQueuedPollRate?relay
   1410                  NLME_SetResponseRate( 0 );
   \   00018F                ; Setup parameters for call to function NLME_SetResponseRate
   \   00018F   7A00         MOV     R2,#0x0
   \   000191   7B00         MOV     R3,#0x0
   \   000193   12....       LCALL   ??NLME_SetResponseRate?relay
   1411                }
   1412          
   1413                if ( ZSTACK_ROUTER_BUILD )
   1414                {
   1415                  // NOTE: first two parameters are not used, see NLMEDE.h for details
   1416                  if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \                     ??ZDApp_ProcessNetworkJoin_21:
   \   000196   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000199   E0           MOVX    A,@DPTR
   \   00019A   5407         ANL     A,#0x7
   \   00019C   6402         XRL     A,#0x2
   \   00019E   6009         JZ      ??ZDApp_ProcessNetworkJoin_22
   1417                  {
   1418                    NLME_StartRouterRequest( 0, 0, false );
   \   0001A0                ; Setup parameters for call to function NLME_StartRouterRequest
   \   0001A0   7B00         MOV     R3,#0x0
   \   0001A2   7A00         MOV     R2,#0x0
   \   0001A4   7900         MOV     R1,#0x0
   \   0001A6   12....       LCALL   ??NLME_StartRouterRequest?relay
   1419                  }
   1420                }
   1421                
   1422                ZDApp_AnnounceNewAddress();
   \                     ??ZDApp_ProcessNetworkJoin_22:
   \   0001A9                ; Setup parameters for call to function APSME_HoldDataRequests
   \   0001A9   7A00         MOV     R2,#0x0
   \   0001AB   7B00         MOV     R3,#0x0
   \   0001AD   12....       LCALL   ??APSME_HoldDataRequests?relay
   \   0001B0                ; Setup parameters for call to function NLME_GetExtAddr
   \   0001B0   12....       LCALL   ??NLME_GetExtAddr?relay
   \   0001B3   8A..         MOV     ?V0 + 0,R2
   \   0001B5   8B..         MOV     ?V0 + 1,R3
   \   0001B7   AE..         MOV     R6,?V0 + 0
   \   0001B9                ; Setup parameters for call to function NLME_GetShortAddr
   \   0001B9   12....       LCALL   ??NLME_GetShortAddr?relay
   \   0001BC                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   0001BC   75..00       MOV     ?V0 + 0,#0x0
   \   0001BF   78..         MOV     R0,#?V0 + 0
   \   0001C1   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001C4   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0001C7   E0           MOVX    A,@DPTR
   \   0001C8   F9           MOV     R1,A
   \   0001C9   EE           MOV     A,R6
   \   0001CA   FC           MOV     R4,A
   \   0001CB   AD..         MOV     R5,?V0 + 1
   \   0001CD   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   0001D0   7401         MOV     A,#0x1
   \   0001D2   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001D5                ; Setup parameters for call to function APSME_HoldDataRequests
   \   0001D5   7A00         MOV     R2,#0x0
   \   0001D7   7B00         MOV     R3,#0x0
   \   0001D9   12....       LCALL   ??APSME_HoldDataRequests?relay
   1423              }
   \   0001DC   02....       LJMP    ??ZDApp_ProcessNetworkJoin_6 & 0xFFFF
   1424              else
   1425              {
   1426                if ( devStartMode == MODE_RESUME )
   \                     ??ZDApp_ProcessNetworkJoin_20:
   \   0001DF   90....       MOV     DPTR,#devStartMode
   \   0001E2   E0           MOVX    A,@DPTR
   \   0001E3   6401         XRL     A,#0x1
   \   0001E5   7043         JNZ     ??ZDApp_ProcessNetworkJoin_23
   1427                {
   1428                  if ( ++retryCnt <= MAX_RESUME_RETRY )
   \   0001E7   90....       MOV     DPTR,#retryCnt
   \   0001EA   E0           MOVX    A,@DPTR
   \   0001EB   04           INC     A
   \   0001EC   F0           MOVX    @DPTR,A
   \   0001ED   C3           CLR     C
   \   0001EE   9404         SUBB    A,#0x4
   \   0001F0   5030         JNC     ??ZDApp_ProcessNetworkJoin_24
   1429                  {
   1430                    if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   0001F2   90....       MOV     DPTR,#_NIB + 33
   \   0001F5   E0           MOVX    A,@DPTR
   \   0001F6   F8           MOV     R0,A
   \   0001F7   A3           INC     DPTR
   \   0001F8   E0           MOVX    A,@DPTR
   \   0001F9   F9           MOV     R1,A
   \   0001FA   74FF         MOV     A,#-0x1
   \   0001FC   68           XRL     A,R0
   \   0001FD   7003         JNZ     ??ZDApp_ProcessNetworkJoin_25
   \   0001FF   74FF         MOV     A,#-0x1
   \   000201   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_25:
   \   000202   600A         JZ      ??ZDApp_ProcessNetworkJoin_26
   \   000204   74FE         MOV     A,#-0x2
   \   000206   68           XRL     A,R0
   \   000207   7003         JNZ     ??ZDApp_ProcessNetworkJoin_27
   \   000209   74FF         MOV     A,#-0x1
   \   00020B   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_27:
   \   00020C   7007         JNZ     ??ZDApp_ProcessNetworkJoin_28
   1431                      devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_26:
   \   00020E   90....       MOV     DPTR,#devStartMode
   \   000211   E4           CLR     A
   \                     ??ZDApp_ProcessNetworkJoin_29:
   \   000212   F0           MOVX    @DPTR,A
   \   000213   8015         SJMP    ??ZDApp_ProcessNetworkJoin_23
   1432                    else
   1433                    {
   1434                      devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_28:
   \   000215   90....       MOV     DPTR,#devStartMode
   \   000218   7403         MOV     A,#0x3
   \   00021A   F0           MOVX    @DPTR,A
   1435                      _tmpRejoinState = true;
   \   00021B   90....       MOV     DPTR,#_tmpRejoinState
   \   00021E   7401         MOV     A,#0x1
   \   000220   80F0         SJMP    ??ZDApp_ProcessNetworkJoin_29
   1436                    }
   1437                  }
   1438                  // Do a normal join to the network after certain times of rejoin retries
   1439                  else if( AIB_apsUseInsecureJoin == true )
   \                     ??ZDApp_ProcessNetworkJoin_24:
   \   000222   90....       MOV     DPTR,#AIB_apsUseInsecureJoin
   \   000225   E0           MOVX    A,@DPTR
   \   000226   6401         XRL     A,#0x1
   \   000228   60E4         JZ      ??ZDApp_ProcessNetworkJoin_26
   1440                  {
   1441                    devStartMode = MODE_JOIN;
   1442                  }
   1443                }
   1444          
   1445                // Clear the neighbor Table and network discovery tables.
   1446                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_23:
   \   00022A                ; Setup parameters for call to function nwkNeighborInitTable
   \   00022A   12....       LCALL   ??nwkNeighborInitTable?relay
   1447                NLME_NwkDiscTerm();
   \   00022D                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   00022D   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1448          
   1449                // setup a retry for later...
   1450                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1451                     + (osal_rand()& EXTENDED_JOINING_RANDOM_MASK)) );
   \   000230                ; Setup parameters for call to function osal_rand
   \   000230   02....       LJMP    ??ZDApp_ProcessNetworkJoin_17 & 0xFFFF
   1452              }
   1453            }
   1454          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
   1455            else
   1456            {
   1457              // Assume from address conflict
   1458              if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \                     ??ZDApp_ProcessNetworkJoin_19:
   \   000233   90....       MOV     DPTR,#_NIB + 96
   \   000236   E0           MOVX    A,@DPTR
   \   000237   6402         XRL     A,#0x2
   \   000239   703F         JNZ     ??ZDApp_ProcessNetworkJoin_6
   1459              {
   1460                // Notify the network
   1461                ZDApp_AnnounceNewAddress();
   \   00023B                ; Setup parameters for call to function APSME_HoldDataRequests
   \   00023B   7A00         MOV     R2,#0x0
   \   00023D   7B00         MOV     R3,#0x0
   \   00023F   12....       LCALL   ??APSME_HoldDataRequests?relay
   \   000242                ; Setup parameters for call to function NLME_GetExtAddr
   \   000242   12....       LCALL   ??NLME_GetExtAddr?relay
   \   000245   8A..         MOV     ?V0 + 0,R2
   \   000247   8B..         MOV     ?V0 + 1,R3
   \   000249   AE..         MOV     R6,?V0 + 0
   \   00024B                ; Setup parameters for call to function NLME_GetShortAddr
   \   00024B   12....       LCALL   ??NLME_GetShortAddr?relay
   \   00024E                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   00024E   75..00       MOV     ?V0 + 0,#0x0
   \   000251   78..         MOV     R0,#?V0 + 0
   \   000253   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000256   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000259   E0           MOVX    A,@DPTR
   \   00025A   F9           MOV     R1,A
   \   00025B   EE           MOV     A,R6
   \   00025C   FC           MOV     R4,A
   \   00025D   AD..         MOV     R5,?V0 + 1
   \   00025F   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   000262   7401         MOV     A,#0x1
   \   000264   12....       LCALL   ?DEALLOC_XSTACK8
   \   000267                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000267   7A00         MOV     R2,#0x0
   \   000269   7B00         MOV     R3,#0x0
   \   00026B   12....       LCALL   ??APSME_HoldDataRequests?relay
   1462                
   1463                // Notify apps
   1464                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00026E                ; Setup parameters for call to function osal_set_event
   \   00026E   7A10         MOV     R2,#0x10
   \                     ??ZDApp_ProcessNetworkJoin_18:
   \   000270   7B00         MOV     R3,#0x0
   \   000272   90....       MOV     DPTR,#ZDAppTaskID
   \   000275   E0           MOVX    A,@DPTR
   \   000276   F9           MOV     R1,A
   \   000277   12....       LCALL   ??osal_set_event?relay
   1465              }
   1466            }
   1467          #endif
   1468          }
   \                     ??ZDApp_ProcessNetworkJoin_6:
   \   00027A   7402         MOV     A,#0x2
   \   00027C   02....       LJMP    ??Subroutine8_0 & 0xFFFF
   1469          
   1470          /*********************************************************************
   1471           * @fn      ZDApp_SaveNwkKey()
   1472           *
   1473           * @brief   Save off the Network key information.
   1474           *
   1475           * @param   none
   1476           *
   1477           * @return  none
   1478           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1479          void ZDApp_SaveNwkKey( void )
   \                     ZDApp_SaveNwkKey:
   1480          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1481            nwkActiveKeyItems keyItems;
   1482          
   1483            SSP_ReadNwkActiveKey( &keyItems );
   \   00000A                ; Setup parameters for call to function SSP_ReadNwkActiveKey
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   AA82         MOV     R2,DPL
   \   000012   AB83         MOV     R3,DPH
   \   000014   12....       LCALL   ??SSP_ReadNwkActiveKey?relay
   1484            keyItems.frameCounter++;
   \   000017   90....       MOV     DPTR,#__Constant_1
   \   00001A   78..         MOV     R0,#?V0 + 0
   \   00001C   12....       LCALL   ?L_MOV_X
   \   00001F   7411         MOV     A,#0x11
   \   000021   12....       LCALL   ?XSTACK_DISP0_8
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?L_ADD_TO_X
   1485          
   1486            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1487                          (void *)&keyItems );
   \   000029                ; Setup parameters for call to function osal_nv_write
   \   000029   85..82       MOV     DPL,?XSP + 0
   \   00002C   85..83       MOV     DPH,?XSP + 1
   \   00002F   8582..       MOV     ?V0 + 0,DPL
   \   000032   8583..       MOV     ?V0 + 1,DPH
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003A   75..15       MOV     ?V0 + 0,#0x15
   \   00003D   75..00       MOV     ?V0 + 1,#0x0
   \   000040   78..         MOV     R0,#?V0 + 0
   \   000042   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000045   7C00         MOV     R4,#0x0
   \   000047   7D00         MOV     R5,#0x0
   \   000049   7A82         MOV     R2,#-0x7e
   \   00004B   7B00         MOV     R3,#0x0
   \   00004D   12....       LCALL   ??osal_nv_write?relay
   \   000050   7404         MOV     A,#0x4
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
   1488          
   1489            nwkFrameCounterChanges = 0;
   \   000055   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000058   E4           CLR     A
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   F0           MOVX    @DPTR,A
   1490          }
   \   00005C                REQUIRE ?Subroutine2
   \   00005C                ; // Fall through to label ?Subroutine2
   1491          
   1492          /*********************************************************************
   1493           * @fn      ZDApp_ResetNwkKey()
   1494           *
   1495           * @brief   Reset the Network key information in NV.
   1496           *
   1497           * @param   none
   1498           *
   1499           * @return  none
   1500           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1501          void ZDApp_ResetNwkKey( void )
   \                     ZDApp_ResetNwkKey:
   1502          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1503            nwkActiveKeyItems keyItems;
   1504          
   1505            osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C15         MOV     R4,#0x15
   \   00000C   7D00         MOV     R5,#0x0
   \   00000E   7900         MOV     R1,#0x0
   \   000010   85..82       MOV     DPL,?XSP + 0
   \   000013   85..83       MOV     DPH,?XSP + 1
   \   000016   AA82         MOV     R2,DPL
   \   000018   AB83         MOV     R3,DPH
   \   00001A   12....       LCALL   ??osal_memset?relay
   1506            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1507                          (void *)&keyItems );
   \   00001D                ; Setup parameters for call to function osal_nv_write
   \   00001D   85..82       MOV     DPL,?XSP + 0
   \   000020   85..83       MOV     DPH,?XSP + 1
   \   000023   8582..       MOV     ?V0 + 0,DPL
   \   000026   8583..       MOV     ?V0 + 1,DPH
   \   000029   78..         MOV     R0,#?V0 + 0
   \   00002B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002E   75..15       MOV     ?V0 + 0,#0x15
   \   000031   75..00       MOV     ?V0 + 1,#0x0
   \   000034   78..         MOV     R0,#?V0 + 0
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   7C00         MOV     R4,#0x0
   \   00003B   7D00         MOV     R5,#0x0
   \   00003D   7A82         MOV     R2,#-0x7e
   \   00003F   7B00         MOV     R3,#0x0
   \   000041   12....       LCALL   ??osal_nv_write?relay
   \   000044   7404         MOV     A,#0x4
   \   000046   12....       LCALL   ?DEALLOC_XSTACK8
   1508          }
   \   000049   02....       LJMP    ?Subroutine6 & 0xFFFF
   1509          
   1510          /*********************************************************************
   1511           * @fn      ZDApp_RestoreNwkKey()
   1512           *
   1513           * @brief
   1514           *
   1515           *   Save off the Network key information.
   1516           *
   1517           * @param   none
   1518           *
   1519           * @return  true if restored from NV, false if not
   1520           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1521          uint8 ZDApp_RestoreNwkKey( void )
   \                     ZDApp_RestoreNwkKey:
   1522          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1523            nwkActiveKeyItems keyItems;
   1524            uint8 ret = false;
   \   00000A   7E00         MOV     R6,#0x0
   1525          
   1526            if ( osal_nv_read( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), (void*)&keyItems )
   1527                == ZSUCCESS )
   \   00000C                ; Setup parameters for call to function osal_nv_read
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   8582..       MOV     ?V0 + 0,DPL
   \   000015   8583..       MOV     ?V0 + 1,DPH
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   75..15       MOV     ?V0 + 0,#0x15
   \   000020   8E..         MOV     ?V0 + 1,R6
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   7C00         MOV     R4,#0x0
   \   000029   7D00         MOV     R5,#0x0
   \   00002B   7A82         MOV     R2,#-0x7e
   \   00002D   7B00         MOV     R3,#0x0
   \   00002F   12....       LCALL   ??osal_nv_read?relay
   \   000032   7404         MOV     A,#0x4
   \   000034   12....       LCALL   ?DEALLOC_XSTACK8
   \   000037   E9           MOV     A,R1
   \   000038   702F         JNZ     ??ZDApp_RestoreNwkKey_0
   1528            {
   1529              if ( keyItems.frameCounter > 0 )
   \   00003A   7411         MOV     A,#0x11
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   78..         MOV     R0,#?V0 + 0
   \   000041   12....       LCALL   ?L_MOV_X
   \   000044   E5..         MOV     A,?V0 + 0
   \   000046   45..         ORL     A,?V0 + 1
   \   000048   45..         ORL     A,?V0 + 2
   \   00004A   45..         ORL     A,?V0 + 3
   \   00004C   6011         JZ      ??ZDApp_RestoreNwkKey_1
   1530              {
   1531                // Restore the key information
   1532                keyItems.frameCounter += MAX_NWK_FRAMECOUNTER_CHANGES;
   1533                nwkFrameCounter = keyItems.frameCounter;
   \   00004E   90....       MOV     DPTR,#__Constant_3e8
   \   000051   78..         MOV     R0,#?V0 + 0
   \   000053   12....       LCALL   ?L_ADD_X
   \   000056   90....       MOV     DPTR,#nwkFrameCounter
   \   000059   78..         MOV     R0,#?V0 + 0
   \   00005B   12....       LCALL   ?L_MOV_TO_X
   1534                ret = true;
   \   00005E   0E           INC     R6
   1535              }
   1536          
   1537              // Force a save for the first frame counter increment
   1538              nwkFrameCounterChanges = MAX_NWK_FRAMECOUNTER_CHANGES + 1;
   \                     ??ZDApp_RestoreNwkKey_1:
   \   00005F   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000062   74E9         MOV     A,#-0x17
   \   000064   F0           MOVX    @DPTR,A
   \   000065   A3           INC     DPTR
   \   000066   7403         MOV     A,#0x3
   \   000068   F0           MOVX    @DPTR,A
   1539            }
   1540            return ( ret );
   \                     ??ZDApp_RestoreNwkKey_0:
   \   000069   EE           MOV     A,R6
   \   00006A   F9           MOV     R1,A
   \   00006B   02....       LJMP    ?Subroutine2 & 0xFFFF
   1541          }
   1542          
   1543          /*********************************************************************
   1544           * @fn      ZDApp_ResetTimerStart
   1545           *
   1546           * @brief   Start the reset timer.
   1547           *
   1548           * @param   delay - delay time(ms) before reset
   1549           *
   1550           * @return  none
   1551           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1552          void ZDApp_ResetTimerStart( uint16 delay )
   \                     ZDApp_ResetTimerStart:
   1553          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1554            // Start the rest timer
   1555            osal_start_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET, delay );
   \   000004                ; Setup parameters for call to function osal_start_timerEx
   \   000004   EA           MOV     A,R2
   \   000005   FC           MOV     R4,A
   \   000006   EB           MOV     A,R3
   \   000007   FD           MOV     R5,A
   \   000008   7A04         MOV     R2,#0x4
   \   00000A   7B00         MOV     R3,#0x0
   \   00000C   90....       MOV     DPTR,#ZDAppTaskID
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F9           MOV     R1,A
   \   000011   12....       LCALL   ??osal_start_timerEx?relay
   1556          }
   \   000014   02....       LJMP    ?Subroutine3 & 0xFFFF
   1557          
   1558          /*********************************************************************
   1559           * @fn      ZDApp_ResetTimerCancel
   1560           *
   1561           * @brief   Cancel the reset timer.
   1562           *
   1563           * @param   none
   1564           *
   1565           * @return  none
   1566           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1567          void ZDApp_ResetTimerCancel( void )
   \                     ZDApp_ResetTimerCancel:
   1568          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1569            // Cancel the reset timer
   1570            osal_stop_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET );
   \   000004                ; Setup parameters for call to function osal_stop_timerEx
   \   000004   7A04         MOV     R2,#0x4
   \   000006   7B00         MOV     R3,#0x0
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_stop_timerEx?relay
   1571          }
   \   000010   02....       LJMP    ?Subroutine3 & 0xFFFF
   1572          
   1573          /*********************************************************************
   1574           * @fn      ZDApp_LeaveCtrlInit
   1575           *
   1576           * @brief   Initialize the leave control logic.
   1577           *
   1578           * @param   none
   1579           *
   1580           * @return  none
   1581           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1582          void ZDApp_LeaveCtrlInit( void )
   \                     ZDApp_LeaveCtrlInit:
   1583          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1584            uint8 status;
   1585          
   1586          
   1587            // Initialize control state
   1588            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   1589          
   1590            status = osal_nv_item_init( ZCD_NV_LEAVE_CTRL,
   1591                                        sizeof(ZDApp_LeaveCtrl),
   1592                                        &ZDApp_LeaveCtrl );
   1593          
   1594            if ( status == ZSUCCESS )
   \   00000A                ; Setup parameters for call to function osal_nv_item_init
   \   00000A   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   00000D   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000010   78..         MOV     R0,#?V0 + 0
   \   000012   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000015   7C01         MOV     R4,#0x1
   \   000017   7D00         MOV     R5,#0x0
   \   000019   7A85         MOV     R2,#-0x7b
   \   00001B   7B00         MOV     R3,#0x0
   \   00001D   12....       LCALL   ??osal_nv_item_init?relay
   \   000020   7402         MOV     A,#0x2
   \   000022   12....       LCALL   ?DEALLOC_XSTACK8
   \   000025   E9           MOV     A,R1
   \   000026   7020         JNZ     ??ZDApp_LeaveCtrlInit_0
   1595            {
   1596              // Read saved control
   1597              osal_nv_read( ZCD_NV_LEAVE_CTRL,
   1598                            0,
   1599                            sizeof( uint8 ),
   1600                            &ZDApp_LeaveCtrl);
   \   000028                ; Setup parameters for call to function osal_nv_read
   \   000028   78..         MOV     R0,#?V0 + 0
   \   00002A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002D   75..01       MOV     ?V0 + 0,#0x1
   \   000030   75..00       MOV     ?V0 + 1,#0x0
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000038   7C00         MOV     R4,#0x0
   \   00003A   7D00         MOV     R5,#0x0
   \   00003C   7A85         MOV     R2,#-0x7b
   \   00003E   7B00         MOV     R3,#0x0
   \   000040   12....       LCALL   ??osal_nv_read?relay
   \   000043   7404         MOV     A,#0x4
   \   000045   12....       LCALL   ?DEALLOC_XSTACK8
   1601            }
   1602          }
   \                     ??ZDApp_LeaveCtrlInit_0:
   \   000048   80..         SJMP    ??Subroutine10_0
   1603          
   1604          /*********************************************************************
   1605           * @fn      ZDApp_LeaveCtrlSet
   1606           *
   1607           * @brief   Set the leave control logic.
   1608           *
   1609           * @param   ra - reassociate flag
   1610           *
   1611           * @return  none
   1612           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1613          void ZDApp_LeaveCtrlSet( uint8 ra )
   \                     ZDApp_LeaveCtrlSet:
   1614          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   1615            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_SET;
   \   000007   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000A   7401         MOV     A,#0x1
   \   00000C   F0           MOVX    @DPTR,A
   1616          
   1617            if ( ra == TRUE )
   \   00000D   6E           XRL     A,R6
   \   00000E   7003         JNZ     ??ZDApp_LeaveCtrlSet_0
   1618            {
   1619              ZDApp_LeaveCtrl |= ZDAPP_LEAVE_CTRL_RA;
   \   000010   7403         MOV     A,#0x3
   \   000012   F0           MOVX    @DPTR,A
   1620            }
   1621          
   1622            // Write the leave control
   1623            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1624                           0,
   1625                           sizeof( uint8 ),
   1626                           &ZDApp_LeaveCtrl);
   \                     ??ZDApp_LeaveCtrlSet_0:
   \   000013                ; Setup parameters for call to function osal_nv_write
   \   000013   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000016   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000019   78..         MOV     R0,#?V0 + 0
   \   00001B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001E   75..01       MOV     ?V0 + 0,#0x1
   \   000021   75..00       MOV     ?V0 + 1,#0x0
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000029   7C00         MOV     R4,#0x0
   \   00002B   7D00         MOV     R5,#0x0
   \   00002D   7A85         MOV     R2,#-0x7b
   \   00002F   7B00         MOV     R3,#0x0
   \   000031   12....       LCALL   ??osal_nv_write?relay
   \   000034   7404         MOV     A,#0x4
   \   000036   02....       LJMP    ??Subroutine8_0 & 0xFFFF
   1627          }
   1628          
   1629          /*********************************************************************
   1630           * @fn      ZDApp_LeaveCtrlBypass
   1631           *
   1632           * @brief   Check if NV restore should be skipped during a leave reset.
   1633           *
   1634           * @param   none
   1635           *
   1636           * @return  uint8 - (TRUE bypass:FALSE do not bypass)
   1637           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1638          uint8 ZDApp_LeaveCtrlBypass( void )
   \                     ZDApp_LeaveCtrlBypass:
   1639          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1640            uint8 bypass;
   1641          
   1642            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   1643            {
   1644              bypass = TRUE;
   1645            }
   1646            else
   1647            {
   1648              bypass = FALSE;
   1649            }
   1650          
   1651            return bypass;
   \   000004   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000007   E0           MOVX    A,@DPTR
   \   000008   A2E0         MOV     C,0xE0 /* A   */.0
   \   00000A   E4           CLR     A
   \   00000B   33           RLC     A
   \   00000C   F9           MOV     R1,A
   \   00000D                REQUIRE ?Subroutine3
   \   00000D                ; // Fall through to label ?Subroutine3
   1652          }
   1653          
   1654          /*********************************************************************
   1655           * @fn      ZDApp_LeaveCtrlStartup
   1656           *
   1657           * @brief   Check for startup conditions during a leave reset.
   1658           *
   1659           * @param   state      - devState_t determined by leave control logic
   1660           * @param   startDelay - startup delay
   1661           *
   1662           * @return  none
   1663           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1664          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay )
   \                     ZDApp_LeaveCtrlStartup:
   1665          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1666            *startDelay = 0;
   \   000005   8C82         MOV     DPL,R4
   \   000007   8D83         MOV     DPH,R5
   \   000009   E4           CLR     A
   \   00000A   F0           MOVX    @DPTR,A
   \   00000B   A3           INC     DPTR
   \   00000C   F0           MOVX    @DPTR,A
   1667          
   1668            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   \   00000D   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000010   E0           MOVX    A,@DPTR
   \   000011   A2E0         MOV     C,0xE0 /* A   */.0
   \   000013   5041         JNC     ??ZDApp_LeaveCtrlStartup_0
   1669            {
   1670              if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_RA )
   \   000015   A2E1         MOV     C,0xE0 /* A   */.1
   \   000017   500C         JNC     ??ZDApp_LeaveCtrlStartup_1
   1671              {
   1672                *startDelay = 5000;
   \   000019   8C82         MOV     DPL,R4
   \   00001B   8D83         MOV     DPH,R5
   \   00001D   7488         MOV     A,#-0x78
   \   00001F   F0           MOVX    @DPTR,A
   \   000020   A3           INC     DPTR
   \   000021   7413         MOV     A,#0x13
   \   000023   8005         SJMP    ??ZDApp_LeaveCtrlStartup_2
   1673              }
   1674              else
   1675              {
   1676                *state = DEV_HOLD;
   \                     ??ZDApp_LeaveCtrlStartup_1:
   \   000025   8A82         MOV     DPL,R2
   \   000027   8B83         MOV     DPH,R3
   \   000029   E4           CLR     A
   \                     ??ZDApp_LeaveCtrlStartup_2:
   \   00002A   F0           MOVX    @DPTR,A
   1677              }
   1678          
   1679              // Set leave control to initialized state
   1680              ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   00002B   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00002E   E4           CLR     A
   \   00002F   F0           MOVX    @DPTR,A
   1681          
   1682              // Write initialized control
   1683              osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1684                            0,
   1685                            sizeof( uint8 ),
   1686                            &ZDApp_LeaveCtrl);
   \   000030                ; Setup parameters for call to function osal_nv_write
   \   000030   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000033   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000036   78..         MOV     R0,#?V0 + 0
   \   000038   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003B   75..01       MOV     ?V0 + 0,#0x1
   \   00003E   75..00       MOV     ?V0 + 1,#0x0
   \   000041   78..         MOV     R0,#?V0 + 0
   \   000043   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000046   7C00         MOV     R4,#0x0
   \   000048   7D00         MOV     R5,#0x0
   \   00004A   7A85         MOV     R2,#-0x7b
   \   00004C   7B00         MOV     R3,#0x0
   \   00004E   12....       LCALL   ??osal_nv_write?relay
   \   000051   7404         MOV     A,#0x4
   \   000053   12....       LCALL   ?DEALLOC_XSTACK8
   1687            }
   1688          }
   \                     ??ZDApp_LeaveCtrlStartup_0:
   \   000056   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   1689          
   1690          /*********************************************************************
   1691           * @fn      ZDApp_LeaveReset
   1692           *
   1693           * @brief   Setup a device reset due to a leave indication/confirm.
   1694           *
   1695           * @param   ra - reassociate flag
   1696           *
   1697           * @return  none
   1698           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1699          void ZDApp_LeaveReset( uint8 ra )
   \                     ZDApp_LeaveReset:
   1700          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   1701            ZDApp_LeaveCtrlSet( ra );
   \   000007   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000A   7401         MOV     A,#0x1
   \   00000C   F0           MOVX    @DPTR,A
   \   00000D   6E           XRL     A,R6
   \   00000E   7003         JNZ     ??ZDApp_LeaveReset_0
   \   000010   7403         MOV     A,#0x3
   \   000012   F0           MOVX    @DPTR,A
   \                     ??ZDApp_LeaveReset_0:
   \   000013                ; Setup parameters for call to function osal_nv_write
   \   000013   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000016   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000019   78..         MOV     R0,#?V0 + 0
   \   00001B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001E   75..01       MOV     ?V0 + 0,#0x1
   \   000021   75..00       MOV     ?V0 + 1,#0x0
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000029   7C00         MOV     R4,#0x0
   \   00002B   7D00         MOV     R5,#0x0
   \   00002D   7A85         MOV     R2,#-0x7b
   \   00002F   7B00         MOV     R3,#0x0
   \   000031   12....       LCALL   ??osal_nv_write?relay
   \   000034   7404         MOV     A,#0x4
   \   000036   12....       LCALL   ?DEALLOC_XSTACK8
   1702          
   1703            ZDApp_ResetTimerStart( 5000 );
   \   000039                ; Setup parameters for call to function osal_start_timerEx
   \   000039   7C88         MOV     R4,#-0x78
   \   00003B   7D13         MOV     R5,#0x13
   \   00003D   7A04         MOV     R2,#0x4
   \   00003F   7B00         MOV     R3,#0x0
   \   000041   90....       MOV     DPTR,#ZDAppTaskID
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F9           MOV     R1,A
   \   000046   12....       LCALL   ??osal_start_timerEx?relay
   1704          }
   \   000049   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   1705          
   1706          /*********************************************************************
   1707           * @fn      ZDApp_LeaveUpdate
   1708           *
   1709           * @brief   Update local device data related to leaving device.
   1710           *
   1711           * @param   nwkAddr        - NWK address of leaving device
   1712           * @param   extAddr        - EXT address of leaving device
   1713           * @param   removeChildren - remove children of leaving device
   1714           *
   1715           * @return  none
   1716           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1717          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
   \                     ZDApp_LeaveUpdate:
   1718                                  uint8 removeChildren )
   1719          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EC           MOV     A,R4
   \   000006   FA           MOV     R2,A
   \   000007   ED           MOV     A,R5
   \   000008   FB           MOV     R3,A
   1720            /*
   1721            AddrMgrEntry_t entry;
   1722            */
   1723            (void)nwkAddr;  // Intentionally unreferenced parameter
   1724          
   1725            // Remove if child
   1726            if ( ZSTACK_ROUTER_BUILD )
   1727            {
   1728              NLME_RemoveChild( extAddr, removeChildren );
   \   000009                ; Setup parameters for call to function NLME_RemoveChild
   \   000009   12....       LCALL   ??NLME_RemoveChild?relay
   1729            }
   1730          
   1731            /*
   1732            // Set NWK address to invalid
   1733            entry.user    = ADDRMGR_USER_DEFAULT;
   1734            entry.nwkAddr = INVALID_NODE_ADDR;
   1735            AddrMgrExtAddrSet( entry.extAddr, extAddr );
   1736            AddrMgrEntryUpdate( &entry );
   1737          
   1738            // Check
   1739            if ( removeChildren == TRUE )
   1740            {
   1741              // Set index to INVALID_NODE_ADDR to start search
   1742              entry.index = INVALID_NODE_ADDR;
   1743          
   1744              // Get first entry
   1745              AddrMgrEntryGetNext( &entry );
   1746          
   1747              // Remove all descendents
   1748              while ( entry.index != INVALID_NODE_ADDR )
   1749              {
   1750                // Check NWK address allocation algorithm
   1751                if ( RTG_ANCESTOR( entry.nwkAddr, thisAddr ) != 0 )
   1752                {
   1753                  // Set NWK address to invalid
   1754                  entry.nwkAddr = INVALID_NODE_ADDR;
   1755                  AddrMgrEntryUpdate( &entry );
   1756                }
   1757          
   1758                // Get next entry
   1759                AddrMgrEntryGetNext( &entry );
   1760              }
   1761            }
   1762            */
   1763          }
   \   00000C   02....       LJMP    ??Subroutine7_0 & 0xFFFF
   1764          
   1765          /*********************************************************************
   1766           * CALLBACK FUNCTIONS
   1767           */
   1768          
   1769          
   1770          /*********************************************************************
   1771           * @fn      ZDApp_SendEventMsg()
   1772           *
   1773           * @brief
   1774           *
   1775           *   Sends a Network Join message
   1776           *
   1777           * @param  cmd - command ID
   1778           * @param  len - length (in bytes) of the buf field
   1779           * @param  buf - buffer for the rest of the message.
   1780           *
   1781           * @return  none
   1782           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1783          void ZDApp_SendEventMsg( uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendEventMsg:
   1784          {
   \   000000   74ED         MOV     A,#-0x13
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 6,R1
   \   000007   8A..         MOV     ?V0 + 5,R2
   \   000009   8C..         MOV     ?V0 + 2,R4
   \   00000B   8D..         MOV     ?V0 + 3,R5
   1785            ZDApp_SendMsg( ZDAppTaskID, cmd, len, buf );
   \   00000D   90....       MOV     DPTR,#ZDAppTaskID
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F5..         MOV     ?V0 + 4,A
   \   000013   8A82         MOV     DPL,R2
   \   000015   8582..       MOV     ?V0 + 0,DPL
   \   000018   75..00       MOV     ?V0 + 1,#0x0
   \   00001B                ; Setup parameters for call to function osal_msg_allocate
   \   00001B   AB..         MOV     R3,?V0 + 1
   \   00001D   12....       LCALL   ??osal_msg_allocate?relay
   \   000020   8A..         MOV     ?V0 + 8,R2
   \   000022   8B..         MOV     ?V0 + 9,R3
   \   000024   AE..         MOV     R6,?V0 + 8
   \   000026   AF..         MOV     R7,?V0 + 9
   \   000028   EE           MOV     A,R6
   \   000029   4F           ORL     A,R7
   \   00002A   6034         JZ      ??ZDApp_SendEventMsg_0
   \   00002C   E5..         MOV     A,?V0 + 5
   \   00002E   6020         JZ      ??ZDApp_SendEventMsg_1
   \   000030   E5..         MOV     A,?V0 + 2
   \   000032   45..         ORL     A,?V0 + 3
   \   000034   601A         JZ      ??ZDApp_SendEventMsg_1
   \   000036                ; Setup parameters for call to function osal_memcpy
   \   000036   85....       MOV     ?V0 + 8,?V0 + 2
   \   000039   85....       MOV     ?V0 + 9,?V0 + 3
   \   00003C   75..00       MOV     ?V0 + 10,#0x0
   \   00003F   78..         MOV     R0,#?V0 + 8
   \   000041   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000044   AC..         MOV     R4,?V0 + 0
   \   000046   AD..         MOV     R5,?V0 + 1
   \   000048   12....       LCALL   ??osal_memcpy?relay
   \   00004B   7403         MOV     A,#0x3
   \   00004D   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDApp_SendEventMsg_1:
   \   000050   8E82         MOV     DPL,R6
   \   000052   8F83         MOV     DPH,R7
   \   000054   E5..         MOV     A,?V0 + 6
   \   000056   F0           MOVX    @DPTR,A
   \   000057                ; Setup parameters for call to function osal_msg_send
   \   000057   EE           MOV     A,R6
   \   000058   FA           MOV     R2,A
   \   000059   EF           MOV     A,R7
   \   00005A   FB           MOV     R3,A
   \   00005B   A9..         MOV     R1,?V0 + 4
   \   00005D   12....       LCALL   ??osal_msg_send?relay
   1786          }
   \                     ??ZDApp_SendEventMsg_0:
   \   000060                REQUIRE ?Subroutine5
   \   000060                ; // Fall through to label ?Subroutine5

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   7F0B         MOV     R7,#0xb
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
   1787          
   1788          /*********************************************************************
   1789           * @fn      ZDApp_SendMsg()
   1790           *
   1791           * @brief   Sends a OSAL message
   1792           *
   1793           * @param  taskID - Where to send the message
   1794           * @param  cmd - command ID
   1795           * @param  len - length (in bytes) of the buf field
   1796           * @param  buf - buffer for the rest of the message.
   1797           *
   1798           * @return  none
   1799           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1800          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendMsg:
   1801          {
   \   000000   74ED         MOV     A,#-0x13
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 4,R1
   \   000007   8A..         MOV     ?V0 + 6,R2
   \   000009   8B..         MOV     ?V0 + 5,R3
   \   00000B   8C..         MOV     ?V0 + 2,R4
   \   00000D   8D..         MOV     ?V0 + 3,R5
   1802            osal_event_hdr_t *msgPtr;
   1803          
   1804            // Send the address to the task
   1805            msgPtr = (osal_event_hdr_t *)osal_msg_allocate( len );
   \   00000F   8B82         MOV     DPL,R3
   \   000011   8582..       MOV     ?V0 + 0,DPL
   \   000014   75..00       MOV     ?V0 + 1,#0x0
   \   000017                ; Setup parameters for call to function osal_msg_allocate
   \   000017   AA..         MOV     R2,?V0 + 0
   \   000019   AB..         MOV     R3,?V0 + 1
   \   00001B   12....       LCALL   ??osal_msg_allocate?relay
   \   00001E   8A..         MOV     ?V0 + 8,R2
   \   000020   8B..         MOV     ?V0 + 9,R3
   \   000022   AE..         MOV     R6,?V0 + 8
   \   000024   AF..         MOV     R7,?V0 + 9
   1806            if ( msgPtr )
   \   000026   EE           MOV     A,R6
   \   000027   4F           ORL     A,R7
   \   000028   6034         JZ      ??ZDApp_SendMsg_0
   1807            {
   1808              if ( (len > 0) && (buf != NULL) )
   \   00002A   E5..         MOV     A,?V0 + 5
   \   00002C   6020         JZ      ??ZDApp_SendMsg_1
   \   00002E   E5..         MOV     A,?V0 + 2
   \   000030   45..         ORL     A,?V0 + 3
   \   000032   601A         JZ      ??ZDApp_SendMsg_1
   1809                osal_memcpy( msgPtr, buf, len );
   \   000034                ; Setup parameters for call to function osal_memcpy
   \   000034   85....       MOV     ?V0 + 8,?V0 + 2
   \   000037   85....       MOV     ?V0 + 9,?V0 + 3
   \   00003A   75..00       MOV     ?V0 + 10,#0x0
   \   00003D   78..         MOV     R0,#?V0 + 8
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000042   AC..         MOV     R4,?V0 + 0
   \   000044   AD..         MOV     R5,?V0 + 1
   \   000046   12....       LCALL   ??osal_memcpy?relay
   \   000049   7403         MOV     A,#0x3
   \   00004B   12....       LCALL   ?DEALLOC_XSTACK8
   1810          
   1811              msgPtr->event = cmd;
   \                     ??ZDApp_SendMsg_1:
   \   00004E   8E82         MOV     DPL,R6
   \   000050   8F83         MOV     DPH,R7
   \   000052   E5..         MOV     A,?V0 + 6
   \   000054   F0           MOVX    @DPTR,A
   1812              osal_msg_send( taskID, (uint8 *)msgPtr );
   \   000055                ; Setup parameters for call to function osal_msg_send
   \   000055   EE           MOV     A,R6
   \   000056   FA           MOV     R2,A
   \   000057   EF           MOV     A,R7
   \   000058   FB           MOV     R3,A
   \   000059   A9..         MOV     R1,?V0 + 4
   \   00005B   12....       LCALL   ??osal_msg_send?relay
   1813            }
   1814          }
   \                     ??ZDApp_SendMsg_0:
   \   00005E   80..         SJMP    ?Subroutine5
   1815          
   1816          /*********************************************************************
   1817           * Call Back Functions from NWK  - API
   1818           */
   1819          
   1820          /*********************************************************************
   1821           * @fn          ZDO_NetworkDiscoveryConfirmCB
   1822           *
   1823           * @brief       This function returns a choice of PAN to join.
   1824           *
   1825           * @param       ResultCount - Number of routers discovered
   1826           * @param               NetworkList - Pointer to list of network descriptors
   1827           *
   1828           * @return      ZStatus_t
   1829           */
   1830          #define STACK_PROFILE_MAX 2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1831          ZStatus_t ZDO_NetworkDiscoveryConfirmCB( uint8 ResultCount,
   \                     ZDO_NetworkDiscoveryConfirmCB:
   1832                                                   networkDesc_t *NetworkList )
   1833          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 14
   \   000005   74F2         MOV     A,#-0xe
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   89..         MOV     ?V0 + 0,R1
   \   00000C   8A..         MOV     ?V0 + 2,R2
   \   00000E   8B..         MOV     ?V0 + 3,R3
   1834            networkDesc_t *pNwkDesc = NetworkList;
   1835            ZDO_NetworkDiscoveryCfm_t msg;
   1836            uint8 i = ResultCount;
   1837            uint8 stackProfile;
   1838            uint8 stackProfilePro;
   1839            uint8 selected;
   1840          
   1841          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   1842            if ( zdappMgmtNwkDiscReqInProgress )
   1843            {
   1844              zdappMgmtNwkDiscReqInProgress = false;
   1845              ZDO_FinishProcessingMgmtNwkDiscReq( ResultCount, NetworkList );
   1846              return ( ZSuccess );
   1847            }
   1848          #endif
   1849          
   1850            // process discovery results
   1851            stackProfilePro = FALSE;
   \   000010   75..00       MOV     ?V0 + 4,#0x0
   1852            selected = FALSE;
   1853          
   1854            for ( stackProfile = 0; stackProfile < STACK_PROFILE_MAX; stackProfile++ )
   \   000013   75..00       MOV     ?V0 + 1,#0x0
   1855            {
   1856              pNwkDesc = NetworkList;
   \                     ??ZDO_NetworkDiscoveryConfirmCB_0:
   \   000016   AE..         MOV     R6,?V0 + 2
   \   000018   AF..         MOV     R7,?V0 + 3
   1857              for ( i = 0; i < ResultCount; i++, pNwkDesc = pNwkDesc->nextDesc )
   \   00001A   75..00       MOV     ?V0 + 5,#0x0
   \   00001D   E5..         MOV     A,?V0 + 0
   \   00001F   7003         JNZ     $+5
   \   000021   02....       LJMP    ??ZDO_NetworkDiscoveryConfirmCB_1 & 0xFFFF
   1858              {
   1859                if ( zgConfigPANID != 0xFFFF )
   \                     ??ZDO_NetworkDiscoveryConfirmCB_2:
   \   000024   90....       MOV     DPTR,#zgConfigPANID
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F4           CPL     A
   \   000029   7003         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_3
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F4           CPL     A
   \                     ??ZDO_NetworkDiscoveryConfirmCB_3:
   \   00002E   6015         JZ      ??ZDO_NetworkDiscoveryConfirmCB_4
   1860                {
   1861                  // PAN Id is preconfigured. check if it matches
   1862                  if ( pNwkDesc->panId != zgConfigPANID )
   \   000030   8E82         MOV     DPL,R6
   \   000032   8F83         MOV     DPH,R7
   \   000034   E0           MOVX    A,@DPTR
   \   000035   F8           MOV     R0,A
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   F9           MOV     R1,A
   \   000039   90....       MOV     DPTR,#zgConfigPANID
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   68           XRL     A,R0
   \   00003E   7003         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_5
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   69           XRL     A,R1
   \                     ??ZDO_NetworkDiscoveryConfirmCB_5:
   \   000043   707A         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_6
   1863                    continue;
   1864                }
   1865                
   1866          
   1867                if ( nwk_ExtPANIDValid( ZDO_UseExtendedPANID) == true ) 
   \                     ??ZDO_NetworkDiscoveryConfirmCB_4:
   \   000045                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000045   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000047   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000049   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   00004C   E9           MOV     A,R1
   \   00004D   6401         XRL     A,#0x1
   \   00004F   7012         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_7
   1868                {
   1869                  // If the extended Pan ID is commissioned to a non zero value
   1870                  // Only join the Pan that has match EPID
   1871                  if ( osal_ExtAddrEqual( ZDO_UseExtendedPANID, pNwkDesc->extendedPANID) == false )
   \   000051                ; Setup parameters for call to function sAddrExtCmp
   \   000051   EE           MOV     A,R6
   \   000052   240D         ADD     A,#0xd
   \   000054   FC           MOV     R4,A
   \   000055   EF           MOV     A,R7
   \   000056   3400         ADDC    A,#0x0
   \   000058   FD           MOV     R5,A
   \   000059   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   00005B   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   00005D   12....       LCALL   ??sAddrExtCmp?relay
   \   000060   E9           MOV     A,R1
   \   000061   605C         JZ      ??ZDO_NetworkDiscoveryConfirmCB_6
   1872                    continue;
   1873                  
   1874                }
   1875          
   1876          
   1877                  // check that network is allowing joining
   1878                  if ( ZSTACK_ROUTER_BUILD )
   1879                  {
   1880                    if ( stackProfilePro == FALSE )
   \                     ??ZDO_NetworkDiscoveryConfirmCB_7:
   \   000063   E5..         MOV     A,?V0 + 4
   \   000065   8E82         MOV     DPL,R6
   \   000067   8F83         MOV     DPH,R7
   \   000069   A3           INC     DPTR
   \   00006A   A3           INC     DPTR
   \   00006B   A3           INC     DPTR
   \   00006C   A3           INC     DPTR
   \   00006D   A3           INC     DPTR
   \   00006E   7005         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_8
   1881                    {
   1882                      if ( !pNwkDesc->routerCapacity )
   \   000070   E0           MOVX    A,@DPTR
   \   000071   7006         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_9
   \   000073   804A         SJMP    ??ZDO_NetworkDiscoveryConfirmCB_6
   1883                      {
   1884                        continue;
   1885                      }
   1886                    }
   1887                    else
   1888                    {
   1889                      if ( !pNwkDesc->deviceCapacity )
   \                     ??ZDO_NetworkDiscoveryConfirmCB_8:
   \   000075   A3           INC     DPTR
   \   000076   E0           MOVX    A,@DPTR
   \   000077   6046         JZ      ??ZDO_NetworkDiscoveryConfirmCB_6
   1890                      {
   1891                        continue;
   1892                      }
   1893                    }
   1894                  }
   1895                  else if ( ZSTACK_END_DEVICE_BUILD )
   1896                  {
   1897                    if ( !pNwkDesc->deviceCapacity )
   1898                    {
   1899                      continue;
   1900                    }
   1901                  }
   1902          
   1903                  // check version of zigbee protocol
   1904                  if ( pNwkDesc->version != _NIB.nwkProtocolVersion )
   \                     ??ZDO_NetworkDiscoveryConfirmCB_9:
   \   000079   8E82         MOV     DPL,R6
   \   00007B   8F83         MOV     DPH,R7
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   A3           INC     DPTR
   \   000080   A3           INC     DPTR
   \   000081   A3           INC     DPTR
   \   000082   A3           INC     DPTR
   \   000083   A3           INC     DPTR
   \   000084   E0           MOVX    A,@DPTR
   \   000085   F8           MOV     R0,A
   \   000086   90....       MOV     DPTR,#_NIB + 17
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   68           XRL     A,R0
   \   00008B   7032         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_6
   1905                    continue;
   1906          
   1907                  // check version of stack profile
   1908                  if ( pNwkDesc->stackProfile != zgStackProfile  )
   \   00008D   8E82         MOV     DPL,R6
   \   00008F   8F83         MOV     DPH,R7
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   A3           INC     DPTR
   \   000097   A3           INC     DPTR
   \   000098   A3           INC     DPTR
   \   000099   E0           MOVX    A,@DPTR
   \   00009A   F8           MOV     R0,A
   \   00009B   90....       MOV     DPTR,#zgStackProfile
   \   00009E   E0           MOVX    A,@DPTR
   \   00009F   68           XRL     A,R0
   \   0000A0   6038         JZ      ??ZDO_NetworkDiscoveryConfirmCB_10
   1909                  {
   1910                    if ( ((zgStackProfile == HOME_CONTROLS) && (pNwkDesc->stackProfile == ZIGBEEPRO_PROFILE)) 
   1911                        || ((zgStackProfile == ZIGBEEPRO_PROFILE) && (pNwkDesc->stackProfile == HOME_CONTROLS))  )
   \   0000A2   E0           MOVX    A,@DPTR
   \   0000A3   6401         XRL     A,#0x1
   \   0000A5   7007         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_11
   \   0000A7   7402         MOV     A,#0x2
   \   0000A9   68           XRL     A,R0
   \   0000AA   700F         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_12
   \   0000AC   800A         SJMP    ??ZDO_NetworkDiscoveryConfirmCB_13
   \                     ??ZDO_NetworkDiscoveryConfirmCB_11:
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   6402         XRL     A,#0x2
   \   0000B1   7008         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_12
   \   0000B3   7401         MOV     A,#0x1
   \   0000B5   68           XRL     A,R0
   \   0000B6   7003         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_12
   1912                      stackProfilePro = TRUE;
   \                     ??ZDO_NetworkDiscoveryConfirmCB_13:
   \   0000B8   75..01       MOV     ?V0 + 4,#0x1
   1913                    
   1914                    if ( stackProfile == 0 )
   \                     ??ZDO_NetworkDiscoveryConfirmCB_12:
   \   0000BB   E5..         MOV     A,?V0 + 1
   \   0000BD   701B         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_10
   1915                    {
   1916                      continue;
   1917                    }
   1918                  }
   1919          
   1920                // check if beacon order is the right value..
   1921                //  if ( pNwkDesc->beaconOrder < ZDO_CONFIG_MAX_BO )
   1922                //    continue;
   1923          
   1924                // choose this pan for joining
   1925                break;
   1926              } 
   \                     ??ZDO_NetworkDiscoveryConfirmCB_6:
   \   0000BF   05..         INC     ?V0 + 5
   \   0000C1   EE           MOV     A,R6
   \   0000C2   2416         ADD     A,#0x16
   \   0000C4   F582         MOV     DPL,A
   \   0000C6   EF           MOV     A,R7
   \   0000C7   3400         ADDC    A,#0x0
   \   0000C9   F583         MOV     DPH,A
   \   0000CB   E0           MOVX    A,@DPTR
   \   0000CC   FE           MOV     R6,A
   \   0000CD   A3           INC     DPTR
   \   0000CE   E0           MOVX    A,@DPTR
   \   0000CF   FF           MOV     R7,A
   \   0000D0   E5..         MOV     A,?V0 + 5
   \   0000D2   C3           CLR     C
   \   0000D3   95..         SUBB    A,?V0 + 0
   \   0000D5   5003         JNC     $+5
   \   0000D7   02....       LJMP    ??ZDO_NetworkDiscoveryConfirmCB_2 & 0xFFFF
   1927              if (i < ResultCount)
   \                     ??ZDO_NetworkDiscoveryConfirmCB_10:
   \   0000DA   E5..         MOV     A,?V0 + 5
   \   0000DC   C3           CLR     C
   \   0000DD   95..         SUBB    A,?V0 + 0
   \   0000DF   4010         JC      ??ZDO_NetworkDiscoveryConfirmCB_14
   1928              {
   1929               selected = TRUE;
   1930                break;
   1931              }
   1932             
   1933              // break if selected or stack profile pro wasn't found
   1934              if ( (selected == TRUE) || (stackProfilePro == FALSE) )
   \                     ??ZDO_NetworkDiscoveryConfirmCB_1:
   \   0000E1   E5..         MOV     A,?V0 + 4
   \   0000E3   600C         JZ      ??ZDO_NetworkDiscoveryConfirmCB_14
   1935              {
   1936                break;
   1937              }
   1938            }
   \   0000E5   05..         INC     ?V0 + 1
   \   0000E7   E5..         MOV     A,?V0 + 1
   \   0000E9   C3           CLR     C
   \   0000EA   9402         SUBB    A,#0x2
   \   0000EC   5003         JNC     $+5
   \   0000EE   02....       LJMP    ??ZDO_NetworkDiscoveryConfirmCB_0 & 0xFFFF
   1939          
   1940            if ( i == ResultCount )
   \                     ??ZDO_NetworkDiscoveryConfirmCB_14:
   \   0000F1   E5..         MOV     A,?V0 + 0
   \   0000F3   65..         XRL     A,?V0 + 5
   \   0000F5   700A         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_15
   1941            {
   1942              msg.hdr.status = ZDO_FAIL;   // couldn't find appropriate PAN to join !
   \   0000F7   7401         MOV     A,#0x1
   \   0000F9   12....       LCALL   ?XSTACK_DISP0_8
   \   0000FC   7401         MOV     A,#0x1
   \   0000FE   F0           MOVX    @DPTR,A
   \   0000FF   8061         SJMP    ??ZDO_NetworkDiscoveryConfirmCB_16
   1943            }
   1944            else
   1945            {
   1946              msg.hdr.status = ZDO_SUCCESS;
   \                     ??ZDO_NetworkDiscoveryConfirmCB_15:
   \   000101   7401         MOV     A,#0x1
   \   000103   12....       LCALL   ?XSTACK_DISP0_8
   \   000106   E4           CLR     A
   \   000107   F0           MOVX    @DPTR,A
   1947              msg.panIdLSB = LO_UINT16( pNwkDesc->panId );
   \   000108   8E82         MOV     DPL,R6
   \   00010A   8F83         MOV     DPH,R7
   \   00010C   E0           MOVX    A,@DPTR
   \   00010D   C0E0         PUSH    A
   \   00010F   7402         MOV     A,#0x2
   \   000111   12....       LCALL   ?XSTACK_DISP0_8
   \   000114   D0E0         POP     A
   \   000116   F0           MOVX    @DPTR,A
   1948              msg.panIdMSB = HI_UINT16( pNwkDesc->panId );
   \   000117   8E82         MOV     DPL,R6
   \   000119   8F83         MOV     DPH,R7
   \   00011B   A3           INC     DPTR
   \   00011C   E0           MOVX    A,@DPTR
   \   00011D   C0E0         PUSH    A
   \   00011F   7403         MOV     A,#0x3
   \   000121   12....       LCALL   ?XSTACK_DISP0_8
   \   000124   D0E0         POP     A
   \   000126   F0           MOVX    @DPTR,A
   1949              msg.logicalChannel = pNwkDesc->logicalChannel;
   \   000127   8E82         MOV     DPL,R6
   \   000129   8F83         MOV     DPH,R7
   \   00012B   A3           INC     DPTR
   \   00012C   A3           INC     DPTR
   \   00012D   E0           MOVX    A,@DPTR
   \   00012E   C0E0         PUSH    A
   \   000130   7404         MOV     A,#0x4
   \   000132   12....       LCALL   ?XSTACK_DISP0_8
   \   000135   D0E0         POP     A
   \   000137   F0           MOVX    @DPTR,A
   1950              msg.version = pNwkDesc->version;
   \   000138   8E82         MOV     DPL,R6
   \   00013A   8F83         MOV     DPH,R7
   \   00013C   A3           INC     DPTR
   \   00013D   A3           INC     DPTR
   \   00013E   A3           INC     DPTR
   \   00013F   A3           INC     DPTR
   \   000140   A3           INC     DPTR
   \   000141   A3           INC     DPTR
   \   000142   A3           INC     DPTR
   \   000143   E0           MOVX    A,@DPTR
   \   000144   C0E0         PUSH    A
   \   000146   7405         MOV     A,#0x5
   \   000148   12....       LCALL   ?XSTACK_DISP0_8
   \   00014B   D0E0         POP     A
   \   00014D   F0           MOVX    @DPTR,A
   1951              osal_cpyExtAddr( msg.extendedPANID, pNwkDesc->extendedPANID );
   \   00014E                ; Setup parameters for call to function sAddrExtCpy
   \   00014E   EE           MOV     A,R6
   \   00014F   240D         ADD     A,#0xd
   \   000151   FC           MOV     R4,A
   \   000152   EF           MOV     A,R7
   \   000153   3400         ADDC    A,#0x0
   \   000155   FD           MOV     R5,A
   \   000156   7406         MOV     A,#0x6
   \   000158   12....       LCALL   ?XSTACK_DISP0_8
   \   00015B   AA82         MOV     R2,DPL
   \   00015D   AB83         MOV     R3,DPH
   \   00015F   12....       LCALL   ??sAddrExtCpy?relay
   1952            }
   1953          
   1954            ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_DISC_CNF, sizeof(ZDO_NetworkDiscoveryCfm_t), (uint8 *)&msg );
   \                     ??ZDO_NetworkDiscoveryConfirmCB_16:
   \   000162   90....       MOV     DPTR,#ZDAppTaskID
   \   000165   E0           MOVX    A,@DPTR
   \   000166   F5..         MOV     ?V0 + 1,A
   \   000168                ; Setup parameters for call to function osal_msg_allocate
   \   000168   7A0E         MOV     R2,#0xe
   \   00016A   7B00         MOV     R3,#0x0
   \   00016C   12....       LCALL   ??osal_msg_allocate?relay
   \   00016F   8A..         MOV     ?V0 + 2,R2
   \   000171   8B..         MOV     ?V0 + 3,R3
   \   000173   AE..         MOV     R6,?V0 + 2
   \   000175   AF..         MOV     R7,?V0 + 3
   \   000177   EE           MOV     A,R6
   \   000178   4F           ORL     A,R7
   \   000179   6034         JZ      ??ZDO_NetworkDiscoveryConfirmCB_17
   \   00017B                ; Setup parameters for call to function osal_memcpy
   \   00017B   85..82       MOV     DPL,?XSP + 0
   \   00017E   85..83       MOV     DPH,?XSP + 1
   \   000181   A982         MOV     R1,DPL
   \   000183   AA83         MOV     R2,DPH
   \   000185   89..         MOV     ?V0 + 4,R1
   \   000187   8A..         MOV     ?V0 + 5,R2
   \   000189   75..00       MOV     ?V0 + 6,#0x0
   \   00018C   78..         MOV     R0,#?V0 + 4
   \   00018E   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000191   7C0E         MOV     R4,#0xe
   \   000193   7D00         MOV     R5,#0x0
   \   000195   EE           MOV     A,R6
   \   000196   FA           MOV     R2,A
   \   000197   12....       LCALL   ??osal_memcpy?relay
   \   00019A   7403         MOV     A,#0x3
   \   00019C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00019F   8E82         MOV     DPL,R6
   \   0001A1   8F83         MOV     DPH,R7
   \   0001A3   7401         MOV     A,#0x1
   \   0001A5   F0           MOVX    @DPTR,A
   \   0001A6                ; Setup parameters for call to function osal_msg_send
   \   0001A6   EE           MOV     A,R6
   \   0001A7   FA           MOV     R2,A
   \   0001A8   EF           MOV     A,R7
   \   0001A9   FB           MOV     R3,A
   \   0001AA   A9..         MOV     R1,?V0 + 1
   \   0001AC   12....       LCALL   ??osal_msg_send?relay
   1955          
   1956            return (ZSuccess);
   \                     ??ZDO_NetworkDiscoveryConfirmCB_17:
   \   0001AF   7900         MOV     R1,#0x0
   \   0001B1   740E         MOV     A,#0xe
   \   0001B3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001B6   7F07         MOV     R7,#0x7
   \   0001B8   02....       LJMP    ?BANKED_LEAVE_XDATA
   1957          }  // ZDO_NetworkDiscoveryConfirmCB
   1958          
   1959          /*********************************************************************
   1960           * @fn          ZDO_NetworkFormationConfirmCB
   1961           *
   1962           * @brief       This function reports the results of the request to
   1963           *              initialize a coordinator in a network.
   1964           *
   1965           * @param       Status - Result of NLME_NetworkFormationRequest()
   1966           *
   1967           * @return      none
   1968           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   90....       MOV     DPTR,#ZDAppTaskID
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   12....       LCALL   ??osal_set_event?relay
   \   00000A                REQUIRE ??Subroutine7_0
   \   00000A                ; // Fall through to label ??Subroutine7_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1969          void ZDO_NetworkFormationConfirmCB( ZStatus_t Status )
   \                     ZDO_NetworkFormationConfirmCB:
   1970          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   1971            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   1972          
   1973            if ( Status == ZSUCCESS )
   \   00000A   7019         JNZ     ??ZDO_NetworkFormationConfirmCB_0
   1974            {
   1975              // LED on shows Coordinator started
   1976              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   7A01         MOV     R2,#0x1
   \   00000E   7904         MOV     R1,#0x4
   \   000010   12....       LCALL   ??HalLedSet?relay
   1977          
   1978              // LED off forgets HOLD_AUTO_START
   1979              HalLedSet (HAL_LED_4, HAL_LED_MODE_OFF);
   \   000013                ; Setup parameters for call to function HalLedSet
   \   000013   7A00         MOV     R2,#0x0
   \   000015   7908         MOV     R1,#0x8
   \   000017   12....       LCALL   ??HalLedSet?relay
   1980          
   1981          #if defined ( ZBIT )
   1982              SIM_SetColor(0xd0ffd0);
   1983          #endif
   1984          
   1985              if ( devState == DEV_HOLD )
   \   00001A   90....       MOV     DPTR,#devState
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   700C         JNZ     ??ZDO_NetworkFormationConfirmCB_1
   1986              {
   1987                // Began with HOLD_AUTO_START
   1988                devState = DEV_COORD_STARTING;
   \   000020   7408         MOV     A,#0x8
   \   000022   F0           MOVX    @DPTR,A
   \   000023   8007         SJMP    ??ZDO_NetworkFormationConfirmCB_1
   1989              }
   1990            }
   1991          #if defined(BLINK_LEDS)
   1992            else
   1993              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_NetworkFormationConfirmCB_0:
   \   000025                ; Setup parameters for call to function HalLedSet
   \   000025   7A04         MOV     R2,#0x4
   \   000027   7904         MOV     R1,#0x4
   \   000029   12....       LCALL   ??HalLedSet?relay
   1994          #endif
   1995          
   1996            osal_set_event( ZDAppTaskID, ZDO_NETWORK_START );
   \                     ??ZDO_NetworkFormationConfirmCB_1:
   \   00002C                ; Setup parameters for call to function osal_set_event
   \   00002C   7A02         MOV     R2,#0x2
   \   00002E   02....       LJMP    ?Subroutine0 & 0xFFFF
   1997          }
   1998          
   1999          /*********************************************************************
   2000           * @fn          ZDO_StartRouterConfirmCB
   2001           *
   2002           * @brief       This function reports the results of the request to
   2003           *              start functioning as a router in a network.
   2004           *
   2005           * @param       Status - Result of NLME_StartRouterRequest()
   2006           *
   2007           * @return      none
   2008           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2009          void ZDO_StartRouterConfirmCB( ZStatus_t Status )
   \                     ZDO_StartRouterConfirmCB:
   2010          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2011            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2012          
   2013            if ( Status == ZSUCCESS )
   \   00000A   7019         JNZ     ??ZDO_StartRouterConfirmCB_0
   2014            {
   2015              // LED on shows Router started
   2016              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   7A01         MOV     R2,#0x1
   \   00000E   7904         MOV     R1,#0x4
   \   000010   12....       LCALL   ??HalLedSet?relay
   2017              // LED off forgets HOLD_AUTO_START
   2018              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   \   000013                ; Setup parameters for call to function HalLedSet
   \   000013   7A00         MOV     R2,#0x0
   \   000015   7908         MOV     R1,#0x8
   \   000017   12....       LCALL   ??HalLedSet?relay
   2019              if ( devState == DEV_HOLD )
   \   00001A   90....       MOV     DPTR,#devState
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   700C         JNZ     ??ZDO_StartRouterConfirmCB_1
   2020              {
   2021                // Began with HOLD_AUTO_START
   2022                devState = DEV_END_DEVICE;
   \   000020   7406         MOV     A,#0x6
   \   000022   F0           MOVX    @DPTR,A
   \   000023   8007         SJMP    ??ZDO_StartRouterConfirmCB_1
   2023              }
   2024            }
   2025          #if defined(BLINK_LEDS)
   2026            else
   2027              HalLedSet( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_StartRouterConfirmCB_0:
   \   000025                ; Setup parameters for call to function HalLedSet
   \   000025   7A04         MOV     R2,#0x4
   \   000027   7904         MOV     R1,#0x4
   \   000029   12....       LCALL   ??HalLedSet?relay
   2028          #endif
   2029          
   2030            osal_set_event( ZDAppTaskID, ZDO_ROUTER_START );
   \                     ??ZDO_StartRouterConfirmCB_1:
   \   00002C                ; Setup parameters for call to function osal_set_event
   \   00002C   7A20         MOV     R2,#0x20
   \   00002E   02....       LJMP    ?Subroutine0 & 0xFFFF
   2031          }
   2032          
   2033          /*********************************************************************
   2034           * @fn          ZDO_JoinConfirmCB
   2035           *
   2036           * @brief       This function allows the next hight layer to be notified
   2037           *              of the results of its request to join itself or another
   2038           *              device to a network.
   2039           *
   2040           * @param       Status - Result of NLME_JoinRequest()
   2041           *
   2042           * @return      none
   2043           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2044          void ZDO_JoinConfirmCB( uint16 PanId, ZStatus_t Status )
   \                     ZDO_JoinConfirmCB:
   2045          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2046            (void)PanId;  // remove if this parameter is used.
   2047            
   2048            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2049          
   2050            if ( Status == ZSUCCESS )
   \   00000A   7019         JNZ     ??ZDO_JoinConfirmCB_0
   2051            {
   2052              // LED on shows device joined
   2053              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   7A01         MOV     R2,#0x1
   \   00000E   7904         MOV     R1,#0x4
   \   000010   12....       LCALL   ??HalLedSet?relay
   2054              // LED off forgets HOLD_AUTO_START
   2055              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   \   000013                ; Setup parameters for call to function HalLedSet
   \   000013   7A00         MOV     R2,#0x0
   \   000015   7908         MOV     R1,#0x8
   \   000017   12....       LCALL   ??HalLedSet?relay
   2056              if ( (devState == DEV_HOLD) )
   \   00001A   90....       MOV     DPTR,#devState
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   700C         JNZ     ??ZDO_JoinConfirmCB_1
   2057              {
   2058                // Began with HOLD_AUTO_START
   2059                devState = DEV_NWK_JOINING;
   \   000020   7403         MOV     A,#0x3
   \   000022   F0           MOVX    @DPTR,A
   \   000023   8007         SJMP    ??ZDO_JoinConfirmCB_1
   2060              }
   2061          
   2062              if ( !ZG_SECURE_ENABLED )
   2063              {
   2064                // Notify to save info into NV
   2065                ZDApp_NVUpdate();
   2066              }
   2067            }
   2068            else
   2069            {
   2070          #if defined(BLINK_LEDS)
   2071              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_JoinConfirmCB_0:
   \   000025                ; Setup parameters for call to function HalLedSet
   \   000025   7A04         MOV     R2,#0x4
   \   000027   7904         MOV     R1,#0x4
   \   000029   12....       LCALL   ??HalLedSet?relay
   2072          #endif
   2073            }
   2074          
   2075            // Notify ZDApp
   2076            ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_IND, sizeof(osal_event_hdr_t), (byte*)NULL );
   \                     ??ZDO_JoinConfirmCB_1:
   \   00002C   90....       MOV     DPTR,#ZDAppTaskID
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   FE           MOV     R6,A
   \   000031                ; Setup parameters for call to function osal_msg_allocate
   \   000031   7A02         MOV     R2,#0x2
   \   000033   7B00         MOV     R3,#0x0
   \   000035   12....       LCALL   ??osal_msg_allocate?relay
   \   000038   8A82         MOV     DPL,R2
   \   00003A   8B83         MOV     DPH,R3
   \   00003C   E582         MOV     A,DPL
   \   00003E   4583         ORL     A,DPH
   \   000040   6008         JZ      ??ZDO_JoinConfirmCB_2
   \   000042   7402         MOV     A,#0x2
   \   000044   F0           MOVX    @DPTR,A
   \   000045                ; Setup parameters for call to function osal_msg_send
   \   000045   EE           MOV     A,R6
   \   000046   F9           MOV     R1,A
   \   000047   12....       LCALL   ??osal_msg_send?relay
   2077          }
   \                     ??ZDO_JoinConfirmCB_2:
   \   00004A   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   2078          
   2079          /*********************************************************************
   2080           * @fn          ZDO_AddrChangeIndicationCB
   2081           *
   2082           * @brief       This function notifies the application that this
   2083           *              device's address has changed.  Could happen in 
   2084           *              a network with stochastic addressing (PRO).
   2085           *
   2086           * @param       newAddr - the new address
   2087           *
   2088           * @return      none
   2089           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7A00         MOV     R2,#0x0
   \   000002   7B00         MOV     R3,#0x0
   \   000004   12....       LCALL   ??APSME_HoldDataRequests?relay
   \   000007                ; Setup parameters for call to function NLME_GetExtAddr
   \   000007                ; Setup parameters for call to function NLME_GetExtAddr
   \   000007   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   AE..         MOV     R6,?V0 + 0
   \   000010                ; Setup parameters for call to function NLME_GetShortAddr
   \   000010                ; Setup parameters for call to function NLME_GetShortAddr
   \   000010   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000013                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   000013                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   000013   75..00       MOV     ?V0 + 0,#0x0
   \   000016   78..         MOV     R0,#?V0 + 0
   \   000018   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00001B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F9           MOV     R1,A
   \   000020   EE           MOV     A,R6
   \   000021   FC           MOV     R4,A
   \   000022   AD..         MOV     R5,?V0 + 1
   \   000024   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   000027   7401         MOV     A,#0x1
   \   000029   12....       LCALL   ?DEALLOC_XSTACK8
   \   00002C                ; Setup parameters for call to function APSME_HoldDataRequests
   \   00002C                ; Setup parameters for call to function APSME_HoldDataRequests
   \   00002C   7A00         MOV     R2,#0x0
   \   00002E   7B00         MOV     R3,#0x0
   \   000030   12....       LCALL   ??APSME_HoldDataRequests?relay
   \   000033                REQUIRE ??Subroutine10_0
   \   000033                ; // Fall through to label ??Subroutine10_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2090          void ZDO_AddrChangeIndicationCB( uint16 newAddr )
   \                     ZDO_AddrChangeIndicationCB:
   2091          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2092            (void)newAddr;  // remove if this parameter is used
   2093            
   2094            // Notify to save info into NV
   2095            ZDApp_NVUpdate();
   2096          
   2097            // Notify the applications   
   2098            osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000005                ; Setup parameters for call to function osal_set_event
   \   000005   7A10         MOV     R2,#0x10
   \   000007   7B00         MOV     R3,#0x0
   \   000009   90....       MOV     DPTR,#ZDAppTaskID
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   F9           MOV     R1,A
   \   00000E   12....       LCALL   ??osal_set_event?relay
   2099          
   2100            // Send out a device announce
   2101            ZDApp_AnnounceNewAddress();
   \   000011                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000011   02....       LJMP    ?Subroutine1 & 0xFFFF
   2102          }
   2103          
   2104          /*********************************************************************
   2105           * @fn          ZDO_JoinIndicationCB
   2106           *
   2107           * @brief       This function allows the next higher layer of a
   2108           *              coordinator to be notified of a remote join request.
   2109           *
   2110           * @param       ShortAddress - 16-bit address
   2111           * @param       ExtendedAddress - IEEE (64-bit) address
   2112           * @param       CapabilityInformation - Association Capability Information
   2113           * @param       type - of joining - 
   2114           *                          NWK_ASSOC_JOIN
   2115           *                          NWK_ASSOC_REJOIN_UNSECURE
   2116           *                          NWK_ASSOC_REJOIN_SECURE
   2117           *
   2118           * @return      ZStatus_t
   2119           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2120          ZStatus_t ZDO_JoinIndicationCB( uint16 ShortAddress, uint8 *ExtendedAddress,
   \                     ZDO_JoinIndicationCB:
   2121                                          uint8 CapabilityInformation, uint8 type )
   2122          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2123            (void)ShortAddress;
   2124            (void)ExtendedAddress;
   2125            (void)CapabilityInformation;
   2126            
   2127              // Notify to save info into NV
   2128              ZDApp_NVUpdate();
   2129            
   2130              // send notification to TC of new device..
   2131              if ( ZG_SECURE_ENABLED )
   2132              {
   2133                if ( type == NWK_ASSOC_JOIN || type == NWK_ASSOC_REJOIN_UNSECURE )
   2134                {
   2135                  osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 600 );
   2136                }
   2137              }
   2138            
   2139              return ( ZSuccess );
   \   000000                REQUIRE ?Subroutine4
   \   000000                ; // Fall through to label ?Subroutine4

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7900         MOV     R1,#0x0
   \   000002   02....       LJMP    ?BRET
   2140          }
   2141          
   2142          /*********************************************************************
   2143           * @fn          ZDO_ConcentratorIndicationCB
   2144           *
   2145           * @brief       This function allows the next higher layer of a
   2146           *              device to be notified of existence of the concentrator.
   2147           *
   2148           * @param       nwkAddr - 16-bit NWK address of the concentrator
   2149           *
   2150           * @return      void 
   2151           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2152          void ZDO_ConcentratorIndicationCB( uint16 nwkAddr )
   \                     ZDO_ConcentratorIndicationCB:
   2153          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2154            // Write your code here to do something with the concentrator's
   2155            // address.
   2156            (void)nwkAddr;
   2157          }
   \   000000   02....       LJMP    ?BRET
   2158          
   2159          /*********************************************************************
   2160           * @fn          ZDO_LeaveCnf
   2161           *
   2162           * @brief       This function allows the next higher layer to be
   2163           *              notified of the results of its request for this or
   2164           *              a child device to leave the network.
   2165           *
   2166           * @param       cnf - NLME_LeaveCnf_t
   2167           *
   2168           * @return      none
   2169           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2170          void ZDO_LeaveCnf( NLME_LeaveCnf_t* cnf )
   \                     ZDO_LeaveCnf:
   2171          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2172            // Check for this device
   2173            if ( osal_ExtAddrEqual( cnf->extAddr,
   2174                                    NLME_GetExtAddr() ) == TRUE )
   \   000009   EE           MOV     A,R6
   \   00000A   2402         ADD     A,#0x2
   \   00000C   F5..         MOV     ?V0 + 0,A
   \   00000E   EF           MOV     A,R7
   \   00000F   3400         ADDC    A,#0x0
   \   000011   F5..         MOV     ?V0 + 1,A
   \   000013                ; Setup parameters for call to function sAddrExtCmp
   \   000013                ; Setup parameters for call to function NLME_GetExtAddr
   \   000013   12....       LCALL   ??NLME_GetExtAddr?relay
   \   000016   EA           MOV     A,R2
   \   000017   FC           MOV     R4,A
   \   000018   EB           MOV     A,R3
   \   000019   FD           MOV     R5,A
   \   00001A   AA..         MOV     R2,?V0 + 0
   \   00001C   AB..         MOV     R3,?V0 + 1
   \   00001E   12....       LCALL   ??sAddrExtCmp?relay
   \   000021   E9           MOV     A,R1
   \   000022   6401         XRL     A,#0x1
   \   000024   7050         JNZ     ??ZDO_LeaveCnf_0
   2175            {
   2176              // Prepare to leave with reset
   2177              ZDApp_LeaveReset( cnf->rejoin );
   \   000026   EE           MOV     A,R6
   \   000027   240B         ADD     A,#0xb
   \   000029   F582         MOV     DPL,A
   \   00002B   EF           MOV     A,R7
   \   00002C   3400         ADDC    A,#0x0
   \   00002E   F583         MOV     DPH,A
   \   000030   E0           MOVX    A,@DPTR
   \   000031   F8           MOV     R0,A
   \   000032   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000035   7401         MOV     A,#0x1
   \   000037   F0           MOVX    @DPTR,A
   \   000038   68           XRL     A,R0
   \   000039   7003         JNZ     ??ZDO_LeaveCnf_1
   \   00003B   7403         MOV     A,#0x3
   \   00003D   F0           MOVX    @DPTR,A
   \                     ??ZDO_LeaveCnf_1:
   \   00003E                ; Setup parameters for call to function osal_nv_write
   \   00003E   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000041   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000044   78..         MOV     R0,#?V0 + 0
   \   000046   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000049   75..01       MOV     ?V0 + 0,#0x1
   \   00004C   75..00       MOV     ?V0 + 1,#0x0
   \   00004F   78..         MOV     R0,#?V0 + 0
   \   000051   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000054   7C00         MOV     R4,#0x0
   \   000056   7D00         MOV     R5,#0x0
   \   000058   7A85         MOV     R2,#-0x7b
   \   00005A   7B00         MOV     R3,#0x0
   \   00005C   12....       LCALL   ??osal_nv_write?relay
   \   00005F   7404         MOV     A,#0x4
   \   000061   12....       LCALL   ?DEALLOC_XSTACK8
   \   000064                ; Setup parameters for call to function osal_start_timerEx
   \   000064   7C88         MOV     R4,#-0x78
   \   000066   7D13         MOV     R5,#0x13
   \   000068   7A04         MOV     R2,#0x4
   \   00006A   7B00         MOV     R3,#0x0
   \   00006C   90....       MOV     DPTR,#ZDAppTaskID
   \   00006F   E0           MOVX    A,@DPTR
   \   000070   F9           MOV     R1,A
   \   000071   12....       LCALL   ??osal_start_timerEx?relay
   2178            }
   \   000074   8017         SJMP    ??ZDO_LeaveCnf_2
   2179            else if ( ZSTACK_ROUTER_BUILD )
   2180            {
   2181              // Remove device address(optionally descendents) from data
   2182              ZDApp_LeaveUpdate( cnf->dstAddr,
   2183                                 cnf->extAddr,
   2184                                 cnf->removeChildren );
   \                     ??ZDO_LeaveCnf_0:
   \   000076                ; Setup parameters for call to function NLME_RemoveChild
   \   000076   8E82         MOV     DPL,R6
   \   000078   8F83         MOV     DPH,R7
   \   00007A   A3           INC     DPTR
   \   00007B   A3           INC     DPTR
   \   00007C   A3           INC     DPTR
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   A3           INC     DPTR
   \   000080   A3           INC     DPTR
   \   000081   A3           INC     DPTR
   \   000082   A3           INC     DPTR
   \   000083   A3           INC     DPTR
   \   000084   E0           MOVX    A,@DPTR
   \   000085   F9           MOV     R1,A
   \   000086   AA..         MOV     R2,?V0 + 0
   \   000088   AB..         MOV     R3,?V0 + 1
   \   00008A   12....       LCALL   ??NLME_RemoveChild?relay
   2185            }
   2186          }
   \                     ??ZDO_LeaveCnf_2:
   \   00008D   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   2187          
   2188          /*********************************************************************
   2189           * @fn          ZDO_LeaveInd
   2190           *
   2191           * @brief       This function allows the next higher layer of a
   2192           *              device to be notified of a remote leave request or
   2193           *              indication.
   2194           *
   2195           * @param       ind - NLME_LeaveInd_t
   2196           *
   2197           * @return      none
   2198           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2199          void ZDO_LeaveInd( NLME_LeaveInd_t* ind )
   \                     ZDO_LeaveInd:
   2200          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   2201            uint8 leave;
   2202          
   2203          
   2204            // Parent is requesting the leave - NWK layer filters out illegal
   2205            // requests
   2206            if ( ind->request == TRUE )
   \   00000E   EE           MOV     A,R6
   \   00000F   240B         ADD     A,#0xb
   \   000011   F8           MOV     R0,A
   \   000012   EF           MOV     A,R7
   \   000013   3400         ADDC    A,#0x0
   \   000015   F9           MOV     R1,A
   \   000016   88..         MOV     ?V0 + 0,R0
   \   000018   89..         MOV     ?V0 + 1,R1
   \   00001A   8E82         MOV     DPL,R6
   \   00001C   8F83         MOV     DPH,R7
   \   00001E   A3           INC     DPTR
   \   00001F   A3           INC     DPTR
   \   000020   A3           INC     DPTR
   \   000021   A3           INC     DPTR
   \   000022   A3           INC     DPTR
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   A3           INC     DPTR
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   E0           MOVX    A,@DPTR
   \   000029   6401         XRL     A,#0x1
   \   00002B   7041         JNZ     ??ZDO_LeaveInd_0
   2207            {
   2208              // Notify network of leave
   2209              if ( ZSTACK_ROUTER_BUILD )
   2210              {
   2211                NLME_LeaveRsp_t rsp;
   2212                rsp.rejoin         = ind->rejoin;
   \   00002D   EE           MOV     A,R6
   \   00002E   240C         ADD     A,#0xc
   \   000030   08           INC     R0
   \   000031   EF           MOV     A,R7
   \   000032   3400         ADDC    A,#0x0
   \   000034   F9           MOV     R1,A
   \   000035   E8           MOV     A,R0
   \   000036   FE           MOV     R6,A
   \   000037   E9           MOV     A,R1
   \   000038   FF           MOV     R7,A
   \   000039   8E82         MOV     DPL,R6
   \   00003B   8F83         MOV     DPH,R7
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   C0E0         PUSH    A
   \   000040   7401         MOV     A,#0x1
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   D0E0         POP     A
   \   000047   F0           MOVX    @DPTR,A
   2213                rsp.removeChildren = ind->removeChildren;
   \   000048   85..82       MOV     DPL,?V0 + 0
   \   00004B   85..83       MOV     DPH,?V0 + 1
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   85..82       MOV     DPL,?XSP + 0
   \   000052   85..83       MOV     DPH,?XSP + 1
   \   000055   F0           MOVX    @DPTR,A
   2214                NLME_LeaveRsp( &rsp );
   \   000056                ; Setup parameters for call to function NLME_LeaveRsp
   \   000056   AA82         MOV     R2,DPL
   \   000058   AB83         MOV     R3,DPH
   \   00005A   12....       LCALL   ??NLME_LeaveRsp?relay
   2215              }
   2216          
   2217              // Prepare to leave with reset
   2218              ZDApp_LeaveReset( ind->rejoin );
   \   00005D   8E82         MOV     DPL,R6
   \   00005F   8F83         MOV     DPH,R7
   \   000061   E0           MOVX    A,@DPTR
   \   000062   F8           MOV     R0,A
   \   000063   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000066   7401         MOV     A,#0x1
   \   000068   F0           MOVX    @DPTR,A
   \   000069   68           XRL     A,R0
   \   00006A   7041         JNZ     ??ZDO_LeaveInd_1
   \   00006C   803C         SJMP    ??ZDO_LeaveInd_2
   2219            }
   2220            else
   2221            {
   2222              leave = FALSE;
   2223          
   2224              // Check if this device needs to leave as a child or descendent
   2225              if ( ind->srcAddr == NLME_GetCoordShortAddr() )
   \                     ??ZDO_LeaveInd_0:
   \   00006E                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   00006E   12....       LCALL   ??NLME_GetCoordShortAddr?relay
   \   000071   85..82       MOV     DPL,?V0 + 0
   \   000074   85..83       MOV     DPH,?V0 + 1
   \   000077   E0           MOVX    A,@DPTR
   \   000078   F9           MOV     R1,A
   \   000079   8E82         MOV     DPL,R6
   \   00007B   8F83         MOV     DPH,R7
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   6A           XRL     A,R2
   \   00007F   7003         JNZ     ??ZDO_LeaveInd_3
   \   000081   A3           INC     DPTR
   \   000082   E0           MOVX    A,@DPTR
   \   000083   6B           XRL     A,R3
   \                     ??ZDO_LeaveInd_3:
   \   000084   705F         JNZ     ??ZDO_LeaveInd_4
   2226              {
   2227                if ( ( ind->removeChildren == TRUE               ) ||
   2228                     ( ZDO_Config_Node_Descriptor.LogicalType ==
   2229                       NODETYPE_DEVICE                           )    )
   \   000086   7401         MOV     A,#0x1
   \   000088   69           XRL     A,R1
   \   000089   600A         JZ      ??ZDO_LeaveInd_5
   \   00008B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00008E   E0           MOVX    A,@DPTR
   \   00008F   5407         ANL     A,#0x7
   \   000091   6402         XRL     A,#0x2
   \   000093   7050         JNZ     ??ZDO_LeaveInd_4
   2230                {
   2231                  leave = TRUE;
   2232                }
   2233              }
   2234              else if ( ind->removeChildren == TRUE )
   2235              {
   2236                // Check NWK address allocation algorithm
   2237                //leave = RTG_ANCESTOR(nwkAddr,thisAddr);
   2238              }
   2239          
   2240              if ( leave == TRUE )
   2241              {
   2242                // Prepare to leave with reset
   2243                ZDApp_LeaveReset( ind->rejoin );
   \                     ??ZDO_LeaveInd_5:
   \   000095   EE           MOV     A,R6
   \   000096   240C         ADD     A,#0xc
   \   000098   F582         MOV     DPL,A
   \   00009A   EF           MOV     A,R7
   \   00009B   3400         ADDC    A,#0x0
   \   00009D   F583         MOV     DPH,A
   \   00009F   E0           MOVX    A,@DPTR
   \   0000A0   F8           MOV     R0,A
   \   0000A1   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   0000A4   7401         MOV     A,#0x1
   \   0000A6   F0           MOVX    @DPTR,A
   \   0000A7   68           XRL     A,R0
   \   0000A8   7003         JNZ     ??ZDO_LeaveInd_1
   \                     ??ZDO_LeaveInd_2:
   \   0000AA   7403         MOV     A,#0x3
   \   0000AC   F0           MOVX    @DPTR,A
   \                     ??ZDO_LeaveInd_1:
   \   0000AD                ; Setup parameters for call to function osal_nv_write
   \   0000AD   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   0000B0   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   0000B3   78..         MOV     R0,#?V0 + 0
   \   0000B5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B8   75..01       MOV     ?V0 + 0,#0x1
   \   0000BB   75..00       MOV     ?V0 + 1,#0x0
   \   0000BE   78..         MOV     R0,#?V0 + 0
   \   0000C0   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C3   7C00         MOV     R4,#0x0
   \   0000C5   7D00         MOV     R5,#0x0
   \   0000C7   7A85         MOV     R2,#-0x7b
   \   0000C9   7B00         MOV     R3,#0x0
   \   0000CB   12....       LCALL   ??osal_nv_write?relay
   \   0000CE   7404         MOV     A,#0x4
   \   0000D0   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000D3                ; Setup parameters for call to function osal_start_timerEx
   \   0000D3   7C88         MOV     R4,#-0x78
   \   0000D5   7D13         MOV     R5,#0x13
   \   0000D7   7A04         MOV     R2,#0x4
   \   0000D9   7B00         MOV     R3,#0x0
   \   0000DB   90....       MOV     DPTR,#ZDAppTaskID
   \   0000DE   E0           MOVX    A,@DPTR
   \   0000DF   F9           MOV     R1,A
   \   0000E0   12....       LCALL   ??osal_start_timerEx?relay
   2244              }
   \   0000E3   800B         SJMP    ??ZDO_LeaveInd_6
   2245              else
   2246              {
   2247                // Remove device address(optionally descendents) from data
   2248                ZDApp_LeaveUpdate( ind->srcAddr,
   2249                                   ind->extAddr,
   2250                                   ind->removeChildren );
   \                     ??ZDO_LeaveInd_4:
   \   0000E5                ; Setup parameters for call to function NLME_RemoveChild
   \   0000E5   EE           MOV     A,R6
   \   0000E6   2402         ADD     A,#0x2
   \   0000E8   FA           MOV     R2,A
   \   0000E9   EF           MOV     A,R7
   \   0000EA   3400         ADDC    A,#0x0
   \   0000EC   FB           MOV     R3,A
   \   0000ED   12....       LCALL   ??NLME_RemoveChild?relay
   2251              }
   2252            }
   2253          }
   \                     ??ZDO_LeaveInd_6:
   \   0000F0   7402         MOV     A,#0x2
   \   0000F2   02....       LJMP    ??Subroutine9_0 & 0xFFFF
   2254          
   2255          /*********************************************************************
   2256           * @fn          ZDO_SyncIndicationCB
   2257           *
   2258           * @brief       This function allows the next higher layer of a
   2259           *              coordinator to be notified of a loss of synchronization
   2260           *                          with the parent/child device.
   2261           *
   2262           * @param       type: 0 - child; 1 - parent
   2263           *
   2264           *
   2265           * @return      none
   2266           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2267          void ZDO_SyncIndicationCB( uint8 type, uint16 shortAddr )
   \                     ZDO_SyncIndicationCB:
   2268          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
   2269            (void)shortAddr;  // Remove this line if this parameter is used.
   2270            
   2271            if ( ZSTACK_END_DEVICE_BUILD
   2272              || (ZSTACK_ROUTER_BUILD && ((_NIB.CapabilityInfo & ZMAC_ASSOC_CAPINFO_FFD_TYPE) == 0)))
   \   000007   90....       MOV     DPTR,#_NIB + 14
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   4026         JC      ??ZDO_SyncIndicationCB_0
   2273            {
   2274              if ( type == 1 )
   \   00000F   7401         MOV     A,#0x1
   \   000011   6F           XRL     A,R7
   \   000012   7021         JNZ     ??ZDO_SyncIndicationCB_0
   2275              {
   2276                // We lost contact with our parent.  Clear the neighbor Table.
   2277                nwkNeighborInitTable();
   \   000014                ; Setup parameters for call to function nwkNeighborInitTable
   \   000014   12....       LCALL   ??nwkNeighborInitTable?relay
   2278                
   2279                // Start the rejoin process.
   2280                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_REQ, sizeof(osal_event_hdr_t), NULL );
   \   000017   90....       MOV     DPTR,#ZDAppTaskID
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   FE           MOV     R6,A
   \   00001C                ; Setup parameters for call to function osal_msg_allocate
   \   00001C   7A02         MOV     R2,#0x2
   \   00001E   7B00         MOV     R3,#0x0
   \   000020   12....       LCALL   ??osal_msg_allocate?relay
   \   000023   8A82         MOV     DPL,R2
   \   000025   8B83         MOV     DPH,R3
   \   000027   E582         MOV     A,DPL
   \   000029   4583         ORL     A,DPH
   \   00002B   6008         JZ      ??ZDO_SyncIndicationCB_0
   \   00002D   7403         MOV     A,#0x3
   \   00002F   F0           MOVX    @DPTR,A
   \   000030                ; Setup parameters for call to function osal_msg_send
   \   000030   EE           MOV     A,R6
   \   000031   F9           MOV     R1,A
   \   000032   12....       LCALL   ??osal_msg_send?relay
   2281              }
   2282            }
   2283          }
   \                     ??ZDO_SyncIndicationCB_0:
   \   000035   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   2284          
   2285          /*********************************************************************
   2286           * @fn          ZDO_ManytoOneFailureIndicationCB
   2287           *
   2288           * @brief       This function allows the next higher layer of a
   2289           *              concentrator to be notified of a many-to-one route 
   2290           *              failure. 
   2291           *
   2292           * @param       none
   2293           *
   2294           *
   2295           * @return      none
   2296           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2297          void ZDO_ManytoOneFailureIndicationCB()
   \                     ZDO_ManytoOneFailureIndicationCB:
   2298          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2299            // By default, the concentrator automatically redo many-to-one route 
   2300            // discovery to update all many-to-one routes in the network
   2301            // If you want anything processing other than the default,
   2302            // please replace the following code.
   2303            
   2304            RTG_MTORouteReq();
   \   000004                ; Setup parameters for call to function RTG_MTORouteReq
   \   000004   12....       LCALL   ??RTG_MTORouteReq?relay
   2305          }
   \   000007   02....       LJMP    ?Subroutine3 & 0xFFFF
   2306          
   2307          
   2308          /*********************************************************************
   2309           * @fn          ZDO_PollConfirmCB
   2310           *
   2311           * @brief       This function allows the next higher layer to be
   2312           *              notified of a Poll Confirm.
   2313           *
   2314           * @param       none
   2315           *
   2316           * @return      none
   2317           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2318          void ZDO_PollConfirmCB( uint8 status )
   \                     ZDO_PollConfirmCB:
   2319          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2320            (void)status;  // Remove this line if this parameter is used.
   2321            return;
   \   000000   02....       LJMP    ?BRET
   2322          }
   2323          
   2324          /******************************************************************************
   2325           * @fn          ZDApp_NwkWriteNVRequest (stubs AddrMgrWriteNVRequest)
   2326           *
   2327           * @brief       Stub routine implemented by NHLE. NHLE should call
   2328           *              <AddrMgrWriteNV> when appropriate.
   2329           *
   2330           * @param       none
   2331           *
   2332           * @return      none
   2333           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2334          void ZDApp_NwkWriteNVRequest( void )
   \                     AddrMgrWriteNVRequest:
   2335          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2336          #if defined ( NV_RESTORE )  
   2337            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   2338            {
   2339              // Trigger to save info into NV
   2340              ZDApp_NVUpdate();
   2341            }
   2342          #endif
   2343          }
   \   000000   02....       LJMP    ?BRET
   2344          
   2345          /*********************************************************************
   2346           * Call Back Functions from Security  - API
   2347           */
   2348          
   2349           /*********************************************************************
   2350           * @fn          ZDO_UpdateDeviceIndication
   2351           *
   2352           * @brief       This function notifies the "Trust Center" of a
   2353           *              network when a device joins or leaves the network.
   2354           *
   2355           * @param       extAddr - pointer to 64 bit address of new device
   2356           * @param       status  - 0 if a new device joined securely
   2357           *                      - 1 if a new device joined un-securely
   2358           *                      - 2 if a device left the network
   2359           *
   2360           * @return      true if newly joined device should be allowed to
   2361           *                                              remain on network
   2362           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2363          ZStatus_t ZDO_UpdateDeviceIndication( uint8 *extAddr, uint8 status )
   \                     ZDO_UpdateDeviceIndication:
   2364          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2365            // can implement a network access policy based on the
   2366            // IEEE address of newly joining devices...
   2367            (void)extAddr;
   2368            (void)status;
   2369            
   2370            return ZSuccess;
   \   000000   02....       LJMP    ?Subroutine4 & 0xFFFF
   2371          }
   2372          
   2373          /*********************************************************************
   2374           * @fn          ZDApp_InMsgCB
   2375           *
   2376           * @brief       This function is called to pass up any message that is
   2377           *              not yet supported.  This allows for the developer to
   2378           *              support features themselves..
   2379           *
   2380           * @return      none
   2381           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2382          void ZDApp_InMsgCB( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_InMsgCB:
   2383          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2384            if ( inMsg->clusterID & ZDO_RESPONSE_BIT )
   \   000009   EE           MOV     A,R6
   \   00000A   240C         ADD     A,#0xc
   \   00000C   F582         MOV     DPL,A
   \   00000E   EF           MOV     A,R7
   \   00000F   3400         ADDC    A,#0x0
   \   000011   F583         MOV     DPH,A
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F8           MOV     R0,A
   \   000015   A3           INC     DPTR
   \   000016   E0           MOVX    A,@DPTR
   \   000017   F9           MOV     R1,A
   \   000018   5480         ANL     A,#0x80
   \   00001A   7057         JNZ     ??ZDApp_InMsgCB_0
   2385            {
   2386              // Handle the response message
   2387            }
   2388            else
   2389            {
   2390              // Handle the request message by sending a generic "not supported".
   2391              // Device Announce doesn't have a response.
   2392              if ( !(inMsg->wasBroadcast) && inMsg->clusterID != Device_annce )
   \   00001C   EE           MOV     A,R6
   \   00001D   240B         ADD     A,#0xb
   \   00001F   F582         MOV     DPL,A
   \   000021   EF           MOV     A,R7
   \   000022   3400         ADDC    A,#0x0
   \   000024   F583         MOV     DPH,A
   \   000026   E0           MOVX    A,@DPTR
   \   000027   704A         JNZ     ??ZDApp_InMsgCB_0
   \   000029   7413         MOV     A,#0x13
   \   00002B   68           XRL     A,R0
   \   00002C   7001         JNZ     ??ZDApp_InMsgCB_1
   \   00002E   E9           MOV     A,R1
   \                     ??ZDApp_InMsgCB_1:
   \   00002F   6042         JZ      ??ZDApp_InMsgCB_0
   2393              {
   2394                ZDP_GenericRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_NOT_SUPPORTED, 0,
   2395                                (uint16)(inMsg->clusterID | ZDO_RESPONSE_BIT), inMsg->SecurityUse );
   \   000031                ; Setup parameters for call to function ZDP_GenericRsp
   \   000031   E8           MOV     A,R0
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   E9           MOV     A,R1
   \   000035   4480         ORL     A,#0x80
   \   000037   F5..         MOV     ?V0 + 1,A
   \   000039   78..         MOV     R0,#?V0 + 0
   \   00003B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003E   E4           CLR     A
   \   00003F   F5..         MOV     ?V0 + 0,A
   \   000041   F5..         MOV     ?V0 + 1,A
   \   000043   78..         MOV     R0,#?V0 + 0
   \   000045   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000048   EE           MOV     A,R6
   \   000049   240E         ADD     A,#0xe
   \   00004B   F582         MOV     DPL,A
   \   00004D   EF           MOV     A,R7
   \   00004E   3400         ADDC    A,#0x0
   \   000050   F583         MOV     DPH,A
   \   000052   E0           MOVX    A,@DPTR
   \   000053   FD           MOV     R5,A
   \   000054   7C84         MOV     R4,#-0x7c
   \   000056   EE           MOV     A,R6
   \   000057   2402         ADD     A,#0x2
   \   000059   0A           INC     R2
   \   00005A   0A           INC     R2
   \   00005B   EF           MOV     A,R7
   \   00005C   3400         ADDC    A,#0x0
   \   00005E   FB           MOV     R3,A
   \   00005F   EE           MOV     A,R6
   \   000060   240F         ADD     A,#0xf
   \   000062   F582         MOV     DPL,A
   \   000064   EF           MOV     A,R7
   \   000065   3400         ADDC    A,#0x0
   \   000067   F583         MOV     DPH,A
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F9           MOV     R1,A
   \   00006B   12....       LCALL   ??ZDP_GenericRsp?relay
   \   00006E   7404         MOV     A,#0x4
   \   000070   12....       LCALL   ?DEALLOC_XSTACK8
   2396              }
   2397            }
   2398          }
   \                     ??ZDApp_InMsgCB_0:
   \   000073   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   2399          
   2400          
   2401          /*********************************************************************
   2402           * @fn      ZDApp_ChangeMatchDescRespPermission()
   2403           *
   2404           * @brief   Changes the Match Descriptor Response permission.
   2405           *
   2406           * @param   endpoint - endpoint to allow responses
   2407           * @param   action - true to allow responses, false to not
   2408           *
   2409           * @return  none
   2410           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2411          void ZDApp_ChangeMatchDescRespPermission( uint8 endpoint, uint8 action )
   \                     ZDApp_ChangeMatchDescRespPermission:
   2412          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   2413            // Store the action
   2414            afSetMatch( endpoint, action );
   \   000005                ; Setup parameters for call to function afSetMatch
   \   000005   12....       LCALL   ??afSetMatch?relay
   2415          }
   \   000008   02....       LJMP    ??Subroutine7_0 & 0xFFFF
   2416          
   2417          /*********************************************************************
   2418           * @fn      ZDApp_NetworkInit()
   2419           *
   2420           * @brief   Used to start the network joining process
   2421           *
   2422           * @param   delay - mSec delay to wait before starting
   2423           *
   2424           * @return  none
   2425           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2426          void ZDApp_NetworkInit( uint16 delay )
   \                     ZDApp_NetworkInit:
   2427          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2428            if ( delay )
   \   000004   EA           MOV     A,R2
   \   000005   4B           ORL     A,R3
   \   000006   6012         JZ      ??ZDApp_NetworkInit_0
   2429            {
   2430              // Wait awhile before starting the device
   2431              osal_start_timerEx( ZDAppTaskID, ZDO_NETWORK_INIT, delay );
   \   000008                ; Setup parameters for call to function osal_start_timerEx
   \   000008   EA           MOV     A,R2
   \   000009   FC           MOV     R4,A
   \   00000A   EB           MOV     A,R3
   \   00000B   FD           MOV     R5,A
   \   00000C   7A01         MOV     R2,#0x1
   \   00000E   7B00         MOV     R3,#0x0
   \   000010   90....       MOV     DPTR,#ZDAppTaskID
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F9           MOV     R1,A
   \   000015   12....       LCALL   ??osal_start_timerEx?relay
   \   000018   800C         SJMP    ??ZDApp_NetworkInit_1
   2432            }
   2433            else
   2434            {
   2435              osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \                     ??ZDApp_NetworkInit_0:
   \   00001A                ; Setup parameters for call to function osal_set_event
   \   00001A   7A01         MOV     R2,#0x1
   \   00001C   7B00         MOV     R3,#0x0
   \   00001E   90....       MOV     DPTR,#ZDAppTaskID
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F9           MOV     R1,A
   \   000023   12....       LCALL   ??osal_set_event?relay
   2436            }
   2437          }
   \                     ??ZDApp_NetworkInit_1:
   \   000026   02....       LJMP    ?Subroutine3 & 0xFFFF
   2438          
   2439          /*********************************************************************
   2440           * @fn      ZDApp_NwkStateUpdateCB()
   2441           *
   2442           * @brief   This function notifies that this device's network 
   2443           *          state info has been changed.
   2444           *
   2445           * @param   none
   2446           *
   2447           * @return  none
   2448           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2449          void ZDApp_NwkStateUpdateCB( void )
   \                     ZDApp_NwkStateUpdateCB:
   2450          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2451            // Notify to save info into NV
   2452            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   \   000004                ; Setup parameters for call to function osal_get_timeoutEx
   \   000004   7A00         MOV     R2,#0x0
   \   000006   7B02         MOV     R3,#0x2
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_get_timeoutEx?relay
   2453            {
   2454              // Trigger to save info into NV
   2455              ZDApp_NVUpdate();
   2456            }
   2457          }
   \   000010   02....       LJMP    ?Subroutine3 & 0xFFFF
   2458          
   2459          /*********************************************************************
   2460           * @fn      ZDApp_NodeProfileSync()
   2461           *
   2462           * @brief   Sync node with stack profile.
   2463           *
   2464           * @param   cfm - ZDO_NetworkDiscoveryCfm_t
   2465           *
   2466           * @return  none
   2467           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2468          void ZDApp_NodeProfileSync( ZDO_NetworkDiscoveryCfm_t* cfm )
   \                     ZDApp_NodeProfileSync:
   2469          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2470            networkDesc_t* desc;
   2471            uint16         panID;
   2472          
   2473            if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_DEVICETYPE_FFD  )
   \   000005   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000008   E0           MOVX    A,@DPTR
   \   000009   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000B   5056         JNC     ??ZDApp_NodeProfileSync_0
   2474            {
   2475              panID = BUILD_UINT16( cfm->panIdLSB, cfm->panIdMSB );
   2476          
   2477              desc = nwk_getNetworkDesc( cfm->extendedPANID, panID, cfm->logicalChannel );
   \   00000D                ; Setup parameters for call to function nwk_getNetworkDesc
   \   00000D   8A82         MOV     DPL,R2
   \   00000F   8B83         MOV     DPH,R3
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   F9           MOV     R1,A
   \   000017   8A82         MOV     DPL,R2
   \   000019   8B83         MOV     DPH,R3
   \   00001B   A3           INC     DPTR
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   FE           MOV     R6,A
   \   00001F   8A82         MOV     DPL,R2
   \   000021   8B83         MOV     DPH,R3
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   A3           INC     DPTR
   \   000026   E0           MOVX    A,@DPTR
   \   000027   FD           MOV     R5,A
   \   000028   EE           MOV     A,R6
   \   000029   FC           MOV     R4,A
   \   00002A   EA           MOV     A,R2
   \   00002B   2406         ADD     A,#0x6
   \   00002D   FA           MOV     R2,A
   \   00002E   EB           MOV     A,R3
   \   00002F   3400         ADDC    A,#0x0
   \   000031   FB           MOV     R3,A
   \   000032   12....       LCALL   ??nwk_getNetworkDesc?relay
   \   000035   8A82         MOV     DPL,R2
   \   000037   8B83         MOV     DPH,R3
   2478          
   2479              if (desc != NULL)
   \   000039   E582         MOV     A,DPL
   \   00003B   4583         ORL     A,DPH
   \   00003D   6024         JZ      ??ZDApp_NodeProfileSync_0
   2480              {
   2481                if ( desc->stackProfile != zgStackProfile )
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F8           MOV     R0,A
   \   000049   90....       MOV     DPTR,#zgStackProfile
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   68           XRL     A,R0
   \   00004E   6013         JZ      ??ZDApp_NodeProfileSync_0
   2482                {
   2483                  ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   000050   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000053   E0           MOVX    A,@DPTR
   \   000054   54F8         ANL     A,#0xf8
   \   000056   4402         ORL     A,#0x2
   \   000058   F0           MOVX    @DPTR,A
   2484                  ZDO_Config_Node_Descriptor.CapabilityFlags = CAPINFO_DEVICETYPE_RFD | CAPINFO_POWER_AC | CAPINFO_RCVR_ON_IDLE;
   \   000059   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00005C   740C         MOV     A,#0xc
   \   00005E   F0           MOVX    @DPTR,A
   2485                  NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \   00005F                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   00005F   F9           MOV     R1,A
   \   000060   12....       LCALL   ??NLME_SetBroadcastFilter?relay
   2486                }
   2487              }
   2488            }
   2489          }
   \                     ??ZDApp_NodeProfileSync_0:
   \   000063   02....       LJMP    ??Subroutine10_0 & 0xFFFF
   2490          
   2491          /*********************************************************************
   2492           * @fn      ZDApp_StartJoiningCycle()
   2493           *
   2494           * @brief   Starts the joining cycle of a device.  This will only 
   2495           *          continue an already started (or stopped) joining cycle.
   2496           *
   2497           * @param   none
   2498           *
   2499           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2500           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2501          uint8 ZDApp_StartJoiningCycle( void )
   \                     ZDApp_StartJoiningCycle:
   2502          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2503            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StartJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7015         JNZ     ??ZDApp_StartJoiningCycle_1
   2504            {
   2505              continueJoining = TRUE;
   \                     ??ZDApp_StartJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
   2506              ZDApp_NetworkInit( 0 );
   \   000017                ; Setup parameters for call to function osal_set_event
   \   000017   FA           MOV     R2,A
   \   000018   7B00         MOV     R3,#0x0
   \   00001A   90....       MOV     DPTR,#ZDAppTaskID
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F9           MOV     R1,A
   \   00001F   12....       LCALL   ??osal_set_event?relay
   2507          
   2508              return ( TRUE );
   \   000022   7901         MOV     R1,#0x1
   \   000024   8002         SJMP    ??ZDApp_StartJoiningCycle_2
   2509            }
   2510            else
   2511              return ( FALSE );
   \                     ??ZDApp_StartJoiningCycle_1:
   \   000026   7900         MOV     R1,#0x0
   \                     ??ZDApp_StartJoiningCycle_2:
   \   000028   02....       LJMP    ?Subroutine3 & 0xFFFF
   2512          }
   2513          
   2514          /*********************************************************************
   2515           * @fn      ZDApp_StopJoiningCycle()
   2516           *
   2517           * @brief   Stops the joining or rejoining process of a device.
   2518           *
   2519           * @param   none
   2520           *
   2521           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2522           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2523          uint8 ZDApp_StopJoiningCycle( void )
   \                     ZDApp_StopJoiningCycle:
   2524          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2525            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StopJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7009         JNZ     ??ZDApp_StopJoiningCycle_1
   2526            {
   2527              continueJoining = FALSE;
   \                     ??ZDApp_StopJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   E4           CLR     A
   \   000015   F0           MOVX    @DPTR,A
   2528              return ( TRUE );
   \   000016   7901         MOV     R1,#0x1
   \   000018   8002         SJMP    ??ZDApp_StopJoiningCycle_2
   2529            }
   2530            else
   2531              return ( FALSE );
   \                     ??ZDApp_StopJoiningCycle_1:
   \   00001A   7900         MOV     R1,#0x0
   \                     ??ZDApp_StopJoiningCycle_2:
   \   00001C   02....       LJMP    ?Subroutine3 & 0xFFFF
   2532          }
   2533          
   2534          /*********************************************************************
   2535           * @fn      ZDApp_AnnounceNewAddress()
   2536           *
   2537           * @brief   Send Device Announce and hold all transmissions for 
   2538           *          new address timeout.
   2539           *
   2540           * @param   none
   2541           *
   2542           * @return  none
   2543           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2544          void ZDApp_AnnounceNewAddress( void )
   \                     ZDApp_AnnounceNewAddress:
   2545          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2546          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2547            // Turn off data request hold
   2548            APSME_HoldDataRequests( 0 );
   \   000005                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000005   02....       LJMP    ?Subroutine1 & 0xFFFF
   2549          #endif
   2550            
   2551            ZDP_DeviceAnnce( NLME_GetShortAddr(), NLME_GetExtAddr(),
   2552                               ZDO_Config_Node_Descriptor.CapabilityFlags, 0 );
   2553            
   2554          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2555            // Setup the timeout
   2556            APSME_HoldDataRequests( ZDAPP_HOLD_DATA_REQUESTS_TIMEOUT );
   2557          #endif  
   2558          }
   2559          
   2560          /*********************************************************************
   2561           * @fn          ZDApp_NVUpdate
   2562           *
   2563           * @brief       Set the NV Update Timer.
   2564           *
   2565           * @param       none
   2566           *
   2567           * @return      none
   2568           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2569          void ZDApp_NVUpdate( void )
   \                     ZDApp_NVUpdate:
   2570          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2571          #if defined ( NV_RESTORE )
   2572            osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, ZDAPP_UPDATE_NWK_NV_TIME );
   2573          #endif
   2574          }
   \   000000   02....       LJMP    ?BRET
   2575          
   2576          /*********************************************************************
   2577           * @fn      ZDApp_CoordStartPANIDConflictCB()
   2578           *
   2579           * @brief   Returns a PAN ID for the network layer to use during
   2580           *          a coordinator start and there is another network with 
   2581           *          the intended PANID.
   2582           *
   2583           * @param   panid - the intended PAN ID
   2584           *
   2585           * @return  PANID to try
   2586           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2587          uint16 ZDApp_CoordStartPANIDConflictCB( uint16 panid )
   \                     ZDApp_CoordStartPANIDConflictCB:
   2588          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2589            return ( panid + 1 );
   \   000000   EA           MOV     A,R2
   \   000001   2401         ADD     A,#0x1
   \   000003   0A           INC     R2
   \   000004   EB           MOV     A,R3
   \   000005   3400         ADDC    A,#0x0
   \   000007   FB           MOV     R3,A
   \   000008   02....       LJMP    ?BRET
   2590          }
   2591          
   2592          /*********************************************************************
   2593           * @fn          ZDO_SrcRtgIndCB
   2594           *
   2595           * @brief       This function notifies the ZDO available src route record received.
   2596           *
   2597           * @param       srcAddr - source address of the source route
   2598           * @param       relayCnt - number of devices in the relay list
   2599           * @param       relayList - relay list of the source route
   2600           *
   2601           * @return      none
   2602           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2603          void ZDO_SrcRtgIndCB (uint16 srcAddr, uint8 relayCnt, uint16* pRelayList )
   \                     ZDO_SrcRtgIndCB:
   2604          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2605            zdoSrcRtg_t srcRtg;
   2606            
   2607            srcRtg.srcAddr = srcAddr;
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
   2608            srcRtg.relayCnt = relayCnt;
   \   000015   7402         MOV     A,#0x2
   \   000017   12....       LCALL   ?XSTACK_DISP0_8
   \   00001A   E9           MOV     A,R1
   \   00001B   F0           MOVX    @DPTR,A
   2609            srcRtg.pRelayList = pRelayList;
   \   00001C   7403         MOV     A,#0x3
   \   00001E   12....       LCALL   ?XSTACK_DISP0_8
   \   000021   EC           MOV     A,R4
   \   000022   F0           MOVX    @DPTR,A
   \   000023   A3           INC     DPTR
   \   000024   ED           MOV     A,R5
   \   000025   F0           MOVX    @DPTR,A
   2610            
   2611            if( zdoCBFunc[ZDO_SRC_RTG_IND_CBID] != NULL )
   \   000026   90....       MOV     DPTR,#zdoCBFunc
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F9           MOV     R1,A
   \   00002E   E8           MOV     A,R0
   \   00002F   49           ORL     A,R1
   \   000030   6015         JZ      ??ZDO_SrcRtgIndCB_0
   2612            {
   2613              zdoCBFunc[ZDO_SRC_RTG_IND_CBID]( (void*)&srcRtg );
   \   000032                ; Setup parameters for indirect call
   \   000032   85..82       MOV     DPL,?XSP + 0
   \   000035   85..83       MOV     DPH,?XSP + 1
   \   000038   AA82         MOV     R2,DPL
   \   00003A   AB83         MOV     R3,DPH
   \   00003C   90....       MOV     DPTR,#zdoCBFunc + 1
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   F583         MOV     DPH,A
   \   000042   8882         MOV     DPL,R0
   \   000044   12....       LCALL   ?CALL_IND
   2614            }
   2615          }
   \                     ??ZDO_SrcRtgIndCB_0:
   \   000047   7405         MOV     A,#0x5
   \   000049   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004C   02....       LJMP    ??Subroutine7_0 & 0xFFFF
   2616          
   2617          
   2618          /*********************************************************************
   2619           * @fn          ZDO_RegisterForZdoCB
   2620           *
   2621           * @brief       Call this function to register the higher layer (for 
   2622           *              example, the Application layer or MT layer) with ZDO 
   2623           *              callbacks to get notified of some ZDO indication like
   2624           *              existence of a concentrator or receipt of a source 
   2625           *              route record.
   2626           *
   2627           * @param       indID - ZDO Indication ID
   2628           * @param       pFn   - Callback function pointer
   2629           *
   2630           * @return      ZSuccess - successful, ZInvalidParameter if not
   2631           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2632          ZStatus_t ZDO_RegisterForZdoCB( uint8 indID, pfnZdoCb pFn )
   \                     ZDO_RegisterForZdoCB:
   2633          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   2634            // Check the range of the indication ID
   2635            if ( indID < MAX_ZDO_CB_FUNC )
   \   000005   700C         JNZ     ??ZDO_RegisterForZdoCB_0
   2636            {
   2637              zdoCBFunc[indID] = pFn;
   \   000007   90....       MOV     DPTR,#zdoCBFunc
   \   00000A   EA           MOV     A,R2
   \   00000B   F0           MOVX    @DPTR,A
   \   00000C   A3           INC     DPTR
   \   00000D   EB           MOV     A,R3
   \   00000E   F0           MOVX    @DPTR,A
   2638              return ZSuccess;
   \   00000F   7900         MOV     R1,#0x0
   \   000011   8002         SJMP    ??ZDO_RegisterForZdoCB_1
   2639            }
   2640            
   2641            return ZInvalidParameter;
   \                     ??ZDO_RegisterForZdoCB_0:
   \   000013   7902         MOV     R1,#0x2
   \                     ??ZDO_RegisterForZdoCB_1:
   \   000015   02....       LJMP    ?Subroutine3 & 0xFFFF
   2642          }

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zdoDiscCounter>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for continueJoining>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for devState>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_epDesc>`:
   \   000000   00           DB 0
   \   000001   ....         DW ZDAppTaskID
   \   000003   0000         DW 0H
   \   000005   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_SavedPollRate>`:
   \   000000   E803         DW 1000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1:
   \   000000   01000000     DD 1

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SecInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SecInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_event_loop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDOInitDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDOInitDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ReadNetworkRestoreState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ReadNetworkRestoreState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppDetermineDeviceType?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppDetermineDeviceType

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkStartEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkStartEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceAuthEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceAuthEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNetworkStateEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNetworkStateEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNetworkState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNetworkState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitUserDesc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitUserDesc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppCheckForHoldKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppCheckForHoldKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessOSALMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessOSALMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessMsgCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessMsgCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RegisterCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RegisterCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessNetworkJoin?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessNetworkJoin

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerStart?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerStart

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerCancel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerCancel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlSet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlBypass?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlBypass

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlStartup?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlStartup

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendEventMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendEventMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkDiscoveryConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkDiscoveryConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkFormationConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkFormationConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_StartRouterConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_StartRouterConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_AddrChangeIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_AddrChangeIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ConcentratorIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ConcentratorIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveCnf?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveCnf

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveInd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveInd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SyncIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SyncIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ManytoOneFailureIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ManytoOneFailureIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_PollConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_PollConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AddrMgrWriteNVRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AddrMgrWriteNVRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_UpdateDeviceIndication?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_UpdateDeviceIndication

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InMsgCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InMsgCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ChangeMatchDescRespPermission?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ChangeMatchDescRespPermission

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkStateUpdateCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkStateUpdateCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NodeProfileSync?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NodeProfileSync

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StartJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StartJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StopJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StopJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_AnnounceNewAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_AnnounceNewAddress

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NVUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NVUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_CoordStartPANIDConflictCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_CoordStartPANIDConflictCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SrcRtgIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SrcRtgIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RegisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RegisterForZdoCB
   2643          
   2644          /*********************************************************************
   2645          *********************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     AddrMgrWriteNVRequest              0      0      0
     ZDAppCheckForHoldKey               2      0      0
       -> HalKeyRead                    4      0      0
     ZDAppDetermineDeviceType           2      0     10
       -> nwk_ExtPANIDValid             4      0      0
     ZDApp_AnnounceNewAddress           0      0     11
       -> APSME_HoldDataRequests        0      0     20
       -> NLME_GetExtAddr               0      0     20
       -> NLME_GetShortAddr             0      0     20
       -> ZDP_DeviceAnnce               0      0     22
       -> APSME_HoldDataRequests        0      0     20
     ZDApp_ChangeMatchDescRespPermission
                                        0      0      9
       -> afSetMatch                    0      0     18
     ZDApp_CoordStartPANIDConflictCB
                                        0      0      0
     ZDApp_DeviceAuthEvt                0      0     70
       -> osal_stop_timerEx             0      0     66
       -> osal_set_event                0      0     66
       -> NLME_StartRouterRequest       0      0     66
       -> SSP_ReadNwkActiveKey          0      0     66
       -> osal_nv_write                 0      0     74
       -> APSME_HoldDataRequests        0      0     66
       -> NLME_GetExtAddr               0      0     66
       -> NLME_GetShortAddr             0      0     66
       -> ZDP_DeviceAnnce               0      0     68
       -> APSME_HoldDataRequests        0      0     66
       -> NLME_SetPollRate              0      0     66
     ZDApp_InMsgCB                      0      0     14
       -> ZDP_GenericRsp                0      0     28
     ZDApp_Init                         0      0      9
       -> NLME_GetExtAddr               0      0     18
       -> HalKeyRead                    0      0     18
       -> ZDO_Init                      0      0     18
       -> afRegister                    0      0     18
       -> ZDApp_InitUserDesc            0      0     18
       -> ZDOInitDevice                 0      0     18
       -> HalLedBlink                   0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
     ZDApp_InitUserDesc                 0      0     40
       -> osal_memset                   0      0     54
       -> osal_nv_item_init             0      0     58
       -> osal_nv_read                  0      0     62
     ZDApp_LeaveCtrlBypass              2      0      0
     ZDApp_LeaveCtrlInit                0      0     14
       -> osal_nv_item_init             0      0     24
       -> osal_nv_read                  0      0     28
     ZDApp_LeaveCtrlSet                 0      0     14
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlStartup             0      0     14
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveReset                   0      0     14
       -> osal_nv_write                 0      0     28
       -> osal_start_timerEx            0      0     20
     ZDApp_LeaveUpdate                  0      0      9
       -> NLME_RemoveChild              0      0     18
     ZDApp_NVUpdate                     0      0      0
     ZDApp_NetworkInit                  2      0      0
       -> osal_start_timerEx            4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NetworkStartEvt              2      0     10
       -> osal_pwrmgr_device            4      0      0
       -> osal_set_event                4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_SetEnergyThreshold       4      0      0
       -> osal_set_event                4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NodeProfileSync              0      0     10
       -> nwk_getNetworkDesc            0      0     20
       -> NLME_SetBroadcastFilter       0      0     20
     ZDApp_NwkStateUpdateCB             2      0      0
       -> osal_get_timeoutEx            4      0      0
     ZDApp_ProcessMsgCBs                0      0     31
       -> ZDO_ParseAddrRsp              0      0     62
       -> ZDO_UpdateAddrManager         0      0     62
       -> osal_mem_free                 0      0     62
       -> ZDO_ParseBindUnbindReq        0      0     62
       -> ZDO_ProcessBindUnbindReq      0      0     62
     ZDApp_ProcessNetworkJoin           0      0     51
       -> osal_set_event                0      0     24
       -> APSME_HoldDataRequests        0      0     24
       -> NLME_GetExtAddr               0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZDP_DeviceAnnce               0      0     26
       -> APSME_HoldDataRequests        0      0     24
       -> NLME_StartRouterRequest       0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZMacSetReq                    0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_set_event                0      0     24
       -> NLME_SetPollRate              0      0     24
       -> NLME_SetQueuedPollRate        0      0     24
       -> NLME_SetResponseRate          0      0     24
       -> NLME_StartRouterRequest       0      0     24
       -> APSME_HoldDataRequests        0      0     24
       -> NLME_GetExtAddr               0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZDP_DeviceAnnce               0      0     26
       -> APSME_HoldDataRequests        0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_set_event                0      0     24
       -> APSME_HoldDataRequests        0      0     24
       -> NLME_GetExtAddr               0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZDP_DeviceAnnce               0      0     26
       -> APSME_HoldDataRequests        0      0     24
       -> osal_set_event                0      0     24
     ZDApp_ProcessOSALMsg               0      0     49
       -> ZDP_IncomingData              0      0     76
       -> ZDO_ParseBindUnbindReq        0      0     76
       -> ZDO_ProcessBindUnbindReq      0      0     76
       -> ZDO_ParseAddrRsp              0      0     76
       -> ZDO_UpdateAddrManager         0      0     76
       -> osal_mem_free                 0      0     76
       -> nwk_getNetworkDesc            0      0     76
       -> NLME_SetBroadcastFilter       0      0     76
       -> NLME_JoinRequest              0      0     78
       -> osal_rand                     0      0     76
       -> osal_start_timerEx            0      0     76
       -> osal_rand                     0      0     76
       -> ZMacSetReq                    0      0     76
       -> ZMacSetReq                    0      0     76
       -> ZMacSetReq                    0      0     76
       -> NLME_ReJoinRequest            0      0     76
       -> osal_rand                     0      0     76
       -> osal_start_timerEx            0      0     76
       -> osal_set_event                0      0     76
       -> NLME_SetPollRate              0      0     76
       -> NLME_SetQueuedPollRate        0      0     76
       -> NLME_SetResponseRate          0      0     76
       -> osal_rand                     0      0     76
       -> osal_start_timerEx            0      0     76
       -> osal_set_event                0      0     76
       -> ZDApp_ProcessNetworkJoin      0      0     76
       -> sAddrExtCpy                   0      0     76
       -> osal_set_event                0      0     76
     ZDApp_ProcessSecEvent              0      0     37
       -> ZDSecMgrNewDeviceEvent        0      0     66
       -> osal_start_timerEx            0      0     66
       -> ZDApp_DeviceAuthEvt           0      0     66
       -> SSP_ReadNwkActiveKey          0      0     66
       -> osal_nv_write                 0      0     74
     ZDApp_ProcessSecMsg                2      0      0
       -> ZDSecMgrTransportKeyInd       4      0      0
       -> ZDSecMgrRemoveDeviceInd       4      0      0
       -> ZDSecMgrSwitchKeyInd          4      0      0
     ZDApp_ReadNetworkRestoreState      0      0      9
       -> zgReadStartupOptions          0      0     18
     ZDApp_RegisterCBs                  2      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
     ZDApp_ResetNwkKey                  0      0     35
       -> osal_memset                   0      0     62
       -> osal_nv_write                 0      0     70
     ZDApp_ResetTimerCancel             2      0      0
       -> osal_stop_timerEx             4      0      0
     ZDApp_ResetTimerStart              2      0      0
       -> osal_start_timerEx            4      0      0
     ZDApp_RestoreNetworkState          0      0      9
       -> NLME_InitNV                   0      0     18
       -> NLME_RestoreFromNV            0      0     18
       -> NLME_GetShortAddr             0      0     18
       -> sAddrExtCpy                   0      0     18
     ZDApp_RestoreNwkKey                0      0     37
       -> osal_nv_read                  0      0     74
     ZDApp_SaveNetworkStateEvt          0      0      0
     ZDApp_SaveNwkKey                   0      0     37
       -> SSP_ReadNwkActiveKey          0      0     66
       -> osal_nv_write                 0      0     74
     ZDApp_SecInit                      0      0      9
       -> ZDSecMgrInit                  0      0     18
     ZDApp_SendEventMsg                 1      0     22
       -> osal_msg_allocate             0      0     38
       -> osal_memcpy                   0      0     44
       -> osal_msg_send                 0      0     38
     ZDApp_SendMsg                      1      0     22
       -> osal_msg_allocate             0      0     38
       -> osal_memcpy                   0      0     44
       -> osal_msg_send                 0      0     38
     ZDApp_StartJoiningCycle            2      0      0
       -> osal_set_event                4      0      0
     ZDApp_StopJoiningCycle             2      0      0
     ZDApp_event_loop                   0      0     10
       -> ZDO_StartDevice               0      0     20
       -> ZDApp_ProcessOSALMsg          0      0     20
       -> osal_msg_deallocate           0      0     20
       -> osal_msg_receive              0      0     20
       -> ZDApp_NetworkStartEvt         0      0     20
       -> osal_pwrmgr_device            0      0     20
       -> osal_set_event                0      0     20
       -> ZDO_UpdateNwkStatus           0      0     20
       -> osal_start_timerEx            0      0     20
     ZDOInitDevice                      0      0     23
       -> zgInitItems                   0      0     20
       -> ZDConfig_InitDescriptors      0      0     20
       -> osal_nv_item_init             0      0     24
       -> osal_nv_read                  0      0     28
       -> osal_nv_write                 0      0     28
       -> zgWriteStartupOptions         0      0     20
       -> osal_set_event                0      0     20
       -> ZDAppDetermineDeviceType      0      0     20
       -> osal_rand                     0      0     20
       -> ZDSecMgrInit                  0      0     20
       -> osal_start_timerEx            0      0     20
       -> osal_set_event                0      0     20
       -> NLME_SetBroadcastFilter       0      0     20
     ZDO_AddrChangeIndicationCB         0      0     11
       -> osal_set_event                0      0     20
       -> APSME_HoldDataRequests        0      0     20
       -> NLME_GetExtAddr               0      0     20
       -> NLME_GetShortAddr             0      0     20
       -> ZDP_DeviceAnnce               0      0     22
       -> APSME_HoldDataRequests        0      0     20
     ZDO_ConcentratorIndicationCB       0      0      0
     ZDO_JoinConfirmCB                  0      0     10
       -> HalLedSet                     0      0     20
       -> HalLedSet                     0      0     20
       -> HalLedSet                     0      0     20
       -> osal_msg_allocate             0      0     20
       -> osal_msg_send                 0      0     20
     ZDO_JoinIndicationCB               0      0      1
     ZDO_LeaveCnf                       0      0     14
       -> NLME_GetExtAddr               0      0     20
       -> sAddrExtCmp                   0      0     20
       -> osal_nv_write                 0      0     28
       -> osal_start_timerEx            0      0     20
       -> NLME_RemoveChild              0      0     20
     ZDO_LeaveInd                       1      0     18
       -> NLME_LeaveRsp                 0      0     28
       -> NLME_GetCoordShortAddr        0      0     28
       -> osal_nv_write                 0      0     36
       -> osal_start_timerEx            0      0     28
       -> NLME_RemoveChild              0      0     28
     ZDO_ManytoOneFailureIndicationCB
                                        2      0      0
       -> RTG_MTORouteReq               4      0      0
     ZDO_NetworkDiscoveryConfirmCB      1      0     32
       -> nwk_ExtPANIDValid             0      0     58
       -> sAddrExtCmp                   0      0     58
       -> sAddrExtCpy                   0      0     58
       -> osal_msg_allocate             0      0     58
       -> osal_memcpy                   0      0     64
       -> osal_msg_send                 0      0     58
     ZDO_NetworkFormationConfirmCB      0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_PollConfirmCB                  0      0      0
     ZDO_RegisterForZdoCB               2      0      0
     ZDO_SrcRtgIndCB                    1      0     14
     ZDO_StartRouterConfirmCB           0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_SyncIndicationCB               0      0     10
       -> nwkNeighborInitTable          0      0     20
       -> osal_msg_allocate             0      0     20
       -> osal_msg_send                 0      0     20
     ZDO_UpdateDeviceIndication         0      0      0


   Segment part sizes:

     Function/Label                              Bytes
     --------------                              -----
     _A_IEN0                                        1
     WDCTL                                          1
     MatchRsps                                      1
     zdoDiscCounter                                 1
     ZDAppNwkAddr                                   9
     zdappMgmtNwkDiscRspTransSeq                    1
     zdappMgmtNwkDiscReqInProgress                  1
     zdappMgmtNwkDiscRspAddr                        9
     zdappMgmtNwkDiscStartIndex                     1
     zdappMgmtSavedNwkState                         1
     nwkFrameCounterChanges                         2
     continueJoining                                1
     _tmpRejoinState                                1
     ZDO_UseExtendedPANID                           8
     zdoCBFunc                                      2
     ZDAppTaskID                                    1
     nwkStatus                                      1
     ZDApp_AutoFindMode_epDesc                      2
     ZDApp_LeaveCtrl                                1
     devState                                       1
     devStartMode                                   1
     retryCnt                                       1
     ZDApp_epDesc                                   6
     ZDApp_SavedPollRate                            2
     ZDApp_Init                                   133
     ??Subroutine7_0                                5
     ZDApp_SecInit                                 11
     ZDApp_event_loop                             229
     ??Subroutine10_0                               5
     ZDApp_ProcessSecEvent                        200
     ?Subroutine2                                   2
     ??Subroutine9_0                                8
     ZDOInitDevice                                276
     ZDApp_ReadNetworkRestoreState                 20
     ZDAppDetermineDeviceType                      74
     ?Subroutine3                                   7
     ZDApp_NetworkStartEvt                         86
     ZDApp_DeviceAuthEvt                          223
     ZDApp_SaveNetworkStateEvt                      3
     ZDApp_RestoreNetworkState                     80
     ZDApp_InitUserDesc                           120
     ??Subroutine8_0                                6
     ZDAppCheckForHoldKey                          20
     ZDApp_ProcessOSALMsg                         791
     ?Subroutine6                                   2
     ZDApp_ProcessMsgCBs                          135
     ZDApp_RegisterCBs                             55
     ZDApp_ProcessSecMsg                           73
     ZDApp_ProcessNetworkJoin                     639
     ZDApp_SaveNwkKey                              92
     ZDApp_ResetNwkKey                             76
     ZDApp_RestoreNwkKey                          110
     ZDApp_ResetTimerStart                         23
     ZDApp_ResetTimerCancel                        19
     ZDApp_LeaveCtrlInit                           74
     ZDApp_LeaveCtrlSet                            57
     ZDApp_LeaveCtrlBypass                         13
     ZDApp_LeaveCtrlStartup                        89
     ZDApp_LeaveReset                              76
     ZDApp_LeaveUpdate                             15
     ZDApp_SendEventMsg                            96
     ?Subroutine5                                   5
     ZDApp_SendMsg                                 96
     ZDO_NetworkDiscoveryConfirmCB                443
     ?Subroutine0                                  10
     ZDO_NetworkFormationConfirmCB                 49
     ZDO_StartRouterConfirmCB                      49
     ZDO_JoinConfirmCB                             77
     ?Subroutine1                                  51
     ZDO_AddrChangeIndicationCB                    20
     ZDO_JoinIndicationCB                           0
     ?Subroutine4                                   5
     ZDO_ConcentratorIndicationCB                   3
     ZDO_LeaveCnf                                 144
     ZDO_LeaveInd                                 245
     ZDO_SyncIndicationCB                          56
     ZDO_ManytoOneFailureIndicationCB
                                                   10
     ZDO_PollConfirmCB                              3
     AddrMgrWriteNVRequest                          3
     ZDO_UpdateDeviceIndication                     3
     ZDApp_InMsgCB                                118
     ZDApp_ChangeMatchDescRespPermission
                                                   11
     ZDApp_NetworkInit                             41
     ZDApp_NwkStateUpdateCB                        19
     ZDApp_NodeProfileSync                        102
     ZDApp_StartJoiningCycle                       43
     ZDApp_StopJoiningCycle                        31
     ZDApp_AnnounceNewAddress                       8
     ZDApp_NVUpdate                                 3
     ZDApp_CoordStartPANIDConflictCB
                                                   11
     ZDO_SrcRtgIndCB                               79
     ZDO_RegisterForZdoCB                          24
     ?<Initializer for zdoDiscCounter>              1
     ?<Initializer for continueJoining>             1
     ?<Initializer for devState>                    1
     ?<Initializer for ZDApp_epDesc>                6
     ?<Initializer for ZDApp_SavedPollRate>         2
     __Constant_1                                   4
     __Constant_3e8                                 4
     ??ZDApp_Init?relay                             6
     ??ZDApp_SecInit?relay                          6
     ??ZDApp_event_loop?relay                       6
     ??ZDApp_ProcessSecEvent?relay                  6
     ??ZDOInitDevice?relay                          6
     ??ZDApp_ReadNetworkRestoreState?relay          6
     ??ZDAppDetermineDeviceType?relay               6
     ??ZDApp_NetworkStartEvt?relay                  6
     ??ZDApp_DeviceAuthEvt?relay                    6
     ??ZDApp_SaveNetworkStateEvt?relay              6
     ??ZDApp_RestoreNetworkState?relay              6
     ??ZDApp_InitUserDesc?relay                     6
     ??ZDAppCheckForHoldKey?relay                   6
     ??ZDApp_ProcessOSALMsg?relay                   6
     ??ZDApp_ProcessMsgCBs?relay                    6
     ??ZDApp_RegisterCBs?relay                      6
     ??ZDApp_ProcessSecMsg?relay                    6
     ??ZDApp_ProcessNetworkJoin?relay               6
     ??ZDApp_SaveNwkKey?relay                       6
     ??ZDApp_ResetNwkKey?relay                      6
     ??ZDApp_RestoreNwkKey?relay                    6
     ??ZDApp_ResetTimerStart?relay                  6
     ??ZDApp_ResetTimerCancel?relay                 6
     ??ZDApp_LeaveCtrlInit?relay                    6
     ??ZDApp_LeaveCtrlSet?relay                     6
     ??ZDApp_LeaveCtrlBypass?relay                  6
     ??ZDApp_LeaveCtrlStartup?relay                 6
     ??ZDApp_LeaveReset?relay                       6
     ??ZDApp_LeaveUpdate?relay                      6
     ??ZDApp_SendEventMsg?relay                     6
     ??ZDApp_SendMsg?relay                          6
     ??ZDO_NetworkDiscoveryConfirmCB?relay          6
     ??ZDO_NetworkFormationConfirmCB?relay          6
     ??ZDO_StartRouterConfirmCB?relay               6
     ??ZDO_JoinConfirmCB?relay                      6
     ??ZDO_AddrChangeIndicationCB?relay             6
     ??ZDO_JoinIndicationCB?relay                   6
     ??ZDO_ConcentratorIndicationCB?relay           6
     ??ZDO_LeaveCnf?relay                           6
     ??ZDO_LeaveInd?relay                           6
     ??ZDO_SyncIndicationCB?relay                   6
     ??ZDO_ManytoOneFailureIndicationCB?relay       6
     ??ZDO_PollConfirmCB?relay                      6
     ??AddrMgrWriteNVRequest?relay                  6
     ??ZDO_UpdateDeviceIndication?relay             6
     ??ZDApp_InMsgCB?relay                          6
     ??ZDApp_ChangeMatchDescRespPermission?relay    6
     ??ZDApp_NetworkInit?relay                      6
     ??ZDApp_NwkStateUpdateCB?relay                 6
     ??ZDApp_NodeProfileSync?relay                  6
     ??ZDApp_StartJoiningCycle?relay                6
     ??ZDApp_StopJoiningCycle?relay                 6
     ??ZDApp_AnnounceNewAddress?relay               6
     ??ZDApp_NVUpdate?relay                         6
     ??ZDApp_CoordStartPANIDConflictCB?relay        6
     ??ZDO_SrcRtgIndCB?relay                        6
     ??ZDO_RegisterForZdoCB?relay                   6

 
 5 705 bytes in segment BANKED_CODE
   342 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
    11 bytes in segment XDATA_I
    11 bytes in segment XDATA_ID
     8 bytes in segment XDATA_ROM_C
    43 bytes in segment XDATA_Z
 
 6 058 bytes of CODE  memory
     0 bytes of CONST memory (+ 8 bytes shared)
     0 bytes of DATA  memory (+ 2 bytes shared)
    54 bytes of XDATA memory

Errors: none
Warnings: none
