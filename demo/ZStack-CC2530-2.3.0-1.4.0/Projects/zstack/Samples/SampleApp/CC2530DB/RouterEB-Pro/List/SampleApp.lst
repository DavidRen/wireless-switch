###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         23/May/2015  15:27:33 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\Source\SampleApp #
#                          .c                                                 #
#    Command line       =  -f E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4 #
#                          .0\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\Tools\CC2530DB\f8wRouter.cfg (-DCPU32MHZ      #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DRTR_NWK -DBLINK_LEDS) -f                       #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\Tools\CC2530DB\f8wConfig.cfg (-DSECURE=0         #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF1                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\Source\SampleApp #
#                          .c -D ZIGBEEPRO -D ZTOOL_P1 -D MT_TASK -D          #
#                          MT_SYS_FUNC -D MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG  #
#                          -D ROUTER_ME -lC E:\wireless-switch\demo\ZStack-CC #
#                          2530-2.3.0-1.4.0\Projects\zstack\Samples\SampleApp #
#                          \CC2530DB\RouterEB-Pro\List\ -lA                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\List\ --diag_suppress Pe001,Pa010 -o         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\Obj\ -e --debug --core=plain --dptr=16,1     #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4 #
#                          .0\Projects\zstack\Samples\SampleApp\CC2530DB\ -I  #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\SOUR #
#                          CE\ -I E:\wireless-switch\demo\ZStack-CC2530-2.3.0 #
#                          -1.4.0\Projects\zstack\Samples\SampleApp\CC2530DB\ #
#                          ..\..\..\ZMAIN\TI2530DB\ -I                        #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MT\ -I                          #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\HAL\INCLUDE\ -I                 #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\HAL\TARGET\CC2530EB\ -I         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\OSAL\MCU\CCSOC\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\OSAL\INCLUDE\ -I                #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\AF\ -I                    #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\NWK\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SEC\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SAPI\ -I                  #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\SYS\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\STACK\ZDO\ -I                   #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\ZMAC\F8W\ -I                    #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\ZMAC\ -I                        #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\SERVICES\SADDR\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\SERVICES\SDATA\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\INCLUDE\ -I                 #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\HIGH_LEVEL\ -I              #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\ -I         #
#                          E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\..\..\. #
#                          .\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP #
#                          \ -Ohs --require_prototypes                        #
#    List file          =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\List\SampleApp.lst                           #
#    Object file        =  E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\ #
#                          Projects\zstack\Samples\SampleApp\CC2530DB\RouterE #
#                          B-Pro\Obj\SampleApp.r51                            #
#                                                                             #
#                                                                             #
###############################################################################

E:\wireless-switch\demo\ZStack-CC2530-2.3.0-1.4.0\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
      1          /**************************************************************************************************
      2            Filename:       SampleApp.c
      3            Revised:        $Date: 2009-03-18 15:56:27 -0700 (Wed, 18 Mar 2009) $
      4            Revision:       $Revision: 19453 $
      5          
      6            Description:    Sample Application (no Profile).
      7          
      8          
      9            Copyright 2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This application isn't intended to do anything useful, it is
     42            intended to be a simple example of an application's structure.
     43          
     44            This application sends it's messages either as broadcast or
     45            broadcast filtered group messages.  The other (more normal)
     46            message addressing is unicast.  Most of the other sample
     47            applications are written to support the unicast message model.
     48          
     49            Key control:
     50              SW1:  Sends a flash command to all devices in Group 1.
     51              SW2:  Adds/Removes (toggles) this device in and out
     52                    of Group 1.  This will enable and disable the
     53                    reception of the flash command.
     54          *********************************************************************/
     55          
     56          /*********************************************************************
     57           * INCLUDES
     58           */
     59          #include "OSAL.h"
     60          #include "ZGlobals.h"
     61          #include "AF.h"
     62          #include "aps_groups.h"
     63          #include "ZDApp.h"
     64          
     65          #include "SampleApp.h"
     66          #include "SampleAppHw.h"
     67          
     68          #include "OnBoard.h"
     69          #include "Hal_flash.h"
     70          /* HAL */
     71          #include "hal_lcd.h"
     72          #include "hal_led.h"
     73          #include "hal_key.h"
     74          #include "MT_UART.h"
     75          #include "MT_APP.h"
     76          #include "MT.h"
     77          #include "OSAL_Nv.h"
     78          #include <string.h>
     79          #include "zigbee_wrt_protocol.h"
     80          
     81          #define TEST_NV 0x0202
     82          
     83          /*********************************************************************
     84           * MACROS
     85           */
     86          
     87          /*********************************************************************
     88           * CONSTANTS
     89           */
     90          
     91          /*********************************************************************
     92           * TYPEDEFS
     93           */
     94          
     95          /*********************************************************************
     96           * GLOBAL VARIABLES
     97           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     98          uint8 globa_run_num = 0;
   \                     globa_run_num:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     99          uint8 Calc_CRC8(uint8 *PData, uint32 Len);
    100          // This list should be filled with Application specific Cluster IDs.

   \                                 In  segment XDATA_ROM_C, align 1
    101          const cId_t SampleApp_ClusterList[SAMPLEAPP_MAX_CLUSTERS] =
   \                     SampleApp_ClusterList:
   \   000000   0100         DW 1
   \   000002   0200         DW 2
    102          {
    103            SAMPLEAPP_PERIODIC_CLUSTERID,
    104            SAMPLEAPP_FLASH_CLUSTERID
    105          };
    106          

   \                                 In  segment XDATA_ROM_C, align 1
    107          const SimpleDescriptionFormat_t SampleApp_SimpleDesc =
   \                     SampleApp_SimpleDesc:
   \   000000   14           DB 20
   \   000001   080F         DW 3848
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   02           DB 2
   \   000007   ....         DW SampleApp_ClusterList
   \   000009   02           DB 2
   \   00000A   ....         DW SampleApp_ClusterList
    108          {
    109            SAMPLEAPP_ENDPOINT,              //  int Endpoint;
    110            SAMPLEAPP_PROFID,                //  uint16 AppProfId[2];
    111            SAMPLEAPP_DEVICEID,              //  uint16 AppDeviceId[2];
    112            SAMPLEAPP_DEVICE_VERSION,        //  int   AppDevVer:4;
    113            SAMPLEAPP_FLAGS,                 //  int   AppFlags:4;
    114            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    115            (cId_t *)SampleApp_ClusterList,  //  uint8 *pAppInClusterList;
    116            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    117            (cId_t *)SampleApp_ClusterList   //  uint8 *pAppInClusterList;
    118          };
    119          
    120          // This is the Endpoint/Interface description.  It is defined here, but
    121          // filled-in in SampleApp_Init().  Another way to go would be to fill
    122          // in the structure here and make it a "const" (in code space).  The
    123          // way it's defined in this sample app it is define in RAM.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    124          endPointDesc_t SampleApp_epDesc;
   \                     SampleApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
    125          
    126          /*********************************************************************
    127           * EXTERNAL VARIABLES
    128           */
    129          
    130          /*********************************************************************
    131           * EXTERNAL FUNCTIONS
    132           */
    133          
    134          /*********************************************************************
    135           * LOCAL VARIABLES
    136           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    137          uint8 SampleApp_TaskID;   // Task ID for internal task/event processing
   \                     SampleApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    138                                    // This variable will be received when
    139                                    // SampleApp_Init() is called.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    140          devStates_t SampleApp_NwkState;
   \                     SampleApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    141          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    142          uint8 SampleApp_TransID;  // This is the unique message ID (counter)
   \                     SampleApp_TransID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    143          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    144          afAddrType_t SampleApp_Periodic_DstAddr;
   \                     SampleApp_Periodic_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    145          afAddrType_t SampleApp_Flash_DstAddr;
   \                     SampleApp_Flash_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    146          afAddrType_t SampleApp_P2P_DstAddr;
   \                     SampleApp_P2P_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    147          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    148          aps_Group_t SampleApp_Group;
   \                     SampleApp_Group:
   \   000000                DS 18
   \   000012                REQUIRE __INIT_XDATA_Z
    149          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    150          uint8 SampleAppPeriodicCounter = 0;
   \                     SampleAppPeriodicCounter:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    151          uint8 SampleAppFlashCounter = 0;
   \                     SampleAppFlashCounter:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    152          
    153          /*********************************************************************
    154           * LOCAL FUNCTIONS
    155           */
    156          void SampleApp_HandleKeys( uint8 shift, uint8 keys );
    157          void SampleApp_MessageMSGCB( afIncomingMSGPacket_t *pckt );
    158          void SampleApp_SendPeriodicMessage( void );
    159          void SampleApp_SendFlashMessage( uint16 flashTime );
    160          void AF_TO_C_FRM_R_Message(void);
    161          void  AF_To_R_From_C(afAddrType_t *srcAddr,char *pdata, uint16 len);
    162          
    163          /*********************************************************************
    164           * NETWORK LAYER CALLBACKS
    165           */
    166          
    167          
    168          /*********************************************************************
    169           * PUBLIC FUNCTIONS
    170           */
    171          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    172          void deal_data(char *pData, uint16 dataLen)
   \                     deal_data:
    173          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    174                
    175            HalUARTWrite(0, (uint8*)pData, dataLen);//串口发送
   \   000004                ; Setup parameters for call to function HalUARTWrite
   \   000004   7900         MOV     R1,#0x0
   \   000006   12....       LCALL   ??HalUARTWrite?relay
    176            AF_TO_C_FRM_R_Message();
   \   000009                ; Setup parameters for call to function AF_TO_C_FRM_R_Message
   \   000009   12....       LCALL   ??AF_TO_C_FRM_R_Message?relay
    177          }
   \   00000C                REQUIRE ?Subroutine0
   \   00000C                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    178          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    179          void  AF_To_R_From_C(afAddrType_t *srcAddr,char *pdata, uint16 len)
   \                     AF_To_R_From_C:
    180          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   740C         MOV     A,#0xc
   \   000007   12....       LCALL   ?XSTACK_DISP0_8
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F5..         MOV     ?V0 + 2,A
   \   00000D   A3           INC     DPTR
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F5..         MOV     ?V0 + 3,A
    181          //	uint8    tmp_buf[5];
    182          //	tmp_buf[0] = 0x01;
    183          //	tmp_buf[1] = 0x02;
    184          //	tmp_buf[2] = 0x03;
    185          //	tmp_buf[3] = 0x04;
    186          
    187          	if ( AF_DataRequest( srcAddr, &SampleApp_epDesc,
    188          						 3,						
    189          						 len,
    190          						 (uint8 *)pdata,
    191          						 &SampleApp_TransID,
    192          						 AF_DISCV_ROUTE,
    193          						 AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   000011                ; Setup parameters for call to function AF_DataRequest
   \   000011   75..1E       MOV     ?V0 + 0,#0x1e
   \   000014   78..         MOV     R0,#?V0 + 0
   \   000016   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000019   75....       MOV     ?V0 + 0,#SampleApp_TransID & 0xff
   \   00001C   75....       MOV     ?V0 + 1,#(SampleApp_TransID >> 8) & 0xff
   \   00001F   78..         MOV     R0,#?V0 + 0
   \   000021   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000024   8C..         MOV     ?V0 + 0,R4
   \   000026   8D..         MOV     ?V0 + 1,R5
   \   000028   78..         MOV     R0,#?V0 + 0
   \   00002A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002D   78..         MOV     R0,#?V0 + 2
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   75..03       MOV     ?V0 + 0,#0x3
   \   000035   75..00       MOV     ?V0 + 1,#0x0
   \   000038   78..         MOV     R0,#?V0 + 0
   \   00003A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003D   7920         MOV     R1,#0x20
   \   00003F   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   000041   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   000043   12....       LCALL   ??AF_DataRequest?relay
   \   000046   7409         MOV     A,#0x9
   \   000048   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004B   E9           MOV     A,R1
   \   00004C   700D         JNZ     ??AF_To_R_From_C_0
    194          	{
    195          		HalLedBlink(HAL_LED_2, 2, 50, 1000);
   \   00004E                ; Setup parameters for call to function HalLedBlink
   \   00004E   7CE8         MOV     R4,#-0x18
   \   000050   7D03         MOV     R5,#0x3
   \   000052   7B32         MOV     R3,#0x32
   \   000054   7A02         MOV     R2,#0x2
   \   000056   7902         MOV     R1,#0x2
   \   000058   12....       LCALL   ??HalLedBlink?relay
    196          	}
    197          	else
    198          	{
    199          	  // Error occurred in request to send.
    200          	}
    201          }
   \                     ??AF_To_R_From_C_0:
   \   00005B                REQUIRE ?Subroutine1
   \   00005B                ; // Fall through to label ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    202          
    203          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    204          uint8 uart_data_buffer[50];
   \                     uart_data_buffer:
   \   000000                DS 50
   \   000032                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    205          static void SerialApp_CallBack(uint8 port, uint8 event)
   \                     SerialApp_CallBack:
    206          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
    207            (void)port;
    208          	
    209            if ((event & (HAL_UART_RX_FULL | HAL_UART_RX_ABOUT_FULL | HAL_UART_RX_TIMEOUT)))
   \   000007   7407         MOV     A,#0x7
   \   000009   5E           ANL     A,R6
   \   00000A   7003         JNZ     $+5
   \   00000C   02....       LJMP    ??SerialApp_CallBack_0 & 0xFFFF
    210             {
    211                 // HalUARTRead(SERIAL_APP_PORT, SerialApp_TxBuf+SerialApp_TxLen+1,
    212                  //                                            SERIAL_APP_TX_MAX-SerialApp_TxLen);
    213          	
    214          	  uint8 crc_t; 
    215                uint8 *data;
    216                Zg_Header_Struct *ph;
    217                     Msg_Zg_WRT_transfer *mzwt;
    218          	  HalLedSet(HAL_LED_2, HAL_LED_MODE_TOGGLE);
   \   00000F                ; Setup parameters for call to function HalLedSet
   \   00000F   7A08         MOV     R2,#0x8
   \   000011   7902         MOV     R1,#0x2
   \   000013   12....       LCALL   ??HalLedSet?relay
    219                HalUARTRead(0, uart_data_buffer,sizeof(uart_data_buffer));
   \   000016                ; Setup parameters for call to function HalUARTRead
   \   000016   7C32         MOV     R4,#0x32
   \   000018   7D00         MOV     R5,#0x0
   \   00001A   7A..         MOV     R2,#uart_data_buffer & 0xff
   \   00001C   7B..         MOV     R3,#(uart_data_buffer >> 8) & 0xff
   \   00001E   7900         MOV     R1,#0x0
   \   000020   12....       LCALL   ??HalUARTRead?relay
    220          	  ph  = (Zg_Header_Struct *)uart_data_buffer;
    221          	  crc_t = Calc_CRC8(uart_data_buffer + sizeof(Zg_Header_Struct),ph->msg_len);
   \   000023                ; Setup parameters for call to function Calc_CRC8
   \   000023   90....       MOV     DPTR,#uart_data_buffer + 5
   \   000026   E0           MOVX    A,@DPTR
   \   000027   F5..         MOV     ?V0 + 0,A
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F5..         MOV     ?V0 + 1,A
   \   00002D   E4           CLR     A
   \   00002E   F5..         MOV     ?V0 + 2,A
   \   000030   F5..         MOV     ?V0 + 3,A
   \   000032   78..         MOV     R0,#?V0 + 0
   \   000034   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   000037   7A..         MOV     R2,#(uart_data_buffer + 8) & 0xff
   \   000039   7B..         MOV     R3,#((uart_data_buffer + 8) >> 8) & 0xff
   \   00003B   12....       LCALL   ??Calc_CRC8?relay
   \   00003E   7404         MOV     A,#0x4
   \   000040   12....       LCALL   ?DEALLOC_XSTACK8
   \   000043   E9           MOV     A,R1
   \   000044   F8           MOV     R0,A
    222          	 
    223          	if(ph->crc8 == crc_t)
   \   000045   90....       MOV     DPTR,#uart_data_buffer + 7
   \   000048   E0           MOVX    A,@DPTR
   \   000049   68           XRL     A,R0
   \   00004A   6003         JZ      $+5
   \   00004C   02....       LJMP    ??SerialApp_CallBack_0 & 0xFFFF
    224          	 {
    225          		switch(ph->msg_cmd)
   \   00004F   90....       MOV     DPTR,#uart_data_buffer + 3
   \   000052   E0           MOVX    A,@DPTR
   \   000053   F5..         MOV     ?V0 + 0,A
   \   000055   A3           INC     DPTR
   \   000056   E0           MOVX    A,@DPTR
   \   000057   F5..         MOV     ?V0 + 1,A
   \   000059   78..         MOV     R0,#?V0 + 0
   \   00005B   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for SerialApp_CallBack>_0`:
   \   00005E   0000         DW        0
   \   000060   0200         DW        2
   \   000062   0200         DW        2
   \   000064   ....         DW        ??SerialApp_CallBack_1
   \   000066   0280         DW        32770
   \   000068   ....         DW        ??SerialApp_CallBack_2
   \   00006A   ....         DW        ??SerialApp_CallBack_0
    226          		{
    227          			case WRT_ZGB_DATA_CMD:
    228          				mzwt = (Msg_Zg_WRT_transfer *)(uart_data_buffer + sizeof(Zg_Header_Struct));
    229                          data = (uint8 *)(uart_data_buffer + sizeof(Zg_Header_Struct) +sizeof(Msg_Zg_WRT_transfer));
    230          //				deal_data(data,ph->msg_len - sizeof(Msg_Zg_WRT_transfer));				
    231          				AF_To_R_From_C(&mzwt->end_dev_addr,(char*)data, ph->msg_len - sizeof(Msg_Zg_WRT_transfer) );
   \                     ??SerialApp_CallBack_2:
   \   00006C                ; Setup parameters for call to function AF_DataRequest
   \   00006C   75..1E       MOV     ?V0 + 0,#0x1e
   \   00006F   78..         MOV     R0,#?V0 + 0
   \   000071   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000074   75....       MOV     ?V0 + 0,#SampleApp_TransID & 0xff
   \   000077   75....       MOV     ?V0 + 1,#(SampleApp_TransID >> 8) & 0xff
   \   00007A   78..         MOV     R0,#?V0 + 0
   \   00007C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00007F   75....       MOV     ?V0 + 0,#(uart_data_buffer + 23) & 0xff
   \   000082   75....       MOV     ?V0 + 1,#((uart_data_buffer + 23) >> 8) & 0xff
   \   000085   78..         MOV     R0,#?V0 + 0
   \   000087   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008A   90....       MOV     DPTR,#uart_data_buffer + 5
   \   00008D   E0           MOVX    A,@DPTR
   \   00008E   24F1         ADD     A,#-0xf
   \   000090   F5..         MOV     ?V0 + 0,A
   \   000092   A3           INC     DPTR
   \   000093   E0           MOVX    A,@DPTR
   \   000094   34FF         ADDC    A,#-0x1
   \   000096   F5..         MOV     ?V0 + 1,A
   \   000098   78..         MOV     R0,#?V0 + 0
   \   00009A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009D   75..03       MOV     ?V0 + 0,#0x3
   \   0000A0   75..00       MOV     ?V0 + 1,#0x0
   \   0000A3   78..         MOV     R0,#?V0 + 0
   \   0000A5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A8   7920         MOV     R1,#0x20
   \   0000AA   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   0000AC   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   0000AE   7A..         MOV     R2,#(uart_data_buffer + 9) & 0xff
   \   0000B0   7B..         MOV     R3,#((uart_data_buffer + 9) >> 8) & 0xff
   \   0000B2   12....       LCALL   ??AF_DataRequest?relay
   \   0000B5   7409         MOV     A,#0x9
   \   0000B7   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000BA   E9           MOV     A,R1
   \   0000BB   7012         JNZ     ??SerialApp_CallBack_0
   \   0000BD                ; Setup parameters for call to function HalLedBlink
   \   0000BD   7CE8         MOV     R4,#-0x18
   \   0000BF   7D03         MOV     R5,#0x3
   \   0000C1   7B32         MOV     R3,#0x32
   \   0000C3   7A02         MOV     R2,#0x2
   \   0000C5   7902         MOV     R1,#0x2
   \   0000C7   12....       LCALL   ??HalLedBlink?relay
   \   0000CA   8003         SJMP    ??SerialApp_CallBack_0
    232          				break;
    233          			case ZGB_WRT_DATA_CMD:
    234          				AF_TO_C_FRM_R_Message();
   \                     ??SerialApp_CallBack_1:
   \   0000CC                ; Setup parameters for call to function AF_TO_C_FRM_R_Message
   \   0000CC   12....       LCALL   ??AF_TO_C_FRM_R_Message?relay
    235          				break;
    236          			default:
    237          				break;
    238          		}
    239          	}
    240          
    241             }
    242          
    243          }
   \                     ??SerialApp_CallBack_0:
   \   0000CF   02....       LJMP    ?Subroutine1 & 0xFFFF
    244          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    245          int  pack_msg_transfer(Msg_Zg_WRT_transfer *mzwt,uint8 *pdata,uint16 dataLen, char *pout)
   \                     pack_msg_transfer:
    246          {
   \   000000   74ED         MOV     A,#-0x13
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 8
   \   000005   74F8         MOV     A,#-0x8
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8C..         MOV     ?V0 + 8,R4
   \   00000C   8D..         MOV     ?V0 + 9,R5
   \   00000E   741B         MOV     A,#0x1b
   \   000010   12....       LCALL   ?XSTACK_DISP0_8
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F5..         MOV     ?V0 + 0,A
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   F5..         MOV     ?V0 + 1,A
   \   00001A   741D         MOV     A,#0x1d
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   FE           MOV     R6,A
   \   000021   A3           INC     DPTR
   \   000022   E0           MOVX    A,@DPTR
   \   000023   FF           MOV     R7,A
    247              char *pt;
    248              pt = pout;
    249          	Zg_Header_Struct hd;
    250          	
    251          	hd.head = 0x7e7e;
   \   000024   85..82       MOV     DPL,?XSP + 0
   \   000027   85..83       MOV     DPH,?XSP + 1
   \   00002A   747E         MOV     A,#0x7e
   \   00002C   F0           MOVX    @DPTR,A
   \   00002D   A3           INC     DPTR
   \   00002E   F0           MOVX    @DPTR,A
    252          	hd.msg_serial_num = globa_run_num++;
   \   00002F   90....       MOV     DPTR,#globa_run_num
   \   000032   E0           MOVX    A,@DPTR
   \   000033   C0E0         PUSH    A
   \   000035   7402         MOV     A,#0x2
   \   000037   12....       LCALL   ?XSTACK_DISP0_8
   \   00003A   D0E0         POP     A
   \   00003C   F0           MOVX    @DPTR,A
   \   00003D   90....       MOV     DPTR,#globa_run_num
   \   000040   E0           MOVX    A,@DPTR
   \   000041   04           INC     A
   \   000042   F0           MOVX    @DPTR,A
    253          	hd.msg_cmd = ZGB_WRT_DATA_CMD;
   \   000043   7403         MOV     A,#0x3
   \   000045   12....       LCALL   ?XSTACK_DISP0_8
   \   000048   7402         MOV     A,#0x2
   \   00004A   F0           MOVX    @DPTR,A
   \   00004B   A3           INC     DPTR
   \   00004C   E4           CLR     A
   \   00004D   F0           MOVX    @DPTR,A
    254          	hd.msg_len = sizeof(Msg_Zg_WRT_transfer) + dataLen;// point size is 2 byte
   \   00004E   E5..         MOV     A,?V0 + 0
   \   000050   240F         ADD     A,#0xf
   \   000052   F8           MOV     R0,A
   \   000053   E5..         MOV     A,?V0 + 1
   \   000055   3400         ADDC    A,#0x0
   \   000057   F9           MOV     R1,A
   \   000058   7405         MOV     A,#0x5
   \   00005A   12....       LCALL   ?XSTACK_DISP0_8
   \   00005D   E8           MOV     A,R0
   \   00005E   F0           MOVX    @DPTR,A
   \   00005F   A3           INC     DPTR
   \   000060   E9           MOV     A,R1
   \   000061   F0           MOVX    @DPTR,A
    255          	pt += sizeof(Zg_Header_Struct);
   \   000062   EE           MOV     A,R6
   \   000063   2408         ADD     A,#0x8
   \   000065   F5..         MOV     ?V0 + 2,A
   \   000067   EF           MOV     A,R7
   \   000068   3400         ADDC    A,#0x0
   \   00006A   F5..         MOV     ?V0 + 3,A
    256          
    257          	
    258          	osal_memcpy(pt,(char *)mzwt, sizeof(Msg_Zg_WRT_transfer));
   \   00006C                ; Setup parameters for call to function osal_memcpy
   \   00006C   8A..         MOV     ?V0 + 4,R2
   \   00006E   8B..         MOV     ?V0 + 5,R3
   \   000070   75..00       MOV     ?V0 + 6,#0x0
   \   000073   78..         MOV     R0,#?V0 + 4
   \   000075   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000078   7C0F         MOV     R4,#0xf
   \   00007A   7D00         MOV     R5,#0x0
   \   00007C   AA..         MOV     R2,?V0 + 2
   \   00007E   AB..         MOV     R3,?V0 + 3
   \   000080   12....       LCALL   ??osal_memcpy?relay
   \   000083   7403         MOV     A,#0x3
   \   000085   12....       LCALL   ?DEALLOC_XSTACK8
    259          	pt += sizeof(Msg_Zg_WRT_transfer);
    260          	osal_memcpy(pt,pdata, dataLen);	
   \   000088                ; Setup parameters for call to function osal_memcpy
   \   000088   75..00       MOV     ?V0 + 10,#0x0
   \   00008B   78..         MOV     R0,#?V0 + 8
   \   00008D   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000090   AC..         MOV     R4,?V0 + 0
   \   000092   AD..         MOV     R5,?V0 + 1
   \   000094   E5..         MOV     A,?V0 + 2
   \   000096   240F         ADD     A,#0xf
   \   000098   FA           MOV     R2,A
   \   000099   E5..         MOV     A,?V0 + 3
   \   00009B   3400         ADDC    A,#0x0
   \   00009D   FB           MOV     R3,A
   \   00009E   12....       LCALL   ??osal_memcpy?relay
   \   0000A1   7403         MOV     A,#0x3
   \   0000A3   12....       LCALL   ?DEALLOC_XSTACK8
    261          	pt += dataLen;
    262          
    263          	hd.crc8 = Calc_CRC8((uint8 *)pout+sizeof(hd), hd.msg_len);
   \   0000A6                ; Setup parameters for call to function Calc_CRC8
   \   0000A6   7405         MOV     A,#0x5
   \   0000A8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AB   E0           MOVX    A,@DPTR
   \   0000AC   F5..         MOV     ?V0 + 0,A
   \   0000AE   A3           INC     DPTR
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   F5..         MOV     ?V0 + 1,A
   \   0000B2   E4           CLR     A
   \   0000B3   F5..         MOV     ?V0 + 2,A
   \   0000B5   F5..         MOV     ?V0 + 3,A
   \   0000B7   78..         MOV     R0,#?V0 + 0
   \   0000B9   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   0000BC   EE           MOV     A,R6
   \   0000BD   2408         ADD     A,#0x8
   \   0000BF   FA           MOV     R2,A
   \   0000C0   EF           MOV     A,R7
   \   0000C1   3400         ADDC    A,#0x0
   \   0000C3   FB           MOV     R3,A
   \   0000C4   12....       LCALL   ??Calc_CRC8?relay
   \   0000C7   7404         MOV     A,#0x4
   \   0000C9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000CC   7407         MOV     A,#0x7
   \   0000CE   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D1   E9           MOV     A,R1
   \   0000D2   F0           MOVX    @DPTR,A
    264          	osal_memcpy(pout,(char *)&hd, sizeof(Zg_Header_Struct));
   \   0000D3                ; Setup parameters for call to function osal_memcpy
   \   0000D3   85..82       MOV     DPL,?XSP + 0
   \   0000D6   85..83       MOV     DPH,?XSP + 1
   \   0000D9   A982         MOV     R1,DPL
   \   0000DB   AA83         MOV     R2,DPH
   \   0000DD   89..         MOV     ?V0 + 0,R1
   \   0000DF   8A..         MOV     ?V0 + 1,R2
   \   0000E1   78..         MOV     R0,#?V0 + 0
   \   0000E3   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000E6   7C08         MOV     R4,#0x8
   \   0000E8   7D00         MOV     R5,#0x0
   \   0000EA   EE           MOV     A,R6
   \   0000EB   FA           MOV     R2,A
   \   0000EC   EF           MOV     A,R7
   \   0000ED   FB           MOV     R3,A
   \   0000EE   12....       LCALL   ??osal_memcpy?relay
   \   0000F1   7403         MOV     A,#0x3
   \   0000F3   12....       LCALL   ?DEALLOC_XSTACK8
    265          
    266          	return hd.msg_len + sizeof(Zg_Header_Struct);
   \   0000F6   7405         MOV     A,#0x5
   \   0000F8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000FB   E0           MOVX    A,@DPTR
   \   0000FC   2408         ADD     A,#0x8
   \   0000FE   FA           MOV     R2,A
   \   0000FF   A3           INC     DPTR
   \   000100   E0           MOVX    A,@DPTR
   \   000101   3400         ADDC    A,#0x0
   \   000103   FB           MOV     R3,A
   \   000104   7408         MOV     A,#0x8
   \   000106   12....       LCALL   ?DEALLOC_XSTACK8
   \   000109   7F0B         MOV     R7,#0xb
   \   00010B   02....       LJMP    ?BANKED_LEAVE_XDATA
    267                  
    268                  
    269                 
    270          }
    271          
    272          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    273          int unpack_msg(char *pdata, int len)
   \                     unpack_msg:
    274          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    275          	Zg_Header_Struct *hd;
    276          	if(len < sizeof(Zg_Header_Struct))
   \   000000   C3           CLR     C
   \   000001   EC           MOV     A,R4
   \   000002   9408         SUBB    A,#0x8
   \   000004   ED           MOV     A,R5
   \   000005   9400         SUBB    A,#0x0
   \   000007   5006         JNC     ??unpack_msg_0
    277          	{
    278          		return -1;
   \   000009   7AFF         MOV     R2,#-0x1
   \   00000B   7BFF         MOV     R3,#-0x1
   \   00000D   8004         SJMP    ??unpack_msg_1
    279          	}
    280          	hd = (Zg_Header_Struct*)pdata;
    281          	if(hd->head == 0x7e7e)
    282          	{
    283          	//	crc8 = Calc_CRC8(pdata+sizeof(Zg_Header_Struct), hd->msg_len);
    284          	//	if(crc == hd->crc8)
    285          		{
    286          			switch(hd->msg_cmd)
    287          			{
    288          				//wrt -> zgb
    289          				case WRT_ZGB_ACK:
    290          				
    291          				break;
    292          				case WRT_ZGB_SET_INFO_CMD:
    293          				
    294          				break;
    295          				case WRT_ZGB_GET_INFO_CMD:
    296          				
    297          				break;
    298          				//zgb->wrt
    299          				case ZGB_WRT_ACK:
    300          				
    301          				break;
    302          				default:
    303          				break;
    304          			}
    305          		}
    306          	}
    307          return 0;
   \                     ??unpack_msg_0:
   \   00000F   7A00         MOV     R2,#0x0
   \   000011   7B00         MOV     R3,#0x0
   \                     ??unpack_msg_1:
   \   000013   02....       LJMP    ?BRET
    308          }
    309          
    310          /*********************************************************************
    311           * @fn      SampleApp_Init
    312           *
    313           * @brief   Initialization function for the Generic App Task.
    314           *          This is called during initialization and should contain
    315           *          any application specific initialization (ie. hardware
    316           *          initialization/setup, table initialization, power up
    317           *          notificaiton ... ).
    318           *
    319           * @param   task_id - the ID assigned by OSAL.  This ID should be
    320           *                    used to send messages and set timers.
    321           *
    322           * @return  none
    323           */
    324          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    325          void SampleApp_Init( uint8 task_id )
   \                     SampleApp_Init:
    326          { 
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 29
   \   000005   74E3         MOV     A,#-0x1d
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
    327            SampleApp_TaskID = task_id;
   \   00000B   90....       MOV     DPTR,#SampleApp_TaskID
   \   00000E   F0           MOVX    @DPTR,A
    328            SampleApp_NwkState = DEV_INIT;
   \   00000F   90....       MOV     DPTR,#SampleApp_NwkState
   \   000012   7401         MOV     A,#0x1
   \   000014   F0           MOVX    @DPTR,A
    329            SampleApp_TransID = 0;
   \   000015   90....       MOV     DPTR,#SampleApp_TransID
   \   000018   E4           CLR     A
   \   000019   F0           MOVX    @DPTR,A
    330            
    331            //------------------------配置串口---------------------------------
    332            //MT_UartInit();                    //串口初始化
    333            //MT_UartRegisterTaskID(task_id);   //注册串口任务
    334             //HalUARTWrite(0,"UartInit OK\n", sizeof("UartInit OK\n"));//串口发送
    335            //-----------------------------------------------------------------
    336              
    337            
    338            halUARTCfg_t uartConfig ;
    339            uartConfig.configured           = TRUE;              // 2x30 don't care - see uart driver.
   \   00001A   85..82       MOV     DPL,?XSP + 0
   \   00001D   85..83       MOV     DPH,?XSP + 1
   \   000020   04           INC     A
   \   000021   F0           MOVX    @DPTR,A
    340            uartConfig.baudRate             = HAL_UART_BR_115200;
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   7404         MOV     A,#0x4
   \   000027   F0           MOVX    @DPTR,A
    341            uartConfig.flowControl          = TRUE;
   \   000028   7402         MOV     A,#0x2
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   7401         MOV     A,#0x1
   \   00002F   F0           MOVX    @DPTR,A
    342            uartConfig.flowControlThreshold = 64; // 2x30 don't care - see uart driver.
   \   000030   7403         MOV     A,#0x3
   \   000032   12....       LCALL   ?XSTACK_DISP0_8
   \   000035   7440         MOV     A,#0x40
   \   000037   F0           MOVX    @DPTR,A
   \   000038   A3           INC     DPTR
   \   000039   E4           CLR     A
   \   00003A   F0           MOVX    @DPTR,A
    343            uartConfig.rx.maxBufSize        = 128;  // 2x30 don't care - see uart driver.
   \   00003B   740A         MOV     A,#0xa
   \   00003D   12....       LCALL   ?XSTACK_DISP0_8
   \   000040   7480         MOV     A,#-0x80
   \   000042   F0           MOVX    @DPTR,A
   \   000043   A3           INC     DPTR
   \   000044   E4           CLR     A
   \   000045   F0           MOVX    @DPTR,A
    344            uartConfig.tx.maxBufSize        = 128;  // 2x30 don't care - see uart driver.
   \   000046   7412         MOV     A,#0x12
   \   000048   12....       LCALL   ?XSTACK_DISP0_8
   \   00004B   7480         MOV     A,#-0x80
   \   00004D   F0           MOVX    @DPTR,A
   \   00004E   A3           INC     DPTR
   \   00004F   E4           CLR     A
   \   000050   F0           MOVX    @DPTR,A
    345            uartConfig.idleTimeout          = 6;   // 2x30 don't care - see uart driver.
   \   000051   7405         MOV     A,#0x5
   \   000053   12....       LCALL   ?XSTACK_DISP0_8
   \   000056   7406         MOV     A,#0x6
   \   000058   F0           MOVX    @DPTR,A
    346            uartConfig.intEnable            = TRUE;              // 2x30 don't care - see uart driver.
   \   000059   7416         MOV     A,#0x16
   \   00005B   12....       LCALL   ?XSTACK_DISP0_8
   \   00005E   7401         MOV     A,#0x1
   \   000060   F0           MOVX    @DPTR,A
    347            uartConfig.callBackFunc         = SerialApp_CallBack;
   \   000061   741B         MOV     A,#0x1b
   \   000063   12....       LCALL   ?XSTACK_DISP0_8
   \   000066   74..         MOV     A,#??SerialApp_CallBack?relay & 0xff
   \   000068   F0           MOVX    @DPTR,A
   \   000069   A3           INC     DPTR
   \   00006A   74..         MOV     A,#(??SerialApp_CallBack?relay >> 8) & 0xff
   \   00006C   F0           MOVX    @DPTR,A
    348            HalUARTOpen (0, &uartConfig);
   \   00006D                ; Setup parameters for call to function HalUARTOpen
   \   00006D   85..82       MOV     DPL,?XSP + 0
   \   000070   85..83       MOV     DPH,?XSP + 1
   \   000073   AA82         MOV     R2,DPL
   \   000075   AB83         MOV     R3,DPH
   \   000077   7900         MOV     R1,#0x0
   \   000079   12....       LCALL   ??HalUARTOpen?relay
    349            
    350            // Device hardware initialization can be added here or in main() (Zmain.c).
    351            // If the hardware is application specific - add it here.
    352            // If the hardware is other parts of the device add it in main().
    353          
    354           #if defined ( BUILD_ALL_DEVICES )
    355            // The "Demo" target is setup to have BUILD_ALL_DEVICES and HOLD_AUTO_START
    356            // We are looking at a jumper (defined in SampleAppHw.c) to be jumpered
    357            // together - if they are - we will start up a coordinator. Otherwise,
    358            // the device will start as a router.
    359            if ( readCoordinatorJumper() )
    360              zgDeviceLogicalType = ZG_DEVICETYPE_COORDINATOR;
    361            else
    362              zgDeviceLogicalType = ZG_DEVICETYPE_ROUTER;
    363          #endif // BUILD_ALL_DEVICES
    364          
    365          #if defined ( HOLD_AUTO_START )
    366            // HOLD_AUTO_START is a compile option that will surpress ZDApp
    367            //  from starting the device and wait for the application to
    368            //  start the device.
    369            ZDOInitDevice(0);
    370          #endif
    371          
    372            // Setup for the periodic message's destination address
    373            // Broadcast to everyone
    374            SampleApp_Periodic_DstAddr.addrMode = (afAddrMode_t)AddrBroadcast;
   \   00007C   90....       MOV     DPTR,#SampleApp_Periodic_DstAddr + 8
   \   00007F   740F         MOV     A,#0xf
   \   000081   F0           MOVX    @DPTR,A
    375            SampleApp_Periodic_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000082   A3           INC     DPTR
   \   000083   7414         MOV     A,#0x14
   \   000085   F0           MOVX    @DPTR,A
    376            SampleApp_Periodic_DstAddr.addr.shortAddr = 0xFFFF;
   \   000086   90....       MOV     DPTR,#SampleApp_Periodic_DstAddr
   \   000089   74FF         MOV     A,#-0x1
   \   00008B   F0           MOVX    @DPTR,A
   \   00008C   A3           INC     DPTR
   \   00008D   F0           MOVX    @DPTR,A
    377          
    378            // Setup for the flash command's destination address - Group 1
    379            SampleApp_Flash_DstAddr.addrMode = (afAddrMode_t)afAddrGroup;
   \   00008E   90....       MOV     DPTR,#SampleApp_Flash_DstAddr + 8
   \   000091   7401         MOV     A,#0x1
   \   000093   F0           MOVX    @DPTR,A
    380            SampleApp_Flash_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000094   A3           INC     DPTR
   \   000095   7414         MOV     A,#0x14
   \   000097   F0           MOVX    @DPTR,A
    381            SampleApp_Flash_DstAddr.addr.shortAddr = SAMPLEAPP_FLASH_GROUP;
   \   000098   90....       MOV     DPTR,#SampleApp_Flash_DstAddr
   \   00009B   7401         MOV     A,#0x1
   \   00009D   F0           MOVX    @DPTR,A
   \   00009E   A3           INC     DPTR
   \   00009F   E4           CLR     A
   \   0000A0   F0           MOVX    @DPTR,A
    382          
    383            //P2P initialize
    384            SampleApp_P2P_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   0000A1   90....       MOV     DPTR,#SampleApp_P2P_DstAddr + 8
   \   0000A4   7402         MOV     A,#0x2
   \   0000A6   F0           MOVX    @DPTR,A
    385            SampleApp_P2P_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;  
   \   0000A7   A3           INC     DPTR
   \   0000A8   7414         MOV     A,#0x14
   \   0000AA   F0           MOVX    @DPTR,A
    386            SampleApp_P2P_DstAddr.addr.shortAddr = 0x0000;//发给协调器
   \   0000AB   90....       MOV     DPTR,#SampleApp_P2P_DstAddr
   \   0000AE   E4           CLR     A
   \   0000AF   F0           MOVX    @DPTR,A
   \   0000B0   A3           INC     DPTR
   \   0000B1   F0           MOVX    @DPTR,A
    387          
    388            // Fill out the endpoint description.
    389            SampleApp_epDesc.endPoint = SAMPLEAPP_ENDPOINT;
   \   0000B2   90....       MOV     DPTR,#SampleApp_epDesc
   \   0000B5   7414         MOV     A,#0x14
   \   0000B7   F0           MOVX    @DPTR,A
    390            SampleApp_epDesc.task_id = &SampleApp_TaskID;
   \   0000B8   A3           INC     DPTR
   \   0000B9   74..         MOV     A,#SampleApp_TaskID & 0xff
   \   0000BB   F0           MOVX    @DPTR,A
   \   0000BC   A3           INC     DPTR
   \   0000BD   74..         MOV     A,#(SampleApp_TaskID >> 8) & 0xff
   \   0000BF   F0           MOVX    @DPTR,A
    391            SampleApp_epDesc.simpleDesc
    392                      = (SimpleDescriptionFormat_t *)&SampleApp_SimpleDesc;
   \   0000C0   A3           INC     DPTR
   \   0000C1   74..         MOV     A,#SampleApp_SimpleDesc & 0xff
   \   0000C3   F0           MOVX    @DPTR,A
   \   0000C4   A3           INC     DPTR
   \   0000C5   74..         MOV     A,#(SampleApp_SimpleDesc >> 8) & 0xff
   \   0000C7   F0           MOVX    @DPTR,A
    393            SampleApp_epDesc.latencyReq = noLatencyReqs;
   \   0000C8   A3           INC     DPTR
   \   0000C9   E4           CLR     A
   \   0000CA   F0           MOVX    @DPTR,A
    394          
    395            // Register the endpoint description with the AF
    396            afRegister( &SampleApp_epDesc );
   \   0000CB                ; Setup parameters for call to function afRegister
   \   0000CB   7A..         MOV     R2,#SampleApp_epDesc & 0xff
   \   0000CD   7B..         MOV     R3,#(SampleApp_epDesc >> 8) & 0xff
   \   0000CF   12....       LCALL   ??afRegister?relay
    397          
    398            // Register for all key events - This app will handle all key events
    399            RegisterForKeys( SampleApp_TaskID );
   \   0000D2                ; Setup parameters for call to function RegisterForKeys
   \   0000D2   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000D5   E0           MOVX    A,@DPTR
   \   0000D6   F9           MOV     R1,A
   \   0000D7   12....       LCALL   ??RegisterForKeys?relay
    400          
    401            // By default, all devices start out in Group 1
    402            SampleApp_Group.ID = 0x0001;
   \   0000DA   90....       MOV     DPTR,#SampleApp_Group
   \   0000DD   7401         MOV     A,#0x1
   \   0000DF   F0           MOVX    @DPTR,A
   \   0000E0   A3           INC     DPTR
   \   0000E1   E4           CLR     A
   \   0000E2   F0           MOVX    @DPTR,A
    403            osal_memcpy( SampleApp_Group.name, "Group 1", 7  );
   \   0000E3                ; Setup parameters for call to function osal_memcpy
   \   0000E3   75....       MOV     ?V0 + 0,#`?<Constant "Group 1">` & 0xff
   \   0000E6   75....       MOV     ?V0 + 1,#(`?<Constant "Group 1">` >> 8) & 0xff
   \   0000E9   F5..         MOV     ?V0 + 2,A
   \   0000EB   78..         MOV     R0,#?V0 + 0
   \   0000ED   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000F0   7C07         MOV     R4,#0x7
   \   0000F2   7D00         MOV     R5,#0x0
   \   0000F4   7A..         MOV     R2,#(SampleApp_Group + 2) & 0xff
   \   0000F6   7B..         MOV     R3,#((SampleApp_Group + 2) >> 8) & 0xff
   \   0000F8   12....       LCALL   ??osal_memcpy?relay
   \   0000FB   7403         MOV     A,#0x3
   \   0000FD   12....       LCALL   ?DEALLOC_XSTACK8
    404            aps_AddGroup( SAMPLEAPP_ENDPOINT, &SampleApp_Group );
   \   000100                ; Setup parameters for call to function aps_AddGroup
   \   000100   7A..         MOV     R2,#SampleApp_Group & 0xff
   \   000102   7B..         MOV     R3,#(SampleApp_Group >> 8) & 0xff
   \   000104   7914         MOV     R1,#0x14
   \   000106   12....       LCALL   ??aps_AddGroup?relay
    405          
    406          #if defined ( LCD_SUPPORTED )
    407            HalLcdWriteString( "SampleApp", HAL_LCD_LINE_1 );
   \   000109                ; Setup parameters for call to function HalLcdWriteString
   \   000109   7901         MOV     R1,#0x1
   \   00010B   7A..         MOV     R2,#`?<Constant "SampleApp">` & 0xff
   \   00010D   7B..         MOV     R3,#(`?<Constant "SampleApp">` >> 8) & 0xff
   \   00010F   12....       LCALL   ??HalLcdWriteString?relay
    408          #endif
    409            
    410          //  osal_start_timerEx( SampleApp_TaskID, SYS_EVENT_MSG_USER_TM,5000);
    411          
    412             /*
    413            	flash block
    414            	short int value_read = 0; 
    415          	char str_read[8] ;
    416          	short int value = 0x0304;
    417          	char *str = "abcdefg";
    418          	int temp = strlen(str);
    419          	osal_nv_item_init(TEST_NV,7,NULL);//NULL表示初始化的时候，item数据部分为空
    420          	int len = osal_nv_item_len(TEST_NV);
    421          	osal_nv_write(TEST_NV,0,1,&value);
    422          	int len2 = osal_nv_item_len(TEST_NV);
    423          	osal_nv_read(TEST_NV,0,2,&value_read);
    424              */
    425          
    426          }
   \   000112   741D         MOV     A,#0x1d
   \   000114   12....       LCALL   ?DEALLOC_XSTACK8
   \   000117   7F03         MOV     R7,#0x3
   \   000119   02....       LJMP    ?BANKED_LEAVE_XDATA
    427          
    428          
    429          
    430          /*********************************************************************
    431           * @fn      SampleApp_ProcessEvent
    432           *
    433           * @brief   Generic Application Task event processor.  This function
    434           *          is called to process all events for the task.  Events
    435           *          include timers, messages and any other user defined events.
    436           *
    437           * @param   task_id  - The OSAL assigned task ID.
    438           * @param   events - events to process.  This is a bit map and can
    439           *                   contain more than one event.
    440           *
    441           * @return  none
    442           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    443          char  buf[64];
   \                     buf:
   \   000000                DS 64
   \   000040                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    444          int   buflen;
   \                     buflen:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    445          uint16 SampleApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     SampleApp_ProcessEvent:
    446          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    447            afIncomingMSGPacket_t *MSGpkt;
    448            (void)task_id;  // Intentionally unreferenced parameter
    449          
    450            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   7003         JNZ     $+5
   \   00000D   02....       LJMP    ??SampleApp_ProcessEvent_0 & 0xFFFF
    451            {
    452              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   000010                ; Setup parameters for call to function osal_msg_receive
   \   000010   90....       MOV     DPTR,#SampleApp_TaskID
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F9           MOV     R1,A
   \   000015   12....       LCALL   ??osal_msg_receive?relay
   \   000018   8A..         MOV     ?V0 + 0,R2
   \   00001A   8B..         MOV     ?V0 + 1,R3
    453              while ( MSGpkt )
   \   00001C   EA           MOV     A,R2
   \   00001D   45..         ORL     A,?V0 + 1
   \   00001F   7003         JNZ     $+5
   \   000021   02....       LJMP    ??SampleApp_ProcessEvent_1 & 0xFFFF
    454              {
    455                switch ( MSGpkt->hdr.event )
   \                     ??SampleApp_ProcessEvent_2:
   \   000024   85..82       MOV     DPL,?V0 + 0
   \   000027   85..83       MOV     DPH,?V0 + 1
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   24E6         ADD     A,#-0x1a
   \   00002D   6039         JZ      ??SampleApp_ProcessEvent_3
   \   00002F   245A         ADD     A,#0x5a
   \   000031   6007         JZ      ??SampleApp_ProcessEvent_4
   \   000033   24EF         ADD     A,#-0x11
   \   000035   605A         JZ      ??SampleApp_ProcessEvent_5
   \   000037   02....       LJMP    ??SampleApp_ProcessEvent_6 & 0xFFFF
    456                {
    457                  // Received when a key is pressed
    458                  case KEY_CHANGE:
    459                    SampleApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
   \                     ??SampleApp_ProcessEvent_4:
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   A2E1         MOV     C,0xE0 /* A   */.1
   \   000040   507C         JNC     ??SampleApp_ProcessEvent_6
   \   000042                ; Setup parameters for call to function aps_FindGroup
   \   000042   7A01         MOV     R2,#0x1
   \   000044   7B00         MOV     R3,#0x0
   \   000046   7914         MOV     R1,#0x14
   \   000048   12....       LCALL   ??aps_FindGroup?relay
   \   00004B   8B..         MOV     ?V0 + 3,R3
   \   00004D   EA           MOV     A,R2
   \   00004E   45..         ORL     A,?V0 + 3
   \   000050   600B         JZ      ??SampleApp_ProcessEvent_7
   \   000052                ; Setup parameters for call to function aps_RemoveGroup
   \   000052   7A01         MOV     R2,#0x1
   \   000054   7B00         MOV     R3,#0x0
   \   000056   7914         MOV     R1,#0x14
   \   000058   12....       LCALL   ??aps_RemoveGroup?relay
   \   00005B   8061         SJMP    ??SampleApp_ProcessEvent_6
   \                     ??SampleApp_ProcessEvent_7:
   \   00005D                ; Setup parameters for call to function aps_AddGroup
   \   00005D   7A..         MOV     R2,#SampleApp_Group & 0xff
   \   00005F   7B..         MOV     R3,#(SampleApp_Group >> 8) & 0xff
   \   000061   7914         MOV     R1,#0x14
   \   000063   12....       LCALL   ??aps_AddGroup?relay
   \   000066   8056         SJMP    ??SampleApp_ProcessEvent_6
    460                    break;
    461          
    462                  // Received when a messages is received (OTA) for this endpoint
    463                  case AF_INCOMING_MSG_CMD:
    464                    SampleApp_MessageMSGCB( MSGpkt );
   \                     ??SampleApp_ProcessEvent_3:
   \   000068                ; Setup parameters for call to function HalUARTWrite
   \   000068   E5..         MOV     A,?V0 + 0
   \   00006A   241F         ADD     A,#0x1f
   \   00006C   F582         MOV     DPL,A
   \   00006E   E5..         MOV     A,?V0 + 1
   \   000070   3400         ADDC    A,#0x0
   \   000072   F583         MOV     DPH,A
   \   000074   E0           MOVX    A,@DPTR
   \   000075   FC           MOV     R4,A
   \   000076   A3           INC     DPTR
   \   000077   E0           MOVX    A,@DPTR
   \   000078   FD           MOV     R5,A
   \   000079   E5..         MOV     A,?V0 + 0
   \   00007B   2421         ADD     A,#0x21
   \   00007D   F582         MOV     DPL,A
   \   00007F   E5..         MOV     A,?V0 + 1
   \   000081   3400         ADDC    A,#0x0
   \   000083   F583         MOV     DPH,A
   \   000085   E0           MOVX    A,@DPTR
   \   000086   FA           MOV     R2,A
   \   000087   A3           INC     DPTR
   \   000088   E0           MOVX    A,@DPTR
   \   000089   FB           MOV     R3,A
   \   00008A   7900         MOV     R1,#0x0
   \   00008C   12....       LCALL   ??HalUARTWrite?relay
    465                    break;
   \   00008F   802D         SJMP    ??SampleApp_ProcessEvent_6
    466          
    467                  // Received whenever the device changes state in the network
    468                  case ZDO_STATE_CHANGE:
    469                    SampleApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
   \                     ??SampleApp_ProcessEvent_5:
   \   000091   A3           INC     DPTR
   \   000092   E0           MOVX    A,@DPTR
   \   000093   90....       MOV     DPTR,#SampleApp_NwkState
   \   000096   F0           MOVX    @DPTR,A
    470                    if (// (SampleApp_NwkState == DEV_ZB_COORD)||
    471                         (SampleApp_NwkState == DEV_ROUTER)
    472                        || (SampleApp_NwkState == DEV_END_DEVICE) )
   \   000097   6407         XRL     A,#0x7
   \   000099   6005         JZ      ??SampleApp_ProcessEvent_8
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   6406         XRL     A,#0x6
   \   00009E   7012         JNZ     ??SampleApp_ProcessEvent_9
    473                    {
    474                      // Start sending the periodic message in a regular interval.
    475                      osal_start_timerEx( SampleApp_TaskID,
    476                                        SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    477                                        SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT );
   \                     ??SampleApp_ProcessEvent_8:
   \   0000A0                ; Setup parameters for call to function osal_start_timerEx
   \   0000A0   7CE8         MOV     R4,#-0x18
   \   0000A2   7D03         MOV     R5,#0x3
   \   0000A4   7A01         MOV     R2,#0x1
   \   0000A6   7B00         MOV     R3,#0x0
   \   0000A8   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000AB   E0           MOVX    A,@DPTR
   \   0000AC   F9           MOV     R1,A
   \   0000AD   12....       LCALL   ??osal_start_timerEx?relay
   \   0000B0   800C         SJMP    ??SampleApp_ProcessEvent_6
    478                    }
    479                    else
    480                    {
    481                      // Device is no longer in the network
    482                      osal_stop_timerEx(SampleApp_TaskID,SAMPLEAPP_SEND_PERIODIC_MSG_EVT);
   \                     ??SampleApp_ProcessEvent_9:
   \   0000B2                ; Setup parameters for call to function osal_stop_timerEx
   \   0000B2   7A01         MOV     R2,#0x1
   \   0000B4   7B00         MOV     R3,#0x0
   \   0000B6   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000B9   E0           MOVX    A,@DPTR
   \   0000BA   F9           MOV     R1,A
   \   0000BB   12....       LCALL   ??osal_stop_timerEx?relay
    483                    }
    484                    break;
    485          
    486                  default:
    487                    break;
    488                }
    489          
    490                // Release the memory
    491                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??SampleApp_ProcessEvent_6:
   \   0000BE                ; Setup parameters for call to function osal_msg_deallocate
   \   0000BE   AA..         MOV     R2,?V0 + 0
   \   0000C0   AB..         MOV     R3,?V0 + 1
   \   0000C2   12....       LCALL   ??osal_msg_deallocate?relay
    492          
    493                // Next - if one is available
    494                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   0000C5                ; Setup parameters for call to function osal_msg_receive
   \   0000C5   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000C8   E0           MOVX    A,@DPTR
   \   0000C9   F9           MOV     R1,A
   \   0000CA   12....       LCALL   ??osal_msg_receive?relay
   \   0000CD   8A..         MOV     ?V0 + 0,R2
   \   0000CF   8B..         MOV     ?V0 + 1,R3
   \   0000D1   EA           MOV     A,R2
   \   0000D2   45..         ORL     A,?V0 + 1
   \   0000D4   6003         JZ      $+5
   \   0000D6   02....       LJMP    ??SampleApp_ProcessEvent_2 & 0xFFFF
    495              }
    496          
    497              // return unprocessed events
    498              return (events ^ SYS_EVENT_MSG);
   \                     ??SampleApp_ProcessEvent_1:
   \   0000D9   EE           MOV     A,R6
   \   0000DA   FA           MOV     R2,A
   \   0000DB   EF           MOV     A,R7
   \   0000DC   6480         XRL     A,#0x80
   \                     ??SampleApp_ProcessEvent_10:
   \   0000DE   FB           MOV     R3,A
   \   0000DF   8034         SJMP    ??SampleApp_ProcessEvent_11
    499            }
    500          
    501            // Send a message out - This event is generated by a timer
    502            //  (setup in SampleApp_Init()).
    503            if ( events & SAMPLEAPP_SEND_PERIODIC_MSG_EVT )
   \                     ??SampleApp_ProcessEvent_0:
   \   0000E1   EE           MOV     A,R6
   \   0000E2   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000E4   5021         JNC     ??SampleApp_ProcessEvent_12
    504            {
    505              // Send the periodic message
    506              HalLedSet(HAL_LED_3,HAL_LED_MODE_TOGGLE);
   \   0000E6                ; Setup parameters for call to function HalLedSet
   \   0000E6   7A08         MOV     R2,#0x8
   \   0000E8   7904         MOV     R1,#0x4
   \   0000EA   12....       LCALL   ??HalLedSet?relay
    507             // SampleApp_SendPeriodicMessage();
    508          	  //增加点播的发送函数 
    509              // Setup to send message again in normal period (+ a little jitter)
    510              
    511          #ifdef       ROUTER_ME//测试路由发送
    512                AF_TO_C_FRM_R_Message();//路由器发送测试数据到协调器
   \   0000ED                ; Setup parameters for call to function AF_TO_C_FRM_R_Message
   \   0000ED   12....       LCALL   ??AF_TO_C_FRM_R_Message?relay
    513          #endif
    514          
    515              osal_start_timerEx( SampleApp_TaskID, SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    516                  (SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT ) );
   \   0000F0                ; Setup parameters for call to function osal_start_timerEx
   \   0000F0   7CE8         MOV     R4,#-0x18
   \   0000F2   7D03         MOV     R5,#0x3
   \   0000F4   7A01         MOV     R2,#0x1
   \   0000F6   7B00         MOV     R3,#0x0
   \   0000F8   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000FB   E0           MOVX    A,@DPTR
   \   0000FC   F9           MOV     R1,A
   \   0000FD   12....       LCALL   ??osal_start_timerEx?relay
    517          
    518              // return unprocessed events
    519              return (events ^ SAMPLEAPP_SEND_PERIODIC_MSG_EVT);
   \   000100   EE           MOV     A,R6
   \   000101   6401         XRL     A,#0x1
   \   000103   FA           MOV     R2,A
   \   000104   EF           MOV     A,R7
   \   000105   80D7         SJMP    ??SampleApp_ProcessEvent_10
    520            }
    521            
    522            //user specific event
    523            if ( events & SYS_EVENT_MSG_USER_TM )
   \                     ??SampleApp_ProcessEvent_12:
   \   000107   5404         ANL     A,#0x4
   \   000109   6006         JZ      ??SampleApp_ProcessEvent_13
    524            {  
    525          
    526          	
    527          	  
    528          	  return (events ^ SYS_EVENT_MSG_USER_TM);
   \   00010B   EE           MOV     A,R6
   \   00010C   6404         XRL     A,#0x4
   \   00010E   FA           MOV     R2,A
   \   00010F   8004         SJMP    ??SampleApp_ProcessEvent_11
    529            }
    530           
    531            // Discard unknown events
    532            return 0;
   \                     ??SampleApp_ProcessEvent_13:
   \   000111   7A00         MOV     R2,#0x0
   \   000113   7B00         MOV     R3,#0x0
   \                     ??SampleApp_ProcessEvent_11:
   \   000115   02....       LJMP    ?Subroutine1 & 0xFFFF
    533          }
    534          
    535          /*********************************************************************
    536           * Event Generation Functions
    537           */
    538          /*********************************************************************
    539           * @fn      SampleApp_HandleKeys
    540           *
    541           * @brief   Handles all key events for this device.
    542           *
    543           * @param   shift - true if in shift/alt.
    544           * @param   keys - bit field for key events. Valid entries:
    545           *                 HAL_KEY_SW_2
    546           *                 HAL_KEY_SW_1
    547           *
    548           * @return  none
    549           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    550          void SampleApp_HandleKeys( uint8 shift, uint8 keys )
   \                     SampleApp_HandleKeys:
    551          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
    552            (void)shift;  // Intentionally unreferenced parameter
    553            
    554            if ( keys & HAL_KEY_SW_1 )
    555            {
    556              /* This key sends the Flash Command is sent to Group 1.
    557               * This device will not receive the Flash Command from this
    558               * device (even if it belongs to group 1).
    559               */
    560              SampleApp_SendFlashMessage( SAMPLEAPP_FLASH_DURATION );
    561            }
    562          
    563            if ( keys & HAL_KEY_SW_2 )
   \   000006   A2E1         MOV     C,0xE0 /* A   */.1
   \   000008   5024         JNC     ??SampleApp_HandleKeys_0
    564            {
    565              /* The Flashr Command is sent to Group 1.
    566               * This key toggles this device in and out of group 1.
    567               * If this device doesn't belong to group 1, this application
    568               * will not receive the Flash command sent to group 1.
    569               */
    570              aps_Group_t *grp;
    571              grp = aps_FindGroup( SAMPLEAPP_ENDPOINT, SAMPLEAPP_FLASH_GROUP );
    572              if ( grp )
   \   00000A                ; Setup parameters for call to function aps_FindGroup
   \   00000A   7A01         MOV     R2,#0x1
   \   00000C   7B00         MOV     R3,#0x0
   \   00000E   7914         MOV     R1,#0x14
   \   000010   12....       LCALL   ??aps_FindGroup?relay
   \   000013   8B..         MOV     ?V0 + 1,R3
   \   000015   EA           MOV     A,R2
   \   000016   45..         ORL     A,?V0 + 1
   \   000018   600B         JZ      ??SampleApp_HandleKeys_1
    573              {
    574                // Remove from the group
    575                aps_RemoveGroup( SAMPLEAPP_ENDPOINT, SAMPLEAPP_FLASH_GROUP );
   \   00001A                ; Setup parameters for call to function aps_RemoveGroup
   \   00001A   7A01         MOV     R2,#0x1
   \   00001C   7B00         MOV     R3,#0x0
   \   00001E   7914         MOV     R1,#0x14
   \   000020   12....       LCALL   ??aps_RemoveGroup?relay
   \   000023   8009         SJMP    ??SampleApp_HandleKeys_0
    576              }
    577              else
    578              {
    579                // Add to the flash group
    580                aps_AddGroup( SAMPLEAPP_ENDPOINT, &SampleApp_Group );
   \                     ??SampleApp_HandleKeys_1:
   \   000025                ; Setup parameters for call to function aps_AddGroup
   \   000025   7A..         MOV     R2,#SampleApp_Group & 0xff
   \   000027   7B..         MOV     R3,#(SampleApp_Group >> 8) & 0xff
   \   000029   7914         MOV     R1,#0x14
   \   00002B   12....       LCALL   ??aps_AddGroup?relay
    581              }
    582            }
    583          }
   \                     ??SampleApp_HandleKeys_0:
   \   00002E                REQUIRE ?Subroutine2
   \   00002E                ; // Fall through to label ?Subroutine2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    584          
    585          /*********************************************************************
    586           * LOCAL FUNCTIONS
    587           */
    588          
    589          /*********************************************************************
    590           * @fn      SampleApp_MessageMSGCB
    591           *
    592           * @brief   Data message processor callback.  This function processes
    593           *          any incoming data - probably from other devices.  So, based
    594           *          on cluster ID, perform the intended action.
    595           *
    596           * @param   none
    597           *
    598           * @return  none
    599           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    600          void SampleApp_MessageMSGCB( afIncomingMSGPacket_t *pkt )
   \                     SampleApp_MessageMSGCB:
    601          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    602            uint16 flashTime;
    603            
    604          #ifdef       COORDINATOR_ME
    605          //----协调器收到了终端 的af数据。转发到路由器(wrt)
    606            Msg_Zg_WRT_transfer rpst;
    607          
    608            osal_memset(buf, 0, sizeof(buf));
    609            rpst.src_type = 1;				//for test
    610            rpst.len = 6;						//for test
    611            rpst.end_dev_addr = pkt->srcAddr;	//for test
    612            buflen = pack_msg_transfer(&rpst,"987654", buf,6);
    613            HalUARTWrite(0, (uint8*)buf, buflen);//串口发送
    614            HalLedSet(HAL_LED_3,HAL_LED_MODE_TOGGLE);
    615          #endif
    616          //---路由部分代码
    617          #ifdef       ROUTER_ME
    618          	HalUARTWrite(0, pkt->cmd.Data,	pkt->cmd.DataLength);//串口发送
   \   000004                ; Setup parameters for call to function HalUARTWrite
   \   000004   EA           MOV     A,R2
   \   000005   241F         ADD     A,#0x1f
   \   000007   F582         MOV     DPL,A
   \   000009   EB           MOV     A,R3
   \   00000A   3400         ADDC    A,#0x0
   \   00000C   F583         MOV     DPH,A
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   FC           MOV     R4,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   FD           MOV     R5,A
   \   000013   EA           MOV     A,R2
   \   000014   2421         ADD     A,#0x21
   \   000016   F582         MOV     DPL,A
   \   000018   EB           MOV     A,R3
   \   000019   3400         ADDC    A,#0x0
   \   00001B   F583         MOV     DPH,A
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   FA           MOV     R2,A
   \   00001F   A3           INC     DPTR
   \   000020   E0           MOVX    A,@DPTR
   \   000021   FB           MOV     R3,A
   \   000022   7900         MOV     R1,#0x0
   \   000024   12....       LCALL   ??HalUARTWrite?relay
    619          #endif
    620          
    621            return ;
   \   000027   02....       LJMP    ?Subroutine0 & 0xFFFF
    622            
    623            switch ( pkt->clusterId )
                   ^
Warning[Pe111]: statement is unreachable
    624            {
    625            	HalLedSet(HAL_LED_4,HAL_LED_MODE_TOGGLE);
                   	^
Warning[Pe111]: statement is unreachable
    626              case SAMPLEAPP_PERIODIC_CLUSTERID:
    627                break;
    628          
    629              case SAMPLEAPP_FLASH_CLUSTERID:
    630                flashTime = BUILD_UINT16(pkt->cmd.Data[1], pkt->cmd.Data[2] );
    631                HalLedBlink( HAL_LED_4, 4, 50, (flashTime / 4) );
    632                break;
    633          	case SAMPLEAPP_R2C_CLUSTERID://
    634          	  
    635                break;
    636          	case SAMPLEAPP_C2R_CLUSTERID://收到协调器发给路由的数据
    637                HalUARTWrite(0, pkt->cmd.Data,  pkt->cmd.DataLength);//串口发送
    638                break;
    639            }
    640          }
    641          
    642          
    643          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    644          void AF_TO_C_FRM_R_Message(void)
   \                     AF_TO_C_FRM_R_Message:
    645          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV     A,#-0x6
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    646          	
    647          	uint8 data[6] = "123456"; 					//for test
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   AC82         MOV     R4,DPL
   \   000012   AD83         MOV     R5,DPH
   \   000014   7583..       MOV     DPH,#(`?<Constant "123456">` >> 8) & 0xff
   \   000017   7582..       MOV     DPL,#`?<Constant "123456">` & 0xff
   \   00001A   7406         MOV     A,#0x6
   \   00001C   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
    648           
    649          	if ( AF_DataRequest( &SampleApp_P2P_DstAddr, &SampleApp_epDesc,SAMPLEAPP_R2C_CLUSTERID, 6, 
    650          data, &SampleApp_TransID, AF_DISCV_ROUTE, AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   00001F                ; Setup parameters for call to function AF_DataRequest
   \   00001F   75..1E       MOV     ?V0 + 0,#0x1e
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000027   75....       MOV     ?V0 + 0,#SampleApp_TransID & 0xff
   \   00002A   75....       MOV     ?V0 + 1,#(SampleApp_TransID >> 8) & 0xff
   \   00002D   78..         MOV     R0,#?V0 + 0
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   7403         MOV     A,#0x3
   \   000034   12....       LCALL   ?XSTACK_DISP0_8
   \   000037   8582..       MOV     ?V0 + 0,DPL
   \   00003A   8583..       MOV     ?V0 + 1,DPH
   \   00003D   78..         MOV     R0,#?V0 + 0
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000042   75..06       MOV     ?V0 + 0,#0x6
   \   000045   75..00       MOV     ?V0 + 1,#0x0
   \   000048   78..         MOV     R0,#?V0 + 0
   \   00004A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00004D   75..03       MOV     ?V0 + 0,#0x3
   \   000050   78..         MOV     R0,#?V0 + 0
   \   000052   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000055   7920         MOV     R1,#0x20
   \   000057   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   000059   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   00005B   7A..         MOV     R2,#SampleApp_P2P_DstAddr & 0xff
   \   00005D   7B..         MOV     R3,#(SampleApp_P2P_DstAddr >> 8) & 0xff
   \   00005F   12....       LCALL   ??AF_DataRequest?relay
   \   000062   7409         MOV     A,#0x9
   \   000064   12....       LCALL   ?DEALLOC_XSTACK8
   \   000067   E9           MOV     A,R1
   \   000068   7CE8         MOV     R4,#-0x18
   \   00006A   7D03         MOV     R5,#0x3
   \   00006C   7B32         MOV     R3,#0x32
   \   00006E   7004         JNZ     ??AF_TO_C_FRM_R_Message_0
    651          	{ 
    652             		HalLedBlink(HAL_LED_2,1,50,1000);
   \   000070                ; Setup parameters for call to function HalLedBlink
   \   000070   7A01         MOV     R2,#0x1
   \   000072   8002         SJMP    ??AF_TO_C_FRM_R_Message_1
    653          	} 
    654          	else 
    655          	{
    656          		HalLedBlink(HAL_LED_2,3,50,1000);
   \                     ??AF_TO_C_FRM_R_Message_0:
   \   000074                ; Setup parameters for call to function HalLedBlink
   \   000074   7A03         MOV     R2,#0x3
   \                     ??AF_TO_C_FRM_R_Message_1:
   \   000076   7902         MOV     R1,#0x2
   \   000078   12....       LCALL   ??HalLedBlink?relay
    657          	} 
    658          }
   \   00007B   7406         MOV     A,#0x6
   \   00007D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000080   02....       LJMP    ?Subroutine2 & 0xFFFF
    659          
    660          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    661          void SampleApp_SendFlashMessage(uint16 flashTime)
   \                     SampleApp_SendFlashMessage:
    662          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    663          
    664          }
   \   000000   02....       LJMP    ?BRET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??deal_data?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    deal_data

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AF_To_R_From_C?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AF_To_R_From_C

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SerialApp_CallBack?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SerialApp_CallBack

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??pack_msg_transfer?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    pack_msg_transfer

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??unpack_msg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    unpack_msg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_MessageMSGCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_MessageMSGCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AF_TO_C_FRM_R_Message?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AF_TO_C_FRM_R_Message

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_SendFlashMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_SendFlashMessage

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Group 1">`:
   \   000000   47726F75     DB "Group 1"
   \            70203100

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SampleApp">`:
   \   000000   53616D70     DB "SampleApp"
   \            6C654170
   \            7000    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "123456">`:
   \   000000   31323334     DB 31H, 32H, 33H, 34H, 35H, 36H
   \            3536    
    665          /*********************************************************************
    666          *********************************************************************/

   Maximum stack usage in bytes:

     Function                   ISTACK PSTACK XSTACK
     --------                   ------ ------ ------
     AF_TO_C_FRM_R_Message          2      0     37
       -> AF_DataRequest            0      0     50
       -> HalLedBlink               0      0     32
       -> HalLedBlink               0      0     32
     AF_To_R_From_C                 0      0     23
       -> AF_DataRequest            0      0     42
       -> HalLedBlink               0      0     24
     SampleApp_HandleKeys           0      0     10
       -> aps_FindGroup             0      0     20
       -> aps_RemoveGroup           0      0     20
       -> aps_AddGroup              0      0     20
     SampleApp_Init                 0      0     43
       -> HalUARTOpen               0      0     80
       -> afRegister                0      0     80
       -> RegisterForKeys           0      0     80
       -> osal_memcpy               0      0     86
       -> aps_AddGroup              0      0     80
       -> HalLcdWriteString         0      0     80
     SampleApp_MessageMSGCB         2      0      0
       -> HalUARTWrite              4      0      0
     SampleApp_ProcessEvent         0      0     12
       -> osal_msg_receive          0      0     24
       -> aps_FindGroup             0      0     24
       -> aps_RemoveGroup           0      0     24
       -> aps_AddGroup              0      0     24
       -> HalUARTWrite              0      0     24
       -> osal_start_timerEx        0      0     24
       -> osal_stop_timerEx         0      0     24
       -> osal_msg_deallocate       0      0     24
       -> osal_msg_receive          0      0     24
       -> HalLedSet                 0      0     24
       -> AF_TO_C_FRM_R_Message     0      0     24
       -> osal_start_timerEx        0      0     24
     SampleApp_SendFlashMessage     0      0      0
     SerialApp_CallBack             0      0     21
       -> HalLedSet                 0      0     24
       -> HalUARTRead               0      0     24
       -> Calc_CRC8                 0      0     32
       -> AF_DataRequest            0      0     42
       -> HalLedBlink               0      0     24
       -> AF_TO_C_FRM_R_Message     0      0     24
     deal_data                      2      0      0
       -> HalUARTWrite              4      0      0
       -> AF_TO_C_FRM_R_Message     4      0      0
     pack_msg_transfer              1      0     35
       -> osal_memcpy               0      0     60
       -> osal_memcpy               0      0     60
       -> Calc_CRC8                 0      0     62
       -> osal_memcpy               0      0     60
     unpack_msg                     0      0      0


   Segment part sizes:

     Function/Label                     Bytes
     --------------                     -----
     globa_run_num                         1
     SampleApp_ClusterList                 4
     SampleApp_SimpleDesc                 12
     SampleApp_epDesc                      6
     SampleApp_TaskID                      1
     SampleApp_NwkState                    1
     SampleApp_TransID                     1
     SampleApp_Periodic_DstAddr           12
     SampleApp_Flash_DstAddr              12
     SampleApp_P2P_DstAddr                12
     SampleApp_Group                      18
     SampleAppPeriodicCounter              1
     SampleAppFlashCounter                 1
     deal_data                            12
     ?Subroutine0                          7
     AF_To_R_From_C                       91
     ?Subroutine1                          5
     uart_data_buffer                     50
     SerialApp_CallBack                  210
     pack_msg_transfer                   270
     unpack_msg                           22
     SampleApp_Init                      284
     buf                                  64
     buflen                                2
     SampleApp_ProcessEvent              280
     SampleApp_HandleKeys                 46
     ?Subroutine2                          5
     SampleApp_MessageMSGCB               42
     AF_TO_C_FRM_R_Message               131
     SampleApp_SendFlashMessage            3
     ??deal_data?relay                     6
     ??AF_To_R_From_C?relay                6
     ??SerialApp_CallBack?relay            6
     ??pack_msg_transfer?relay             6
     ??unpack_msg?relay                    6
     ??SampleApp_Init?relay                6
     ??SampleApp_ProcessEvent?relay        6
     ??SampleApp_HandleKeys?relay          6
     ??SampleApp_MessageMSGCB?relay        6
     ??AF_TO_C_FRM_R_Message?relay         6
     ??SampleApp_SendFlashMessage?relay    6
     ?<Constant "Group 1">                 8
     ?<Constant "SampleApp">              10
     ?<Constant "123456">                  6

 
 1 408 bytes in segment BANKED_CODE
    66 bytes in segment BANK_RELAYS
    40 bytes in segment XDATA_ROM_C
   182 bytes in segment XDATA_Z
 
 1 474 bytes of CODE  memory
    40 bytes of CONST memory
   182 bytes of XDATA memory

Errors: none
Warnings: 2
